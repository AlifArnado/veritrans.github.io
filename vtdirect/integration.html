<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Veritrans API Documentation. Payment Gateway Indonesia, transaksi online lebih aman, mudah, cepat! Veritrans memberi solusi sistem payment gateway terbaik untuk e-commerce di Indonesia.">
    <meta name="keywords" content="Veritrans, Veritrans Indonesia, payment gateway indonesia, Pembayaran Online Indonesia, online payment Indonesia, sistem transaksi online"> 
    <link href="../stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <title>Docs - Veritrans Indonesia</title>
		<link rel="shortcut icon" href="/favicon.ico"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!-- Fixed navbar -->
<div class="header navbar navbar-default navbar-fixed-top">
  <div class="custom-container">
    <div class="col-md-3 navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <h2 class="logo"><a href="https://www.veritrans.co.id/" title="Home"><span>Veritrans</span></a></h2>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="https://www.veritrans.co.id/whatwedo.html">what we do</a></li>
				<li><a href="https://www.veritrans.co.id/index.html#vt-products" title="Our Online Payment Products">products</a></li>
        <li><a href="https://www.veritrans.co.id/pricing.html">pricing</a></li>
        <li><a href="https://www.veritrans.co.id/about.html">about</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">developer <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="https://www.veritrans.co.id/sandbox.html">sandbox</a></li>
            <li><a href="http://docs.veritrans.co.id/">documentation</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">more <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="http://docs.veritrans.co.id/faq/general.html" title="FAQ & How To">FAQ</a></li>
            <li><a href="http://blog.veritrans.co.id" title="Blog, News and Press Release">blog</a></li>
            <li><a href="https://www.veritrans.co.id/career.html" title="Career at Veritrans">career</a></li>
            <li><a href="https://www.veritrans.co.id/contact.html" title="Contact Us">contact</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right register-login">
        <li class="pull-left"><a href="https://my.veritrans.co.id/register" class="register">register</a></li>
        <li class="pull-left"><a href="https://my.veritrans.co.id/login">login</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>

    <div class="custom-container">
      <div class="row row-offcanvas row-offcanvas-right">
        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
	<div class="documentation-sidebar">
		<div class="docs-logo">
			<span>DOCS</span>
		</div>
		<ul class="sidebar">
			<li><a class="parent">Payment API</a>
				<ul class="child-menu">
					
					<li class=""><a href="../payment_api/introduction.html">Perkenalan</a></li>
					
					<li class=""><a href="../payment_api/payment_type.html">Jenis Pembayaran</a></li>
					
					<li class=""><a href="../payment_api/payment_method.html">Cara Pembayaran</a></li>
					
				</ul>
			</li>
			<li><a class="parent">VT-Web</a>
				<ul class="child-menu">
					
					<li class=""><a href="../vtweb/introduction.html">Perkenalan</a></li>
					
					<li class=""><a href="../vtweb/getting_started.html">Langkah Awal</a></li>
					
					<li class=""><a href="../vtweb/get_redirect_url.html">Mendapatkan Redirect URL</a></li>
					
					<li class=""><a href="../vtweb/redirect.html">Redirect</a></li>
					
					<li class=""><a href="../vtweb/handle_notification.html">Menangani Notifikasi</a></li>
					
					<li class=""><a href="../vtweb/sample_code.html">Sample Code</a></li>
					
					<li class=""><a href="../vtweb/status_code.html">Status Code</a></li>
					
				</ul>
			</li>
			<li><a class="parent">VT-Direct</a>
				<ul class="child-menu">
					
					<li class=""><a href="introduction.html">Perkenalan</a></li>
					
					<li class=""><a href="getting_started.html">Langkah Awal</a></li>
					
					<li class="active"><a href="integration.html">Integrasi</a></li>
					
					<li class=""><a href="going_live.html">Going Live</a></li>
					
					<li class=""><a href="other_commands.html">Perintah Lain</a></li>
					
					<li class=""><a href="other_features.html">Fitur Lain</a></li>
					
					<li class=""><a href="payment_options.html">Pilihan Pembayaran</a></li>
					
					<li class=""><a href="examples.html">Contoh</a></li>
					
					<li class=""><a href="status_code.html">Status Code</a></li>
					
				</ul>
			</li>
			<li><a class="parent">Sandbox</a>
				<ul class="child-menu">
					
					<li class=""><a href="../sandbox/difference.html">Perbedaan Sandbox dan Production</a></li>
					
					<li class=""><a href="../sandbox/testing_vtweb.html">Pengujian VTWeb di Sandbox</a></li>
					
					<li class=""><a href="../sandbox/card_list.html">Daftar Kartu Kredit</a></li>
					
				</ul>
			</li>
			<li><a class="parent">How to</a>
				<ul class="child-menu">
					
					<li class=""><a href="../howto/fds.html">Sistem Deteksi Fraud</a></li>
					
					<li class=""><a href="../howto/cancel.html">Pembatalan Transaksi</a></li>
					
				</ul>
			</li>
			<li><a class="parent">FAQ</a>
				<ul class="child-menu">
					
					<li class=""><a href="../faq/general.html">Informasi Umum</a></li>
					
					<li class=""><a href="../faq/pricing.html">Pricing</a></li>
					
					<li class=""><a href="../faq/fraud_and_security.html">Fraud dan Security</a></li>
					
					<li class=""><a href="../faq/integration.html">Integrasi</a></li>
					
					<li class=""><a href="../faq/account_management.html">Manajemen Akun</a></li>
					
					<li class=""><a href="../faq/fds_response.html">Fraud Detection System (FDS) Response</a></li>
					
				</ul>
			</li>
		</ul>
	</div>
</div><!--/span-->
        <div class="col-xs-12 col-sm-9" id="bodier">
          <p class="pull-right visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Menu</button>
          </p>
          <div class="vtdirect-integration">
            <h2>Integrasi VT-Direct</h2>

<h3>Tiga Langkah Integrasi</h3>
<ol>
  <li>Mendapatkan Token</li>
  <li>Melakukan Charge Transaksi</li>
  <li>Mendapatkan Respon</li>
</ol>

<p><br /></p>

<!-- Nav tabs -->
<ul class="nav nav-tabs">
  <li class="active"><a href="#step1" data-toggle="tab"><span>Langkah 1</span>Mendapatkan Token</a></li>
  <li><a href="#step2" data-toggle="tab"><span>Langkah 2</span>Melakukan Charge Transaksi</a></li>
  <li><a href="#step3" data-toggle="tab"><span>Langkah 3</span>Mendapatkan Respon</a></li>
</ul>

<div class="tab-content">
<div class="tab-pane active" id="step1"><!-- step 1-->
<!-- satu -->

<h3> Mendapatkan Token</h3>

Untuk menerima informasi kartu kredit pembeli dan mengirimkannya secara aman ke Veritrans, merchant memerlukan library Javascript <code>veritrans.js</code>. Script ini kami sediakan untuk mempermudah merchant dalam melakukan transaksi VT-Direct. Demi alasan keamanan, kami melarang merchant untuk mengimplementasikan Javascript sendiri. Jika ada fitur yang diinginkan berkaitan tentang VT-Direct, harap hubungi Veritrans support.

<h4> Menyiapkan halaman HTML</h4>

Halaman HTML ini akan digunakan pembeli untuk menginputkan informasi kartu kreditnya. Nama file HTML bebas, dalam contoh ini kita beri nama <code>checkout.html</code>.

<pre class="highlight html">  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;title&gt;</span>Checkout<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      
      <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</pre>

<h4>Menggunakan library veritrans.js</h4>

Ketika di Production Environment, tambahkan baris ini di HTML head:

<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">”https://api.veritrans.co.id/v2/assets/js/veritrans.min.js”</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre>
Ketika di Sandbox/Development Environment, tambahkan baris ini di HTML head:

<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">”https://api.sandbox.veritrans.co.id/v2/assets/js/veritrans.min.js”</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre>

<h4>Membuat HTML form untuk pembeli menginputkan detail kartu kreditnya</h4>

Tambahkan form berikut ini di bagian body HTML:

<pre class="highlight html"><span class="nt">&lt;h1&gt;</span>Checkout<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;checkout_process.php&quot;</span> <span class="na">method=</span><span class="s">&quot;POST&quot;</span> <span class="na">id=</span><span class="s">&quot;payment-form&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;label&gt;</span>Card Number<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-number&quot;</span> <span class="na">value=</span><span class="s">&quot;4111111111111111&quot;</span> <span class="na">size=</span><span class="s">&quot;20&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">autocomplete=</span><span class="s">&quot;off&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;label&gt;</span>Expiration (MM/YYYY)<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-expiry-month&quot;</span> <span class="na">value=</span><span class="s">&quot;12&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;MM&quot;</span> <span class="na">size=</span><span class="s">&quot;2&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;span&gt;</span> / <span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-expiry-year&quot;</span> <span class="na">value=</span><span class="s">&quot;2018&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;YYYY&quot;</span> <span class="na">size=</span><span class="s">&quot;4&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;p&gt;</span>
      <span class="nt">&lt;label&gt;</span>CVV<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-cvv&quot;</span> <span class="na">value=</span><span class="s">&quot;123&quot;</span> <span class="na">size=</span><span class="s">&quot;4&quot;</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">autocomplete=</span><span class="s">&quot;off&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;token_id&quot;</span> <span class="na">name=</span><span class="s">&quot;token_id&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;submit-button&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span><span class="nt">&gt;</span>Pay<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre>
Catatan: 

Contoh nomor credit card yang dapat digunakan untuk pengujian sukses atau pengujian gagal dapat dilihat <a href="/sandbox/card_list.html">disini</a>.


<h4>Menambahkan Javascript untuk memproses transaksi</h4>

Contoh ini menggunakan jQuery dan jQuery fancybox untuk memudahkan saat menampilkan dialog 3DSecure. Merchant dapat menggunakan framework javascript lain atau menggunakan javascript sendiri untuk menampilkan dialog 3DSecure ini.

Tambahkan baris ini ke HTML di bagian head:

<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/jquery.fancybox.pack.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;css/jquery.fancybox.css&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">media=</span><span class="s">&quot;screen&quot;</span> <span class="nt">/&gt;</span>
</pre>
Berikut ini adalah javascript yang digunakan untuk men-generate <code>token_id</code>. Tambahkan script berikut ini setelah script di atas.

<pre class="highlight html"><span class="c">&lt;!-- Javascript to generate token and show 3DSecure Dialog --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// Sandbox API URL. TODO: Change with Production API URL when you're ready to go live.
</span>  <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.sandbox.veritrans.co.id/v2/token&quot;</span><span class="p">;</span>
  <span class="c1">// TODO: Change with your actual client key that can be found at Merchant Administration Portal &gt;&gt; Setting &gt;&gt; Access Key
</span>  <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">client_key</span> <span class="o">=</span> <span class="s2">&quot;f768ae9b-1a43-4113-830c-3c0aea92616a&quot;</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="s1">'card_number'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="s1">'card_exp_month'</span>  <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-month&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="s1">'card_exp_year'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-year&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="s1">'card_cvv'</span>      <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>

      <span class="c1">// Set 'secure', 'bank', and 'gross_amount', if the merchant wants transaction to be processed with 3D Secure
</span>      <span class="c1">// 'secure'       : true,
</span>      <span class="c1">// 'bank'       : 'bni',
</span>      <span class="c1">// 'gross_amount'   : 200000
</span>    <span class="p">}</span>
  <span class="p">};</span>

  <span class="c1">// handler when user click the 'Pay' button.
</span>  <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span><span class="p">);</span> 
    <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">token</span><span class="p">(</span><span class="nx">card</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">redirect_url</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 3Dsecure transaction. Open 3Dsecure dialog
</span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Open Dialog 3Dsecure'</span><span class="p">);</span>
      <span class="nx">openDialog</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">redirect_url</span><span class="p">);</span>

    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_code</span> <span class="o">==</span> <span class="s1">'200'</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success 3d secure or success normal
</span>                   <span class="c1">//close 3d secure dialog if any
</span>      <span class="nx">closeDialog</span><span class="p">();</span>

      <span class="c1">// store token data in input #token_id and then submit form to merchant server
</span>      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#token_id&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">token_id</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#payment-form&quot;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// failed request token
</span>                  <span class="c1">//close 3d secure dialog if any
</span>      <span class="nx">closeDialog</span><span class="p">();</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">'disabled'</span><span class="p">);</span>
      <span class="c1">// Show status message.
</span>      <span class="nx">$</span><span class="p">(</span><span class="s1">'#message'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_message</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Open 3DSecure dialog box
</span>  <span class="kd">function</span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">fancybox</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span>
          <span class="na">href</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
          <span class="na">type</span><span class="p">:</span> <span class="s1">'iframe'</span><span class="p">,</span>
          <span class="na">autoSize</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">width</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>
          <span class="na">height</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
          <span class="na">closeBtn</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">modal</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Close 3DSecure dialog box
</span>  <span class="kd">function</span> <span class="nx">closeDialog</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">fancybox</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre>
Ketika customer mengeklik tombol ‘Pay’, Javascript mem-populate <code>card_number</code>, <code>card_exp_month</code>, <code>card_exp_year</code>, dan <code>cvv</code> dari form. Kemudian, dengan memanfaatkan library <code>veritrans.js</code>, Javascript mengirimkan data sensitif tersebut secara aman ke server Veritrans untuk mendapatkan <code>token_id</code>. Setelah mendapatkan response <code>token_id</code>, Javascript menyimpannya ke hidden textfield <code>#token_id</code> dan kemudian men-submit form ke server merchant (<code>checkout_process.php</code>). Perlu dicatat bahwa detail kartu kredit tidak dikirim ke server merchant. Yang dikirim ke server merchant hanyalah <code>token_id</code>.

<h4 id="activate">Mengaktifkan fitur VT-Direct 3DSecure</h4>

Perhatikan script Javascript di atas pada bagian berikut ini:

<pre class="highlight javascript"><span class="c1">//...
</span><span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s1">'card_number'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_month'</span>  <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-month&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_year'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-year&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_cvv'</span>      <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>

    <span class="c1">// Set 'secure', 'bank', and 'gross_amount', if the merchant wants transaction to be processed with 3D Secure
</span>    <span class="c1">// 'secure'     : true,
</span>    <span class="c1">// 'bank'     : 'bni',
</span>    <span class="c1">// 'gross_amount'   : 200000
</span>  <span class="p">}</span>
<span class="p">};</span>
<span class="c1">//...
</span></pre>

Jika merchant ingin memproses transaksi dengan 3DSecure, maka parameter <code>secure</code>, <code>bank</code>, dan <code>gross_amout</code> perlu ditambahkan. 

<table>
  <tr>
    <th>Parameter</th>
    <th>Penjelasan</th>
  </tr>
  <tr>
    <td><code>secure</code></td>
    <td>Penanda bahwa transaksi ini menggunakan 3DSecure.</td>
  </tr>
  <tr>
    <td><code>bank</code></td>
    <td>Acquirer bank yang akan digunakan.</td>
  </tr>
  <tr>
    <td><code>gross_amount</code></td>
    <td>Total jumlah uang yang akan di-charge.</td>
  </tr>
</table>

Sehingga, sebagian script Javascript di atas perlu di-uncomment menjadi:

<pre class="highlight javascript"><span class="c1">//...
</span><span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s1">'card_number'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_month'</span>  <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-month&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_year'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-year&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_cvv'</span>      <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>

    <span class="c1">// Set 'secure', 'bank', and 'gross_amount', if the merchant wants transaction to be processed with 3D Secure
</span>    <span class="s1">'secure'</span>      <span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s1">'bank'</span>        <span class="err">:</span> <span class="s1">'bni'</span><span class="p">,</span>
    <span class="s1">'gross_amount'</span>    <span class="err">:</span> <span class="mi">200000</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="c1">//...
</span></pre>
</div><!-- end of step 1-->

<div class="tab-pane" id="step2"><!-- step 2-->

<!-- dua -->

<h3 id="charge">Charge Transaksi</h3>

Di server merchant (<code>checkout_process.php</code>), setelah mendapatkan <code>token_id</code>, merchant dapat mengirim request charge transaksi dengan spesifikasi sebagai berikut:

Catatan: Spesifikasi request charge transaksi 3DSecure dan transaksi normal (tanpa 3DSecure) adalah sama. Perbedaan untuk melakukan transaksi 3DSecure hanya ada pada langkah Get Token saja.

<table>
  <tr>
    <td>Endpoint</td>
    <td>/v2/charge</td>
  </tr>
  <tr>
    <td>Header</td>
    <td>Content-Type: application/json<br />
Accept: application/json</td>
  </tr>
  <tr>
    <td>HTTP Method</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Authorization</td>
    <td>Basic (<code>server_key</code>:)</td>
  </tr>
</table>

Message yang dikirim saat mengirim request tersebut adalah data detail transaksi dalam format JSON. Contoh:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">&quot;payment_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s2">&quot;credit_card&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;token_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;411111-1236-e9dc7213-8b2c-4353-93a4-b250680e57a5&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;bank&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bni&quot;</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">&quot;transaction_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order52&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;gross_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200000</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">&quot;item_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;item1&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100000</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Adidas f50&quot;</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;item2&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50000</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nike N90&quot;</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="s2">&quot;customer_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;last_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Customer&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jcustomer@example.com&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;08195010132&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;billing_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;last_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Customer&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Karet&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Jakarta&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;postal_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;523112&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;08191231234&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;country_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IDN&quot;</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">&quot;shipping_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;last_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Watson&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bakerstreet 221B&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;London&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;postal_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;12354&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;081323123123&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;country_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IDN&quot;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
Keterangan objek <code>JSON Request</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Tipe Data</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>payment_type</code></td>
            <td>String</td>
            <td>Ya</td>
            <td>Pilihan tipe pembayaran yang akan digunakan. Contoh: <br />
                <ul>
                    <li>Dengan VT-Direct:
                        <ul>
                            <li>Isi “CREDIT_CARD” untuk pembayaran melalui VT-Direct.</li>
                        </ul>
                    </li>
                    <li>Dengan VT-WEB:
                        <ul>
                            <li>Isi “VTWEB” untuk pembayaran melalui VT-Web</li>
                        </ul>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td><code>credit_card</code></td>
            <td>JSON Object</td>
            <td>Ya</td>
            <td>Field khusus apabila menggunakan payment type: "CREDIT_CARD"</td>
        </tr>
        <tr>
            <td><code>transaction_details</code></td>
            <td>JSON Object</td>
            <td>Ya</td>
            <td>Detail data transaksi yang akan dibayar oleh customer</td>
        </tr>
        <tr>
            <td><code>item_details</code></td>
            <td>JSON Array</td>
            <td>Ya</td>
            <td>Detail item pembelanjaan yang akan dibayar oleh customer</td>
        </tr>
        <tr>
            <td><code>customer_details</code></td>
            <td>JSON Object</td>
            <td>Ya</td>
            <td>Detail data customer yang melakukan pembayaran</td>
        </tr>
    </tbody>
</table>

Keterangan Objek <code>credit_card</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>token_id</code></td>
            <td>Ya</td>
            <td>Representasi data kartu kredit yang disimpan dalam bentuk token</td>
        </tr>
        <tr>
            <td><code>bank</code></td>
            <td>Ya</td>
            <td>Acquirer bank yang digunakan</td>
        </tr>
    </tbody>
</table>

Keterangan Objek <code>transaction_details</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Tipe Data</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>order_id</code></td>
            <td>String(50)</td>
            <td>Ya</td>
            <td>ID pembayaran customer</td>
        </tr>
        <tr>
            <td><code>gross_amount</code></td>
            <td>Long</td>
            <td>Ya</td>
            <td>Total harga transaksi pembayaran yang akan dibayar oleh customer</td>
        </tr>
    </tbody>
</table>

Keterangan Objek <code>item_details</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Tipe Data</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>id</code></td>
            <td>String(50)</td>
            <td>Ya</td>
            <td>ID barang</td>
        </tr>
        <tr>
            <td><code>price</code></td>
            <td>Long</td>
            <td>Ya</td>
            <td>Harga barang</td>
        </tr>
        <tr>
            <td><code>quantity</code></td>
            <td>Integer</td>
            <td>Ya</td>
            <td>Jumlah barang</td>
        </tr>
        <tr>
            <td><code>name</code></td>
            <td>String(50)</td>
            <td>Ya</td>
            <td>Nama barang</td>
        </tr>
    </tbody>
</table>

Keterangan Objek <code>customer_details</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Tipe Data</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>first_name</code></td>
            <td>String(20)</td>
            <td>Ya</td>
            <td>Nama depan customer</td>
        </tr>
        <tr>
            <td><code>last_name</code></td>
            <td>String(20)</td>
            <td>Dianjurkan</td>
            <td>Nama belakang customer</td>
        </tr>
        <tr>
            <td><code>email</code></td>
            <td>String(45)</td>
            <td>Ya</td>
            <td>Email customer.<br />
Note: terdapat validasi untuk mengecek format email yang valid</td>
        </tr>
        <tr>
            <td><code>phone</code></td>
            <td>String(19)</td>
            <td>Ya</td>
            <td>Nomor telepon customer. <br />
Note: Panjang minimum 5, hanya bisa menerima numeric dan simbol +, -, (spasi), dan (). Untuk simbol + sendiri hanya bisa ditempatkan di paling depan.</td>
        </tr>
        <tr>
            <td><code>billing_address</code></td>
            <td>JSON Object</td>
            <td>Opsional, kecuali untuk tipe pembayaran menggunakan kartu kredit, atribut ini diwajibkan</td>
            <td>Billing address customer</td>
        </tr>
        <tr>
            <td><code>shipping_address</code></td>
            <td>JSON Object</td>
            <td>Dianjurkan</td>
            <td>Shipping address customer</td>
        </tr>
    </tbody>
</table>

Keterangan Objek <code>billing_address</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Tipe Data</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>first_name</code></td>
            <td>String(20)</td>
            <td>Dianjurkan</td>
            <td>Nama depan billing address. <br />
Note : Tidak perlu diisi apabila isinya sama dengan customer details - first_name</td>
        </tr>
        <tr>
            <td><code>last_name</code></td>
            <td>String(20)</td>
            <td>Dianjurkan</td>
            <td>Nama belakang billing address</td>
        </tr>
        <tr>
            <td><code>address</code></td>
            <td>String(200)</td>
            <td>Opsional, kecuali untuk tipe pembayaran menggunakan kartu kredit, atribut ini diwajibkan</td>
            <td>Alamat billing address</td>
        </tr>
        <tr>
            <td><code>city</code></td>
            <td>String(20)</td>
            <td>Opsional, kecuali untuk tipe pembayaran menggunakan kartu kredit, atribut ini diwajibkan</td>
            <td>Kota billing address</td>
        </tr>
        <tr>
            <td><code>postal_code</code></td>
            <td>String(9)</td>
            <td>Opsional, kecuali untuk tipe pembayaran menggunakan kartu kredit, atribut ini diwajibkan</td>
            <td>Kode pos shipping address <br />
Note: format alpha-numeric, bisa menerima “-” dan spasi</td>
        </tr>
        <tr>
            <td><code>phone</code></td>
            <td>String(19)</td>
            <td>Dianjurkan</td>
            <td>Nomor telpon billing address. <br />
Note : Tidak perlu diisi apabila isinya sama dengan customer details - phone. Panjang minimum 5, hanya bisa menerima numeric dan simbol +, -, (spasi), dan (). Untuk simbol + sendiri hanya bisa ditempatkan di paling depan.</td>
        </tr>
        <tr>
            <td><code>country_code</code></td>
            <td>String(200)</td>
            <td>Dianjurkan</td>
            <td>ID negara (contoh: IDN)</td>
        </tr>
    </tbody>
</table>

Keterangan Objek <code>shipping_address</code>:

<table>
    <thead>
        <tr>
            <th>Atribut JSON</th>
            <th>Tipe Data</th>
            <th>Required</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>first_name</code></td>
            <td>String(20)</td>
            <td>Dianjurkan</td>
            <td>Nama depan shipping address</td>
        </tr>
        <tr>
            <td><code>last_name</code></td>
            <td>String(20)</td>
            <td>Dianjurkan</td>
            <td>Nama belakang shipping address</td>
        </tr>
        <tr>
            <td><code>address</code></td>
            <td>String(200)</td>
            <td>Dianjurkan</td>
            <td>Alamat shipping address</td>
        </tr>
        <tr>
            <td><code>city</code></td>
            <td>String(20)</td>
            <td>Dianjurkan</td>
            <td>Kota shipping address</td>
        </tr>
        <tr>
            <td><code>postal_code</code></td>
            <td>String(9)</td>
            <td>Opsional, kecuali untuk tipe pembayaran menggunakan kartu kredit, atribut ini diwajibkan</td>
            <td>Kode pos shipping address <br />
Note: format alpha-numeric, bisa menerima “-” dan spasi</td>
        </tr>
        <tr>
            <td><code>phone</code></td>
            <td>String(19)</td>
            <td>Dianjurkan</td>
            <td>Nomor telpon billing address. <br />
Note : Tidak perlu diisi apabila isinya sama dengan customer details - phone. Panjang minimum 5, hanya bisa menerima numeric dan simbol +, -, (spasi), dan (). Untuk simbol + sendiri hanya bisa ditempatkan di paling depan.</td>
        </tr>
        <tr>
            <td><code>country_code</code></td>
            <td>String(200)</td>
            <td>Dianjurkan</td>
            <td>ID negara (contoh: IDN)</td>
        </tr>
    </tbody>
</table>

Berikut ini adalah contoh implementasi request untuk melakukan charge transaksi dalam PHP. Untuk mengikuti contoh di atas, kita beri nama file ini <code>checkout_process.php</code>.

<pre class="highlight php"><span class="cp">&lt;?php</span>
<span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'token_id'</span><span class="p">]))</span> 
<span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;Empty token_id.&quot;</span><span class="p">;</span>
  <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// TODO: change with your actual server_key that can be found on Merchant Administration Portal (MAP)
</span><span class="nv">$server_key</span> <span class="o">=</span> <span class="s2">&quot;1a794e3f-f023-4cda-92b7-dcb7a22a46ff&quot;</span><span class="p">;</span>
<span class="nv">$endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://api.sandbox.veritrans.co.id/v2/charge&quot;</span><span class="p">;</span>

<span class="c1">// token_id merepresentasikan credit card yang akan di-carge.
// token_id didaptkan dari request yang dilakukan melalui veritrans.js
</span><span class="nv">$token_id</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'token_id'</span><span class="p">];</span>

<span class="nv">$transaction_details</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'order_id'</span>    <span class="o">=&gt;</span> <span class="s1">'order375'</span><span class="p">,</span>
  <span class="s1">'gross_amount'</span>  <span class="o">=&gt;</span> <span class="mi">200000</span>
<span class="p">);</span>

<span class="nv">$items</span> <span class="o">=</span> <span class="p">[</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span>    <span class="o">=&gt;</span> <span class="s1">'item1'</span><span class="p">,</span>
    <span class="s1">'price'</span>   <span class="o">=&gt;</span> <span class="mi">100000</span><span class="p">,</span>
    <span class="s1">'quantity'</span>  <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'name'</span>    <span class="o">=&gt;</span> <span class="s1">'Adidas f50'</span>
  <span class="p">),</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span>    <span class="o">=&gt;</span> <span class="s1">'item2'</span><span class="p">,</span>
    <span class="s1">'price'</span>   <span class="o">=&gt;</span> <span class="mi">50000</span><span class="p">,</span>
    <span class="s1">'quantity'</span>  <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">'name'</span>    <span class="o">=&gt;</span> <span class="s1">'Nike N90'</span>
  <span class="p">)</span>
<span class="p">];</span>

<span class="nv">$billing_address</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'first_name'</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
  <span class="s1">'last_name'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Customer&quot;</span><span class="p">,</span>
  <span class="s1">'address'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;Karet&quot;</span><span class="p">,</span>
  <span class="s1">'city'</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Jakarta&quot;</span><span class="p">,</span>
  <span class="s1">'postal_code'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;51161&quot;</span><span class="p">,</span>
  <span class="s1">'phone'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;081312341234&quot;</span><span class="p">,</span>
  <span class="s1">'country_code'</span>  <span class="o">=&gt;</span> <span class="s1">'IDN'</span>
  <span class="p">);</span>

<span class="nv">$shipping_address</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'first_name'</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
  <span class="s1">'last_name'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Watson&quot;</span><span class="p">,</span>
  <span class="s1">'address'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;Bakerstreet 221B.&quot;</span><span class="p">,</span>
  <span class="s1">'city'</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Jakarta&quot;</span><span class="p">,</span>
  <span class="s1">'postal_code'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;51162&quot;</span><span class="p">,</span>
  <span class="s1">'phone'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;081312341235&quot;</span><span class="p">,</span>
  <span class="s1">'country_code'</span>  <span class="o">=&gt;</span> <span class="s1">'IDN'</span>
  <span class="p">);</span>

<span class="nv">$customer_details</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'first_name'</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
  <span class="s1">'last_name'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Customer&quot;</span><span class="p">,</span>
  <span class="s1">'email'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;jcustomer@example.com&quot;</span><span class="p">,</span>
  <span class="s1">'phone'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;081312341234&quot;</span><span class="p">,</span>
  <span class="s1">'billing_address'</span>  <span class="o">=&gt;</span> <span class="nv">$billing_address</span><span class="p">,</span>
  <span class="s1">'shipping_address'</span> <span class="o">=&gt;</span> <span class="nv">$shipping_address</span>
  <span class="p">);</span>

<span class="c1">// Data yang akan dikirim untuk request charge transaction dengan credit card.
</span><span class="nv">$transaction_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'payment_type'</span>      <span class="o">=&gt;</span> <span class="s1">'credit_card'</span><span class="p">,</span> 
  <span class="s1">'credit_card'</span>       <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'token_id'</span>  <span class="o">=&gt;</span> <span class="nv">$token_id</span><span class="p">,</span>
    <span class="s1">'bank'</span>    <span class="o">=&gt;</span> <span class="s1">'bni'</span>
    <span class="p">),</span>
  <span class="s1">'transaction_details'</span>   <span class="o">=&gt;</span> <span class="nv">$transaction_details</span><span class="p">,</span>
  <span class="s1">'item_details'</span>      <span class="o">=&gt;</span> <span class="nv">$items</span><span class="p">,</span>
  <span class="s1">'customer_details'</span>    <span class="o">=&gt;</span> <span class="nv">$customer_details</span>
  <span class="p">);</span>

<span class="nv">$json_transaction_data</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$transaction_data</span><span class="p">);</span>

<span class="c1">// Mengirimkan request dengan menggunakan CURL
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$endpoint</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$json_transaction_data</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">'Authorization: Basic %s'</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$server_key</span><span class="o">.</span><span class="s1">':'</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
  <span class="s1">'Accept: application/json'</span><span class="p">,</span>
  <span class="nv">$auth</span> 
  <span class="p">)</span>
<span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">));</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">transaction_status</span> <span class="o">==</span> <span class="s2">&quot;capture&quot;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//success
</span>  <span class="k">echo</span> <span class="s2">&quot;Transaksi berhasil. &lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;Status transaksi untuk order id &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">transaction_status</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Detail transaksi:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">transaction_status</span> <span class="o">==</span> <span class="s2">&quot;deny&quot;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//deny
</span>  <span class="k">echo</span> <span class="s2">&quot;Transaksi ditolak. &lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;Status transaksi untuk order id &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">transaction_status</span><span class="p">;</span>

  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Detail transaksi:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">transaction_status</span> <span class="o">==</span> <span class="s2">&quot;challenge&quot;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//challenge
</span>  <span class="k">echo</span> <span class="s2">&quot;Transaksi challenge. &lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;Status transaksi untuk order id &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">transaction_status</span><span class="p">;</span>

  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Detail transaksi:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
  <span class="c1">//error
</span>  <span class="k">echo</span> <span class="s2">&quot;Terjadi kesalahan pada data transaksi yang dikirim.&lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Result:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre>
</div><!-- end of step 2-->

<div class="tab-pane" id="step3"><!-- step 3-->

<!-- tiga -->

<h3> Menangani Respon </h3>
<h4>Success Response</h4>

Jika sukses, maka request di atas akan mendapatkan response dari Veritrans berupa JSON seperti berikut ini:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="err">transaction_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;93c6a0ff-b270-4b00-adba-f1738ff90261&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">order_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;201303131610&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">gross_amount</span><span class="p">:</span><span class="w"> </span><span class="mi">100000000</span><span class="p">,</span><span class="w">
    </span><span class="err">payment_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_time</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-13 16:10:15&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capture&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">fraud_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;accept&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">masked_card</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;411111-1111&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_code</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_message</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK, Credit Card transaction is successful&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<h4>Error Response</h4>

Jika ada kesalahan yang menyebabkan kegagalan, misalnya <code>order_id</code> sudah pernah dibayar, maka request di atas akan mendapatkan response seperti berikut ini:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;406&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s2">&quot;status_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Merchant charges the same order id more than once or transaction has been paid&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
Jika credit card ditolak oleh bank, maka request di atas akan mendapatkan response:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="err">transaction_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ee946272-44b9-4e19-8ae7-ffd12c2cbb18&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">order_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;201303131612&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">gross_amount</span><span class="p">:</span><span class="w"> </span><span class="mi">100000000</span><span class="p">,</span><span class="w">
    </span><span class="err">payment_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_time</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-13 16:12:35&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;deny&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">fraud_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;challenge&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">masked_card</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;411111-1244&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_code</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;201&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_message</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Deny by Bank [MANDIRI] with code [05] and    message [Do not honour]&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
Sampai di sini, proses pembayaran suatu transaksi telah selesai. Ketika request charge sudah mendapatkan success response(<code>transaction_status = ’capture’</code>), itu berarti kartu kredit pembeli sudah di-charge ke akun merchant. Merchant dapat menggunakan data dari response tersebut untuk mengupdate database-nya, misalnya untuk menandai bahwa transaksi dengan <code>order_id</code> tersebut telah terbayar. Selain itu, informasi detail transaksi tersebut juga sudah tercatat di Merchant Administration Portal(MAP). Merchant perlu untuk login ke MAP untuk melihat detail informasi transaksi tersebut.

</div><!-- end of step 3-->

  
</div>
<!-- end of tab-content-->



			<div class="pagination">
				<ul><li class="left">« Previous: <a href="getting_started.html">VT-Direct: Langkah Awal</a></li><li class="right">Next: <a href="going_live.html">VT-Direct: Going Live</a> »</li></ul>
			</div>
          </div>
        </div><!--/span-->
      </div><!--/row-->

    </div><!--/.container-->
    <div class="custom-container footer">
  <div class="wrapper">
    <div class="row">
      <div class="col-md-12 footer-nav">
        <div class="content text-center">
          <a href="https://www.veritrans.co.id" title="">Home</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/whatwedo.html" title="">What We Do</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/pricing.html" title="">Pricing</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/about.html" title="">About</a> <span class="divider">|</span>
          <a href="http://blog.veritrans.co.id/" title="">Blog</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/career.html" title="">Career</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/contact.html" title="">Contact</a> <span class="divider">|</span>
          <a href="http://docs.veritrans.co.id/" title="">Docs</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/press.html" title="">Press</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/privacy.html" title="">Privacy Policy</a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 copyright">
        <div class="content text-center">
          <span>©2014 PT. Midtrans (Veritrans Indonesia). All Rights Reserved</span>
        </div>
      </div>
    </div>
  </div>
</div>

    <script src="../javascripts/jquery-1.10.2.min.js" type="text/javascript"></script>
<script src="../javascripts/bootstrap.min.js" type="text/javascript"></script>
    <script>
    $(document).ready(function() {
      $('[data-toggle=offcanvas]').click(function() {
        $('.row-offcanvas').toggleClass('active');
      });
    });
    </script>
  </body>
</html>
