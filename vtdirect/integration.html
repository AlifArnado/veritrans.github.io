<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Veritrans API Documentation. Payment Gateway Indonesia, transaksi online lebih aman, mudah, cepat! Veritrans memberi solusi sistem payment gateway terbaik untuk e-commerce di Indonesia.">
    <meta name="keywords" content="Veritrans, Veritrans Indonesia, payment gateway indonesia, Pembayaran Online Indonesia, online payment Indonesia, sistem transaksi online"> 
    <link href="../stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <title>Docs - Veritrans Indonesia</title>
		<link rel="shortcut icon" href="/favicon.ico"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="header navbar navbar-default navbar-fixed-top">
      <div class="custom-container">
        <div class="col-md-3 navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <h2 class="logo"><a href="index.html" title="Home"><span>Veritrans</span></a></h2>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="http://veritrans.co.id/whatwedo.html" title="What We Do">what we do</a></li>
            <li><a href="http://veritrans.co.id/index.html#vt-products" title="Our Online Payment Products">products</a></li>
            <li><a href="http://veritrans.co.id/pricing.html" title="Check for Our Pricing">pricing</a></li>

            <li class="dropdown">
              <a href="" class="dropdown-toggle" data-toggle="dropdown">about <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://veritrans.co.id/about.html" title="About Veritrans">about us</a></li>
                <li><a href="http://docs.veritrans.co.id/faq/general.html" title="FAQ & How To">FAQ</a></li>
                <li><a href="http://veritrans.co.id/career.html" title="Career at Veritrans">career</a></li>
                <li><a href="http://veritrans.co.id/contact.html" title="Contact Us">contact</a></li>
              </ul>
            </li>
            <!-- <li><a href="http://docs.veritrans.co.id" title="Product Documentations">docs</a></li> -->
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">developer <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://veritrans.co.id/sandbox.html">sandbox</a></li>
                <li><a href="http://docs.veritrans.co.id/">documentation</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">community <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://veritrans.co.id/festivalbelanja.html" title="Festival Belanja Veritrans" target="_blank">events</a></li>
                <li><a href="http://blog.veritrans.co.id" title="Blog, News and Press Release">blog</a></li>
                <li><a href="http://veritrans.co.id/portfolio.html" title="Our Clients">our clients</a></li>
                <li><a href="http://veritrans.co.id/why-veritrans.html" title="Why Veritrans">why veritrans</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right register-login">
            <li class="pull-left"><a href="https://my.veritrans.co.id/register" class="register">register</a></li>
            <li class="pull-left"><a href="https://my.veritrans.co.id/login">login</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="custom-container">
      <div class="row row-offcanvas row-offcanvas-right">
        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
	<div class="documentation-sidebar">
		<div class="docs-logo">
			<span>DOCS</span>
		</div>
		<div class="language-toggle"> English / <a href="../id/vtdirect/integration.html">Bahasa Indonesia</a></div>
		<ul class="sidebar">
			<li><a class="parent">Payment API</a>
				<ul class="child-menu">
					
					<li class=""><a href="../payment_api/introduction.html">Introduction</a></li>
					
					<li class=""><a href="../payment_api/payment_type.html">Payment Methods</a></li>
					
					<li class=""><a href="../payment_api/payment_method.html">Payment Type</a></li>
					
				</ul>
			</li>
			<li><a class="parent">VT-Web</a>
				<ul class="child-menu">
					
					<li class=""><a href="../vtweb/introduction.html">Introduction</a></li>
					
					<li class=""><a href="../vtweb/getting_started.html">Getting Started</a></li>
					
					<li class=""><a href="../vtweb/get_redirect_url.html">Obtaining Redirect URL</a></li>
					
					<li class=""><a href="../vtweb/redirect.html">Redirect</a></li>
					
					<li class=""><a href="../vtweb/handle_notification.html">Handling Notification</a></li>
					
					<li class=""><a href="../vtweb/going_live.html">Going Live</a></li>
					
					<li class=""><a href="../vtweb/other_features.html">Other Features</a></li>
					
					<li class=""><a href="../vtweb/payment_options.html">Payment Options</a></li>
					
					<li class=""><a href="../vtweb/sample_code.html">Sample Code</a></li>
					
				</ul>
			</li>
			<li><a class="parent">VT-Direct</a>
				<ul class="child-menu">
					
					<li class=""><a href="introduction.html">Introduction</a></li>
					
					<li class=""><a href="getting_started.html">Getting Started</a></li>
					
					<li class="active"><a href="integration.html">Integration</a></li>
					
					<li class=""><a href="going_live.html">Going Live</a></li>
					
					<li class=""><a href="other_commands.html">Other Commands</a></li>
					
					<li class=""><a href="other_features.html">Other Features</a></li>
					
					<li class=""><a href="payment_options.html">Payment Options</a></li>
					
					<li class=""><a href="examples.html">Examples</a></li>
					
				</ul>
			</li>
			<li><a class="parent">Sandbox</a>
				<ul class="child-menu">
					
					<li class=""><a href="../sandbox/difference.html">Sandbox and Production Differences</a></li>
					
					<li class=""><a href="../sandbox/testing_vtweb.html">Testing VTWeb on Sandbox</a></li>
					
					<li class=""><a href="../sandbox/card_list.html">Credit Card for Testing</a></li>
					
					<li class=""><a href="../sandbox/status_code.html">Status Code</a></li>
					
				</ul>
			</li>
			<li><a class="parent">How to</a>
				<ul class="child-menu">
					
					<li class=""><a href="../howto/fds.html">Fraud Detection System</a></li>
					
					<li class=""><a href="../howto/cancel.html">Cancel Transaction</a></li>
					
				</ul>
			</li>
			<li><a class="parent">FAQ</a>
				<ul class="child-menu">
					
					<li class=""><a href="../faq/general.html">General Information</a></li>
					
					<li class=""><a href="../faq/pricing.html">Pricing</a></li>
					
					<li class=""><a href="../faq/fraud_and_security.html">Fraud dan Security</a></li>
					
					<li class=""><a href="../faq/integration.html">Integrasi</a></li>
					
					<li class=""><a href="../faq/account_management.html">Manajemen Akun</a></li>
					
					<li class=""><a href="../faq/fds_response.html">Fraud Detection System (FDS) Response</a></li>
					
				</ul>
			</li>
		</ul>
	</div>
</div><!--/span-->
        <div class="col-xs-12 col-sm-9" id="bodier">
          <p class="pull-right visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Menu</button>
          </p>
          <div class="vtdirect-integration">
            <h2 id="vt-direct-integration">VT-Direct Integration</h2>

<h3 id="three-step-for-integration">Three Step for Integration</h3>
<ol>
  <li>Obtaining the Token</li>
  <li>Charge Transaction</li>
  <li>Handling Response</li>
</ol>

<p><br /></p>

<!-- Nav tabs -->
<ul class="nav nav-tabs">
  <li class="active"><a href="#step1" data-toggle="tab"><span>Step 1</span>Obtaining the Token</a></li>
  <li><a href="#step2" data-toggle="tab"><span>Step 2</span>Charge Transaction</a></li>
  <li><a href="#step3" data-toggle="tab"><span>Step 3</span>Handling Response</a></li>
</ul>

<div class="tab-content">
<div class="tab-pane active" id="step1"><!-- step 1-->
<!-- satu -->



<h3> Obtaining the Token</h3>
We have provided a small JavaScript applet, <code>veritrans.min.js</code>, to simplify the process of requesting Tokens to Veritrans’ system. For security purposes, we ask that all of our merchants utilize our veritrans.js for their implementation of VT-direct. If there is a feature that merchant want related to VT-Direct, please contact Veritrans support.

<h4>Setting up the Payment Form HTML</h4>

This HTML page will be utilized to create our payment page. We’ve named this sample checkout page as <code>checkout.html</code>.

<pre class="highlight html">  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;title&gt;</span>Checkout<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      
      <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</pre>

<h4>Adding the veritrans.js library</h4>

When in Production Environment, add the line below in the HTML head:

<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">”https://api.veritrans.co.id/v2/assets/js/veritrans.min.js”</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre>
When in Sandbox/Development Environment, add the line below in the HTML head:

<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">”https://api.sandbox.veritrans.co.id/v2/assets/js/veritrans.min.js”</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre>
<h4>Creating the Payment Page </h4>
Below is the sample HTML for the payment page:

Tambahkan form berikut ini di bagian body HTML:

<pre class="highlight html"><span class="nt">&lt;h1&gt;</span>Checkout<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;checkout_process.php&quot;</span> <span class="na">method=</span><span class="s">&quot;POST&quot;</span> <span class="na">id=</span><span class="s">&quot;payment-form&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;label&gt;</span>Card Number<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-number&quot;</span> <span class="na">value=</span><span class="s">&quot;4011111111111112&quot;</span> <span class="na">size=</span><span class="s">&quot;20&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">autocomplete=</span><span class="s">&quot;off&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;label&gt;</span>Expiration (MM/YYYY)<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-expiry-month&quot;</span> <span class="na">value=</span><span class="s">&quot;12&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;MM&quot;</span> <span class="na">size=</span><span class="s">&quot;2&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;span&gt;</span> / <span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-expiry-year&quot;</span> <span class="na">value=</span><span class="s">&quot;2020&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;YYYY&quot;</span> <span class="na">size=</span><span class="s">&quot;4&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;p&gt;</span>
      <span class="nt">&lt;label&gt;</span>CVV<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;card-cvv&quot;</span> <span class="na">value=</span><span class="s">&quot;123&quot;</span> <span class="na">size=</span><span class="s">&quot;4&quot;</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">autocomplete=</span><span class="s">&quot;off&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;token_id&quot;</span> <span class="na">name=</span><span class="s">&quot;token_id&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;submit-button&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span><span class="nt">&gt;</span>Pay<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre>
Note: 

Sample of credit card number which can be used to test the success or failure of testing can be seen <a href="/sandbox/card_list.html">here</a>


<h4>Adding Javascript to process 3DS transactions</h4>

This example utilizes jQuery and jQuery fancybox to simplify the UI for the 3DSecure input page. You can choose to utilize another javascript framework should you feel more comfortable.<br /><br />

Add the following in the HTML header:

<pre class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/jquery.fancybox.pack.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;css/jquery.fancybox.css&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">media=</span><span class="s">&quot;screen&quot;</span> <span class="nt">/&gt;</span>
</pre>
Below is the javascript required to generate the <code>token_id</code>. Add the script below after adding jQuery and jQuery fancybox.

<pre class="highlight html"><span class="c">&lt;!-- Javascript to generate token and show 3DSecure Dialog --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// Sandbox API URL. TODO: Change with Production API URL when you're ready to go live.
</span>  <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.sandbox.veritrans.co.id/v2/token&quot;</span><span class="p">;</span>
  <span class="c1">// TODO: Change with your actual client key that can be found at Merchant Administration Portal &gt;&gt; Setting &gt;&gt; Access Key
</span>  <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">client_key</span> <span class="o">=</span> <span class="s2">&quot;f768ae9b-1a43-4113-830c-3c0aea92616a&quot;</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="s1">'card_number'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="s1">'card_exp_month'</span>  <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-month&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="s1">'card_exp_year'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-year&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="s1">'card_cvv'</span>      <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>

      <span class="c1">// Set 'secure', 'bank', and 'gross_amount', if the merchant wants transaction to be processed with 3D Secure
</span>      <span class="c1">// 'secure'       : true,
</span>      <span class="c1">// 'bank'       : 'bni',
</span>      <span class="c1">// 'gross_amount'   : 200000
</span>    <span class="p">}</span>
  <span class="p">};</span>

  <span class="c1">// handler when user click the 'Pay' button.
</span>  <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span><span class="p">);</span> 
    <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">token</span><span class="p">(</span><span class="nx">card</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">redirect_url</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 3Dsecure transaction. Open 3Dsecure dialog
</span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Open Dialog 3Dsecure'</span><span class="p">);</span>
      <span class="nx">openDialog</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">redirect_url</span><span class="p">);</span>

    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_code</span> <span class="o">==</span> <span class="s1">'200'</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success 3d secure or success normal
</span>                   <span class="c1">//close 3d secure dialog if any
</span>      <span class="nx">closeDialog</span><span class="p">();</span>

      <span class="c1">// store token data in input #token_id and then submit form to merchant server
</span>      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#token_id&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">token_id</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#payment-form&quot;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// failed request token
</span>                  <span class="c1">//close 3d secure dialog if any
</span>      <span class="nx">closeDialog</span><span class="p">();</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">'disabled'</span><span class="p">);</span>
      <span class="c1">// Show status message.
</span>      <span class="nx">$</span><span class="p">(</span><span class="s1">'#message'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_message</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Open 3DSecure dialog box
</span>  <span class="kd">function</span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">fancybox</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span>
          <span class="na">href</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
          <span class="na">type</span><span class="p">:</span> <span class="s1">'iframe'</span><span class="p">,</span>
          <span class="na">autoSize</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">width</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>
          <span class="na">height</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
          <span class="na">closeBtn</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">modal</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Close 3DSecure dialog box
</span>  <span class="kd">function</span> <span class="nx">closeDialog</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">fancybox</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre>
Once the customer clicks ‘Pay’, the Javascript will populate the <code>card_number</code> , <code>card_exp_month</code>, <code>card_exp_year</code>, and <code>cvv</code> from the form. Then, utilizing <code>veritrans.js</code>, the script will send sensitive data securely to the veritrans server and return a <code>token_id</code>. Once you receive the <code>token_id</code>, the script will save it in the hidden textfield <code>#token_id</code> and then will submit the form to the merchant’s server (<code>checkout_process.php</code>). Note that the credit card number will not be sent to the merchant server, and the merchant will only record the <code>token_id</code>.

<h4 id="activate">Activating 3DSecure</h4>

If you want to process using 3D-Secure, please use the script below:

<pre class="highlight javascript"><span class="c1">//...
</span><span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s1">'card_number'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_month'</span>  <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-month&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_year'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-year&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_cvv'</span>      <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>

    <span class="c1">// Set 'secure', 'bank', and 'gross_amount', if the merchant wants transaction to be processed with 3D Secure
</span>    <span class="c1">// 'secure'     : true,
</span>    <span class="c1">// 'bank'     : 'bni',
</span>    <span class="c1">// 'gross_amount'   : 200000
</span>  <span class="p">}</span>
<span class="p">};</span>
<span class="c1">//...
</span></pre>
For 3DSecure transactions, you need to add the parameters<code>secure</code>, <code>bank</code>, and <code>gross_amout</code>. 

<table>
  <tr>
    <th>Parameter</th>
    <th>Definition</th>
  </tr>
  <tr>
    <td><code>secure</code></td>
    <td>Marker for 3DSecure transaction.</td>
  </tr>
  <tr>
    <td><code>bank</code></td>
    <td>Acquiring bank.</td>
  </tr>
  <tr>
    <td><code>gross_amount</code></td>
    <td>Total amount of money to be charged.</td>
  </tr>
</table>

Uncomment a portion of the script above to get the following:

<pre class="highlight javascript"><span class="c1">//...
</span><span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s1">'card_number'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-number&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_month'</span>  <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-month&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_exp_year'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-expiry-year&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="s1">'card_cvv'</span>      <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>

    <span class="c1">// Set 'secure', 'bank', and 'gross_amount', if the merchant wants transaction to be processed with 3D Secure
</span>    <span class="s1">'secure'</span>      <span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s1">'bank'</span>        <span class="err">:</span> <span class="s1">'bni'</span><span class="p">,</span>
    <span class="s1">'gross_amount'</span>    <span class="err">:</span> <span class="mi">200000</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="c1">//...
</span></pre>
</div><!-- end of step 1-->

<div class="tab-pane" id="step2"><!-- step 2-->

<!-- dua -->

<h3 id="charge">Charge Transaction</h3>

On merchant server (<code>checkout_process.php</code>), after receiving <code>token_id</code>, merchant can send charge transaction request with the following specification:<br />

Note: Charge transaction request specification for 3DSecure and normal transactions are the same. The only difference is when calling Get Token.

<table>
  <tr>
    <td>Endpoint</td>
    <td>/v2/charge</td>
  </tr>
  <tr>
    <td>Header</td>
    <td>Content-Type: application/json<br />
Accept: application/json</td>
  </tr>
  <tr>
    <td>HTTP Method</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Authorization</td>
    <td>Basic (<code>server_key</code>:)</td>
  </tr>
</table>

The messages that are sent during request contain transaction details. The messages is in JSON format. Example:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">&quot;payment_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s2">&quot;credit_card&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;token_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;401111-1112-e9dc7213-8b2c-4353-93a4-b250680e57a5&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;bank&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bni&quot;</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">&quot;transaction_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order52&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;gross_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200000</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">&quot;item_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;item1&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100000</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Adidas f50&quot;</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;item2&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50000</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nike N90&quot;</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="s2">&quot;customer_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;last_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Customer&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jcustomer@example.com&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;08195010132&quot;</span><span class="p">,</span><span class="w">
        </span><span class="s2">&quot;billing_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;last_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Customer&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Karet&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Jakarta&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;postal_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;523112&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;08191231234&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;country_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IDN&quot;</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">&quot;shipping_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;last_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Watson&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bakerstreet 221B&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;London&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;postal_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;12354&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;081323123123&quot;</span><span class="p">,</span><span class="w">
            </span><span class="s2">&quot;country_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IDN&quot;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
Object Description <code>JSON Request</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribute</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>payment_type</code></td>
            <td>String</td>
            <td>Yes</td>
            <td>Payment type options will be used. For example: <br />
                <ul>
                    <li>With VT-Direct:
                        <ul>
                            <li>Fill “CREDIT_CARD” for payment with VT-Direct.</li>
                        </ul>
                    </li>
                    <li>With VT-WEB:
                        <ul>
                            <li>Fill “VTWEB” for payment with VT-Web</li>
                        </ul>
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td><code>credit_card</code></td>
            <td>JSON Object</td>
            <td>Yes</td>
            <td>Specific field if using payment type: "CREDIT_CARD"</td>
        </tr>
        <tr>
            <td><code>transaction_details</code></td>
            <td>JSON Object</td>
            <td>Yes</td>
            <td>Transaction data detail that will be paid by customer</td>
        </tr>
        <tr>
            <td><code>item_details</code></td>
            <td>JSON Array</td>
            <td>Yes</td>
            <td>Shopping item detail that will be paid by customer</td>
        </tr>
        <tr>
            <td><code>customer_details</code></td>
            <td>JSON Object</td>
            <td>Yes</td>
            <td>Customer data detail that make payment</td>
        </tr>
    </tbody>
</table>

Object Description <code>credit_card</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribute</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>token_id</code></td>
            <td>Yes</td>
            <td>Representations of the credit card data that is stored in tokens</td>
        </tr>
        <tr>
            <td><code>bank</code></td>
            <td>Ya</td>
            <td>Acquirer bank used</td>
        </tr>
    </tbody>
</table>

Object Description <code>transaction_details</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribute</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>order_id</code></td>
            <td>String(50)</td>
            <td>Yes</td>
            <td>Customer Payment ID</td>
        </tr>
        <tr>
            <td><code>gross_amount</code></td>
            <td>Long</td>
            <td>Yes</td>
            <td>Total of transaction price that will be paid by customer</td>
        </tr>
    </tbody>
</table>

Object Description <code>item_details</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribute</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>id</code></td>
            <td>String(50)</td>
            <td>Yes</td>
            <td>Item ID</td>
        </tr>
        <tr>
            <td><code>price</code></td>
            <td>Long</td>
            <td>Yes</td>
            <td>Item Price</td>
        </tr>
        <tr>
            <td><code>quantity</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td>Total Item</td>
        </tr>
        <tr>
            <td><code>name</code></td>
            <td>String(50)</td>
            <td>Yes</td>
            <td>Item Name</td>
        </tr>
    </tbody>
</table>

Object Description <code>customer_details</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribute</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>first_name</code></td>
            <td>String(20)</td>
            <td>Yes</td>
            <td>Customer first name</td>
        </tr>
        <tr>
            <td><code>last_name</code></td>
            <td>String(20)</td>
            <td>Recommended</td>
            <td>Customer last name</td>
        </tr>
        <tr>
            <td><code>email</code></td>
            <td>String(45)</td>
            <td>Yes</td>
            <td>Customer email.<br />
Note: there is a validation to check valid email</td>
        </tr>
        <tr>
            <td><code>phone</code></td>
            <td>String(19)</td>
            <td>Yes</td>
            <td>Customer phone number. <br />
                Note: Minimum length 5, can only accept numeric and symbols +, -, (space), and (). For the + symbol itself can only be placed in the front.
            </td>
        </tr>
        <tr>
            <td><code>billing_address</code></td>
            <td>JSON Object</td>
            <td>Optional, except for payment type using credit card, this attribute is mandatory</td>
            <td>Billing address customer</td>
        </tr>
        <tr>
            <td><code>shipping_address</code></td>
            <td>JSON Object</td>
            <td>Recommended</td>
            <td>Shipping address customer</td>
        </tr>
    </tbody>
</table>

Object Description <code>billing_address</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribute</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>first_name</code></td>
            <td>String(20)</td>
            <td>Recommended</td>
            <td>Billing address first name. <br />
 Note : No need to be filled if same as the customer details - first_name</td>
        </tr>
        <tr>
            <td><code>last_name</code></td>
            <td>String(20)</td>
            <td>Recommended</td>
            <td>Billing address last name</td>
        </tr>
        <tr>
            <td><code>address</code></td>
            <td>String(200)</td>
            <td>Optional, except for payment using credit card, this attribute is mandatory</td>
            <td>Address of billing address</td>
        </tr>
        <tr>
            <td><code>city</code></td>
            <td>String(20)</td>
            <td>Optional, except for payment using credit card, this attribute is mandatory</td>
            <td>Billing address city</td>
        </tr>
        <tr>
            <td><code>postal_code</code></td>
            <td>String(10)</td>
            <td>Optional, except for payment using credit card, this attribute is mandatory</td>
            <td>Shipping address postal code<br />
                Note: format alpha-numeric, can accept “-” and space
            </td>
        </tr>
        <tr>
            <td><code>phone</code></td>
            <td>String(19)</td>
            <td>Recommended</td>
            <td>Billing address phone number. <br />
                Note: No need to be filled if same as the customer details - phone. Minimum length 5, can only accept numeric and symbols +, -, (space), and (). For the + symbol itself can only be placed in the front.
            </td>
        </tr>
        <tr>
            <td><code>country_code</code></td>
            <td>String(10)</td>
            <td>Recommended</td>
            <td>Country ID (contoh: IDN)</td>
        </tr>
    </tbody>
</table>

Object Description <code>shipping_address</code>:

<table>
    <thead>
        <tr>
            <th>JSON Attribuet</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>first_name</code></td>
            <td>String(20)</td>
            <td>Recommended</td>
            <td>Shipping address first name</td>
        </tr>
        <tr>
            <td><code>last_name</code></td>
            <td>String(20)</td>
            <td>Recommended</td>
            <td>Shipping address last name</td>
        </tr>
        <tr>
            <td><code>address</code></td>
            <td>String(200)</td>
            <td>Recommended</td>
            <td>Address of shipping address</td>
        </tr>
        <tr>
            <td><code>city</code></td>
            <td>String(20)</td>
            <td>Recommended</td>
            <td>Shipping address city</td>
        </tr>
        <tr>
            <td><code>postal_code</code></td>
            <td>String(10)</td>
            <td>Optional, except for payment using credit card, this attribute is mandatory</td>
            <td>Shipping address postal code<br />
Note: format alpha-numeric, can accept “-” and space</td>
        </tr>
        <tr>
            <td><code>phone</code></td>
            <td>String(19)</td>
            <td>Dianjurkan</td>
            <td>Nomor telpon billing address. <br />
Note : Tidak perlu diisi apabila isinya sama dengan customer details - phone. Panjang minimum 5, hanya bisa menerima numeric dan simbol +, -, (spasi), dan (). Untuk simbol + sendiri hanya bisa ditempatkan di paling depan.</td>
        </tr>
        <tr>
            <td><code>country_code</code></td>
            <td>String(10)</td>
            <td>Recommended</td>
            <td>Country ID (contoh: IDN)</td>
        </tr>
    </tbody>
</table>

Below is an example on how to implement charge transaction request in PHP. We will call it <code>checkout_process.php</code>.

<pre class="highlight php"><span class="cp">&lt;?php</span>
<span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'token_id'</span><span class="p">]))</span> 
<span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;Empty token_id.&quot;</span><span class="p">;</span>
  <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// TODO: change with your actual server_key that can be found on Merchant Administration Portal (MAP)
</span><span class="nv">$server_key</span> <span class="o">=</span> <span class="s2">&quot;1a794e3f-f023-4cda-92b7-dcb7a22a46ff&quot;</span><span class="p">;</span>
<span class="nv">$endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://api.sandbox.veritrans.co.id/v2/charge&quot;</span><span class="p">;</span>

<span class="c1">// token_id represents credit card to be charged.
// token_id was acquired from request through veritrans.js
</span><span class="nv">$token_id</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'token_id'</span><span class="p">];</span>

<span class="nv">$transaction_details</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'order_id'</span>    <span class="o">=&gt;</span> <span class="s1">'order375'</span><span class="p">,</span>
  <span class="s1">'gross_amount'</span>  <span class="o">=&gt;</span> <span class="mi">200000</span>
<span class="p">);</span>

<span class="nv">$items</span> <span class="o">=</span> <span class="p">[</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span>    <span class="o">=&gt;</span> <span class="s1">'item1'</span><span class="p">,</span>
    <span class="s1">'price'</span>   <span class="o">=&gt;</span> <span class="mi">100000</span><span class="p">,</span>
    <span class="s1">'quantity'</span>  <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'name'</span>    <span class="o">=&gt;</span> <span class="s1">'Adidas f50'</span>
  <span class="p">),</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span>    <span class="o">=&gt;</span> <span class="s1">'item2'</span><span class="p">,</span>
    <span class="s1">'price'</span>   <span class="o">=&gt;</span> <span class="mi">50000</span><span class="p">,</span>
    <span class="s1">'quantity'</span>  <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">'name'</span>    <span class="o">=&gt;</span> <span class="s1">'Nike N90'</span>
  <span class="p">)</span>
<span class="p">];</span>

<span class="nv">$billing_address</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'first_name'</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
  <span class="s1">'last_name'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Customer&quot;</span><span class="p">,</span>
  <span class="s1">'address'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;Karet&quot;</span><span class="p">,</span>
  <span class="s1">'city'</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Jakarta&quot;</span><span class="p">,</span>
  <span class="s1">'postal_code'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;51161&quot;</span><span class="p">,</span>
  <span class="s1">'phone'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;081312341234&quot;</span><span class="p">,</span>
  <span class="s1">'country_code'</span>  <span class="o">=&gt;</span> <span class="s1">'IDN'</span>
  <span class="p">);</span>

<span class="nv">$shipping_address</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'first_name'</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
  <span class="s1">'last_name'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Watson&quot;</span><span class="p">,</span>
  <span class="s1">'address'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;Bakerstreet 221B.&quot;</span><span class="p">,</span>
  <span class="s1">'city'</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Jakarta&quot;</span><span class="p">,</span>
  <span class="s1">'postal_code'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;51162&quot;</span><span class="p">,</span>
  <span class="s1">'phone'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;081312341235&quot;</span><span class="p">,</span>
  <span class="s1">'country_code'</span>  <span class="o">=&gt;</span> <span class="s1">'IDN'</span>
  <span class="p">);</span>

<span class="nv">$customer_details</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'first_name'</span>  <span class="o">=&gt;</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
  <span class="s1">'last_name'</span>   <span class="o">=&gt;</span> <span class="s2">&quot;Customer&quot;</span><span class="p">,</span>
  <span class="s1">'email'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;jcustomer@example.com&quot;</span><span class="p">,</span>
  <span class="s1">'phone'</span>     <span class="o">=&gt;</span> <span class="s2">&quot;081312341234&quot;</span><span class="p">,</span>
  <span class="s1">'billing_address'</span>  <span class="o">=&gt;</span> <span class="nv">$billing_address</span><span class="p">,</span>
  <span class="s1">'shipping_address'</span> <span class="o">=&gt;</span> <span class="nv">$shipping_address</span>
  <span class="p">);</span>

<span class="c1">// Data that will be send for credit card charge transaction request.
</span><span class="nv">$transaction_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'payment_type'</span>    <span class="o">=&gt;</span> <span class="s1">'credit_card'</span><span class="p">,</span> 
  <span class="s1">'credit_card'</span>     <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'token_id'</span>      <span class="o">=&gt;</span> <span class="nv">$token_id</span><span class="p">,</span>
    <span class="s1">'bank'</span>          <span class="o">=&gt;</span> <span class="s1">'bni'</span>
    <span class="p">),</span>
  <span class="s1">'transaction_details'</span>   <span class="o">=&gt;</span> <span class="nv">$transaction_details</span><span class="p">,</span>
  <span class="s1">'item_details'</span>          <span class="o">=&gt;</span> <span class="nv">$items</span><span class="p">,</span>
  <span class="s1">'customer_details'</span>      <span class="o">=&gt;</span> <span class="nv">$customer_details</span>
  <span class="p">);</span>

<span class="nv">$json_transaction_data</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$transaction_data</span><span class="p">);</span>

<span class="c1">// Send the request using CURL
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$endpoint</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$json_transaction_data</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">'Authorization: Basic %s'</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$server_key</span><span class="o">.</span><span class="s1">':'</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'Content-Type: application/json'</span><span class="p">,</span>
  <span class="s1">'Accept: application/json'</span><span class="p">,</span>
  <span class="nv">$auth</span> 
  <span class="p">)</span>
<span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">));</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fraud_status</span> <span class="o">==</span> <span class="s2">&quot;capture&quot;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//success
</span>  <span class="k">echo</span> <span class="s2">&quot;Transaksi berhasil. &lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;Status transaksi untuk order id &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fraud_status</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Detail transaksi:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fraud_status</span> <span class="o">==</span> <span class="s2">&quot;deny&quot;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//deny
</span>  <span class="k">echo</span> <span class="s2">&quot;Transaksi ditolak. &lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;Status transaksi untuk order id &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fraud_status</span><span class="p">;</span>

  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Detail transaksi:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fraud_status</span> <span class="o">==</span> <span class="s2">&quot;challenge&quot;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">//challenge
</span>  <span class="k">echo</span> <span class="s2">&quot;Transaksi challenge. &lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;Status transaksi untuk order id &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fraud_status</span><span class="p">;</span>

  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Detail transaksi:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
  <span class="c1">//error
</span>  <span class="k">echo</span> <span class="s2">&quot;Terjadi kesalahan pada data transaksi yang dikirim.&lt;br /&gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;Result:&lt;/h3&gt;&quot;</span><span class="p">;</span>
  <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre>
</div><!-- end of step 2-->

<div class="tab-pane" id="step3"><!-- step 3-->

<!-- tiga -->

<h3> Handling Response </h3>
<h4>Success Response</h4>

If request succeed, the following response will be returned in JSON format:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="err">transaction_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;93c6a0ff-b270-4b00-adba-f1738ff90261&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">order_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;201303131610&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">gross_amount</span><span class="p">:</span><span class="w"> </span><span class="mi">100000000</span><span class="p">,</span><span class="w">
    </span><span class="err">payment_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_time</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-13 16:10:15&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capture&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">fraud_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;accept&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">masked_card</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;401111-1112&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_code</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_message</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK, Credit Card transaction is successful&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<h4>Error Response</h4>

If there is error during the request, for example using the same <code>order_id</code> again for another request, the following response will be returned:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;406&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s2">&quot;status_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Merchant charges the same order id more than once or transaction has been paid&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
If the bank denied the credit card, the following response will be returned:

<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="err">transaction_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ee946272-44b9-4e19-8ae7-ffd12c2cbb18&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">order_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;201303131612&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">gross_amount</span><span class="p">:</span><span class="w"> </span><span class="mi">100000000</span><span class="p">,</span><span class="w">
    </span><span class="err">payment_type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_time</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-13 16:12:35&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">transaction_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;deny&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">fraud_status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;challenge&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">masked_card</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;401111-1112&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_code</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;201&quot;</span><span class="p">,</span><span class="w">
    </span><span class="err">status_message</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Deny by Bank [MANDIRI] with code [05] and    message [Do not honour]&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
Once charge transaction has been completed and received success response (<code>transaction_status = ’capture’</code>), credit card has been charged to merchant’s account. Merchant can use such response to update his database, for example, to mark the transaction with <code>order_id</code> has been paid. The transaction details will also be reflected in Merchant Administration Portal (MAP). Merchant can login to MAP to see the updated transaction details.
</div><!-- end of step 3-->

  
</div>
<!-- end of tab-content-->



			<div class="pagination">
				<ul><li class="left">« Previous: <a href="getting_started.html">VT-Direct: Getting Started</a></li><li class="right">Next: <a href="going_live.html">VT-Direct: Going Live</a> »</li></ul>
			</div>
          </div>
        </div><!--/span-->
      </div><!--/row-->

    </div><!--/.container-->
    <div class="custom-container footer">
  <div class="wrapper">
    <div class="row">
      <div class="col-md-12 footer-nav">
        <div class="content text-center">
          <a href="https://www.veritrans.co.id" title="">Home</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/whatwedo.html" title="">What We Do</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/pricing.html" title="">Pricing</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/about.html" title="">About</a> <span class="divider">|</span>
          <a href="http://blog.veritrans.co.id/" title="">Blog</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/career.html" title="">Career</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/contact.html" title="">Contact</a> <span class="divider">|</span>
          <a href="http://docs.veritrans.co.id/" title="">Docs</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/press.html" title="">Press</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/privacy.html" title="">Privacy Policy</a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 copyright">
        <div class="content text-center">
          <span>©2014 PT. Midtrans (Veritrans Indonesia). All Rights Reserved</span>
        </div>
      </div>
    </div>
  </div>
</div>

    <script src="../javascripts/jquery-1.10.2.min.js" type="text/javascript"></script>
<script src="../javascripts/bootstrap.min.js" type="text/javascript"></script>
    <script>
    $(document).ready(function() {
      $('[data-toggle=offcanvas]').click(function() {
        $('.row-offcanvas').toggleClass('active');
      });
    });
    </script>
  </body>
</html>
