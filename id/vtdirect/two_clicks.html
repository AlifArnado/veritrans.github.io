<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Veritrans API Documentation. Payment Gateway Indonesia, transaksi online lebih aman, mudah, cepat! Veritrans memberi solusi sistem payment gateway terbaik untuk e-commerce di Indonesia.">
    <meta name="keywords" content="Veritrans, Veritrans Indonesia, payment gateway indonesia, Pembayaran Online Indonesia, online payment Indonesia, sistem transaksi online"> 
    <link href="../../stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <title>Docs - Veritrans Indonesia</title>
		<link rel="shortcut icon" href="/favicon.ico"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!-- Fixed navbar -->
<div class="header navbar navbar-default navbar-fixed-top">
  <div class="custom-container">
    <div class="col-md-3 navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <h2 class="logo"><a href="https://www.veritrans.co.id/" title="Home"><span>Veritrans</span></a></h2>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="https://www.veritrans.co.id/whatwedo.html">what we do</a></li>
				<li><a href="https://www.veritrans.co.id/index.html#vt-products" title="Our Online Payment Products">products</a></li>
        <li><a href="https://www.veritrans.co.id/pricing.html">pricing</a></li>
        <li><a href="https://www.veritrans.co.id/about.html">about</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">developer <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="https://www.veritrans.co.id/sandbox.html">sandbox</a></li>
            <li><a href="http://docs.veritrans.co.id/">documentation</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">more <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="http://docs.veritrans.co.id/faq/general.html" title="FAQ & How To">FAQ</a></li>
            <li><a href="http://blog.veritrans.co.id" title="Blog, News and Press Release">blog</a></li>
            <li><a href="https://www.veritrans.co.id/career.html" title="Career at Veritrans">career</a></li>
            <li><a href="https://www.veritrans.co.id/contact.html" title="Contact Us">contact</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right register-login">
        <li class="pull-left"><a href="https://my.veritrans.co.id/register" class="register">register</a></li>
        <li class="pull-left"><a href="https://my.veritrans.co.id/login">login</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>

    <div class="custom-container">
      <div class="row row-offcanvas row-offcanvas-right">
        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
	<div class="documentation-sidebar">
		<div class="docs-logo">
			<span>DOCS</span>
		</div>
		<div class="language-toggle"> <a href="../../vtdirect/two_clicks.html">English</a> / Bahasa Indonesia</div>
		<ul class="sidebar">
			<li><a class="parent">Payment API</a>
				<ul class="child-menu">
					
					<li class=""><a href="../payment_api/introduction.html">Perkenalan</a></li>
					
					<li class=""><a href="../payment_api/payment_type.html">Jenis Pembayaran</a></li>
					
					<li class=""><a href="../payment_api/payment_method.html">Cara Pembayaran</a></li>
					
				</ul>
			</li>
			<li><a class="parent">VT-Web</a>
				<ul class="child-menu">
					
					<li class=""><a href="../vtweb/introduction.html">Perkenalan</a></li>
					
					<li class=""><a href="../vtweb/getting_started.html">Langkah Awal</a></li>
					
					<li class=""><a href="../vtweb/get_redirect_url.html">Mendapatkan Redirect URL</a></li>
					
					<li class=""><a href="../vtweb/redirect.html">Redirect</a></li>
					
					<li class=""><a href="../vtweb/handle_notification.html">Menangani Notifikasi</a></li>
					
					<li class=""><a href="../vtweb/going_live.html">Going Live</a></li>
					
					<li class=""><a href="../vtweb/sample_code.html">Kode Contoh</a></li>
					
					<li class=""><a href="../vtweb/status_code.html">Kode Status</a></li>
					
				</ul>
			</li>
			<li><a class="parent">VT-Direct</a>
				<ul class="child-menu">
					
					<li class=""><a href="introduction.html">Perkenalan</a></li>
					
					<li class=""><a href="getting_started.html">Langkah Awal</a></li>
					
					<li class=""><a href="integration.html">Integrasi</a></li>
					
					<li class=""><a href="going_live.html">Going Live</a></li>
					
					<li class=""><a href="other_commands.html">Perintah Lain</a></li>
					
					<li class=""><a href="other_features.html">Fitur Lain</a></li>
					
					<li class=""><a href="payment_options.html">Pilihan Pembayaran</a></li>
					
					<li class=""><a href="examples.html">Contoh</a></li>
					
					<li class=""><a href="status_code.html">Kode Status</a></li>
					
				</ul>
			</li>
			<li><a class="parent">Sandbox</a>
				<ul class="child-menu">
					
					<li class=""><a href="../sandbox/difference.html">Perbedaan Sandbox dan Production</a></li>
					
					<li class=""><a href="../sandbox/testing_vtweb.html">Pengujian VTWeb di Sandbox</a></li>
					
					<li class=""><a href="../sandbox/card_list.html">Kartu Kredit untuk Testing</a></li>
					
				</ul>
			</li>
			<li><a class="parent">How to</a>
				<ul class="child-menu">
					
					<li class=""><a href="../howto/fds.html">Sistem Deteksi Fraud</a></li>
					
					<li class=""><a href="../howto/cancel.html">Pembatalan Transaksi</a></li>
					
				</ul>
			</li>
			<li><a class="parent">FAQ</a>
				<ul class="child-menu">
					
					<li class=""><a href="../faq/general.html">Informasi Umum</a></li>
					
					<li class=""><a href="../faq/pricing.html">Biaya</a></li>
					
					<li class=""><a href="../faq/fraud_and_security.html">Fraud dan Security</a></li>
					
					<li class=""><a href="../faq/integration.html">Integrasi</a></li>
					
					<li class=""><a href="../faq/account_management.html">Manajemen Akun</a></li>
					
					<li class=""><a href="../faq/fds_response.html">Respon Fraud Detection System (FDS)</a></li>
					
				</ul>
			</li>
		</ul>
	</div>
</div><!--/span-->
        <div class="col-xs-12 col-sm-9" id="bodier">
          <p class="pull-right visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Menu</button>
          </p>
          <div class="id-vtdirect-two-clicks">
            <h2 id="fitur-lain">Fitur Lain</h2>

<p>Saat ini Veritrans memiliki fitur lain untuk kartu kredit, yaitu:</p>

<ol>
  <li><a href="other_features.html#pre-authorization">Pre-Authorization</a></li>
  <li><a href="other_features.html#installment">Installment</a></li>
  <li><a href="other_features.html#oneclick">One Click</a></li>
  <li><a href="two_clicks.html">Two Click</a></li>
</ol>

<p>Berikut adalah tutorial untuk melakukan integrasi Two clicks sesuai dengan kebutuhan anda.</p>

<h3 id="two-click">Two Click</h3>

<h4 id="mendapatkan-token-3dsecure">Mendapatkan Token 3DSecure</h4>

<p>Sama seperti One Click, token 3DSecure harus diaktifkan untuk menggunakan fitur Two Clicks. Silahkan lihat bagian <a href="integration.html#activate">Mengaktifkan fitur VT-Direct 3DSecure</a> untuk request parameter yang dibutuhkan oleh token 3DSecure.</p>

<h4 id="charge-request-pertama">Charge Request Pertama</h4>

<p>Charge request pertama untuk Two Clicks untuk mempunyai format yang sama persis dengan charge request pertama pada One Click. Pada charge request pertama, <code>"save_token_id": true</code> harus di masukan di JSON request dalam bagian <code>"credit_card"</code>. Dengan demikian, token akan disimpan untuk pembayaran berikutnya. Contoh dalam PHP:</p>

<pre class="highlight php">// Data yang akan dikirim untuk request charge transaction dengan credit card.
$transaction_data = array(
  'payment_type'      =&gt; 'credit_card', 
  'credit_card'       =&gt; array(
    'save_token_id'   =&gt; true,
    'token_id'        =&gt; $token_id,
    'bank'            =&gt; 'cimb'
  ),
  'transaction_details'   =&gt; $transaction_details,
  'item_details'          =&gt; $items,
  'customer_details'      =&gt; $customer_details
);
</pre>
<p>Response yang akan dikembalikan jika transaksi sukses seperti berikut ini:</p>

<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">&quot;transaction_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ca5e0ff5-4297-48ef-aa25-b3ab018d4ead&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order52&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;gross_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200000&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;payment_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;transaction_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-27 17:20:53&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;transaction_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capture&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;fraud_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;accept&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;masked_card&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;401111-1112&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;saved_token_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4011117d16c884-2cc7-4624-b0a8-10273b7f6cc8&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;saved_token_id_expired_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-03-27 17:20:53&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;status_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK, Credit Card 3D Secure transaction is successful&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Dari response di atas, hasil <code>"saved_token_id"</code> perlu disimpan oleh merchant, misalnya di database, sehingga dapat digunakan untuk pembayaran berikutnya.</p>

<h4 id="charge-request-berikutnya-normal">Charge Request Berikutnya (Normal)</h4>

<p>Untuk charge request berikutnya, meminta customer memasukkan CVV kartu kredit dan mendapatkan <code>"token_id"</code> yang di hasilkan dari CVV dan <code>"saved_token_id"</code>. </p>

<pre class="highlight html"><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;token_id&quot;</span> <span class="na">name=</span><span class="s">&quot;token_id&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span><span class="nt">&gt;</span>
</pre>
<p>Untuk mendapatkan <code>"token_id"</code> tersebut, merchant harus menambahkan parameter <code>"two_click": true</code> pada function card yang digunakan pada contoh script di bawah ini. Detail kartu kredit ini kemudian dikirimkan ke endpoint kami bersama dengan client-key merchant pada <code>Veritrans.client_key</code>. Setelah mendapat response, field <code>"token_id"</code> tadi dapat diisi dengan nilai yang ada pada response.token_id. Contoh kode javascript untuk mendapatkan <code>"token_id"</code> adalah seperti di bawah ini.</p>

<pre class="highlight javascript"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
   <span class="c1">//endpoint
</span>   <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.sandbox.veritrans.co.id/v2/token&quot;</span><span class="p">;</span>
   <span class="c1">//client_key
</span>   <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">client_key</span> <span class="o">=</span> <span class="s2">&quot;bb558bb6-371a-415b-b7ee-bf285f33868f&quot;</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
   <span class="k">return</span> <span class="p">{</span>
       <span class="s1">'card_cvv'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
       <span class="s1">'token_id'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.saved-token-id&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span> <span class="c1">// Dari database
</span>       <span class="s1">'two_click'</span>  <span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
     <span class="p">}</span>
   <span class="p">};</span>

   <span class="c1">// handler when user click the 'Pay' button.
</span>   <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
     <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
     <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span><span class="p">);</span>
     <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">token</span><span class="p">(</span><span class="nx">card</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
   <span class="p">});</span>

   <span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_code</span> <span class="o">==</span> <span class="s1">'200'</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// success
</span>       <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#token_id&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">token_id</span><span class="p">);</span>
       <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#payment-form&quot;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="c1">// failed request token
</span>       <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">'disabled'</span><span class="p">);</span>
       <span class="c1">// Show status message.
</span>       <span class="nx">$</span><span class="p">(</span><span class="s1">'#message'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_message</span><span class="p">);</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
     <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">});</span>
<span class="o">&lt;</span><span class="sr">/</span><span class="err">script&gt;</span>
</pre>
<p>Setelah itu, merchant harus menggunakan token id yang didapat, yaitu <code>"token_id"</code>. Token tersebut diletakkan di bagian <code>"credit_card"</code> sehingga format JSON lengkapnya menjadi seperti berikut.</p>

<pre class="highlight php">$token_id = $_POST['token_id']; // dari request token two_click
$transaction_details = array(
    'order_id'       =&gt; 'order_1342',
    'gross_amount'     =&gt; 200000
);
$items = array( //items that customer buys
    array(
     'id'      =&gt; 'item1',
     'price'     =&gt; 100000,
     'quantity'     =&gt; 1,
     'name'      =&gt; 'Adidas f50'
    ),
    array(
     'id'      =&gt; 'item2',
     'price'     =&gt; 50000,
     'quantity'     =&gt; 2,
     'name'      =&gt; 'Nike N90'
    )
);
$billing_address = array( //customer's billing address
    'first_name'     =&gt; &quot;Andri&quot;,
    'last_name'     =&gt; &quot;Setiawan&quot;,
    'address'      =&gt; &quot;Karet Belakang 15A, Setiabudi.&quot;,
    'city'         =&gt; &quot;Jakarta&quot;,
    'postal_code'     =&gt; &quot;51161&quot;,
    'phone'      =&gt; &quot;081322311801&quot;,
    'country_code'     =&gt; 'IDN'
    );
$shipping_address = array( //customer's shipping address
    'first_name'     =&gt; &quot;John&quot;,
    'last_name'     =&gt; &quot;Watson&quot;,
    'address'      =&gt; &quot;Bakerstreet 221B.&quot;,
    'city'         =&gt; &quot;Jakarta&quot;,
    'postal_code'     =&gt; &quot;51162&quot;,
    'phone'      =&gt; &quot;081322311801&quot;,
    'country_code'     =&gt; 'IDN'
    );
$customer_details = array( //customer's Info
    'first_name'     =&gt; &quot;Andri&quot;,
    'last_name'     =&gt; &quot;Setiawan&quot;,
    'email'      =&gt; &quot;payment-api@veritrans.co.id&quot;,
    'phone'      =&gt; &quot;081322311801&quot;,
    'billing_address'  =&gt; $billing_address,
    'shipping_address' =&gt; $shipping_address
    );
$transaction_data = array( //
    'payment_type'     =&gt; 'credit_card',
    'credit_card'      =&gt; array(
     'token_id'       =&gt; $token_id,
     'bank'       =&gt; 'bni', // optional
     ),
    'transaction_details'  =&gt; $transaction_details,
    'item_details'      =&gt; $items,
    'customer_details'      =&gt; $customer_details
);
$json_transaction_data = json_encode($transaction_data);
</pre>
<p>JSON request format untuk charge transaksi sama seperti biasanya. Silahkan lihat <a href="integration.html">Charge Transaction</a> untuk format selengkapnya. Jika response sukses akan mendapatkan hasil sebagai berikut:</p>

<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">&quot;transaction_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05dfbd23-b767-4748-8fe9-7e30769e1857&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order53&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;gross_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200000&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;payment_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;transaction_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-27 17:25:12&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;transaction_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capture&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;status_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK, Credit Card transaction is successful&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<h4 id="charge-request-berikutnya-3d-secure">Charge Request Berikutnya (3D Secure)</h4>

<p>Untuk charge request berikutnya menggunakan 3DS, meminta customer memasukkan CVV kartu kredit dan mendapatkan <code>"token_id"</code> yang di hasilkan dari CVV dan <code>"saved_token_id"</code>. </p>

<pre class="highlight html"><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;token_id&quot;</span> <span class="na">name=</span><span class="s">&quot;token_id&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span><span class="nt">&gt;</span>
</pre>
<p>Untuk mendapatkan <code>"token_id"</code> tersebut, merchant harus menambahkan parameter <code>"two_click": true</code>, <code>"secure": true</code>, <code>"gross_amount"</code>, pada function card yang digunakan pada contoh script di bawah ini. Detail kartu kredit ini kemudian dikirimkan ke endpoint kami bersama dengan client-key merchant pada <code>Veritrans.client_key</code>. Setelah mendapat response, field <code>"redirect_url"</code> yang didapatkan dari <code>response.redirect_url</code> untuk membuka dialog 3D Secure.</p>

<p>Setelah proses 3D Secure selesai, gunakan field <code>"token_id"</code> yang didapatkan dari <code>response.token_id</code>. Contoh code javascript untuk mendapatkan <code>"token_id"</code> dan <code>"redirect_url"</code> adalah seperti di bawah ini.</p>

<pre class="highlight javascript"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
   <span class="c1">//endpoint
</span>   <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.sandbox.veritrans.co.id/v2/token&quot;</span><span class="p">;</span>
   <span class="c1">//client_key
</span>   <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">client_key</span> <span class="o">=</span> <span class="s2">&quot;bb558bb6-371a-415b-b7ee-bf285f33868f&quot;</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">card</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
   <span class="k">return</span> <span class="p">{</span>
       <span class="s1">'card_cvv'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.card-cvv&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
       <span class="s1">'token_id'</span>   <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.saved-token-id&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span> <span class="c1">// Dari database
</span>       <span class="s1">'two_click'</span>  <span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
       <span class="s1">'secure'</span>     <span class="err">:</span> <span class="kc">true</span><span class="p">,</span>
       <span class="s1">'bank'</span>       <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.bank&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span> <span class="c1">// optional (bni | mandiri | cimb)
</span>       <span class="s1">'gross_amount'</span> <span class="err">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.gross-amount&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
     <span class="p">}</span>
   <span class="p">};</span>

   <span class="c1">// handler when user click the 'Pay' button.
</span>   <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
     <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
     <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span><span class="p">);</span>
     <span class="nx">Veritrans</span><span class="p">.</span><span class="nx">token</span><span class="p">(</span><span class="nx">card</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
   <span class="p">});</span>

   <span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">redirect_url</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 3Dsecure transaction. Open 3Dsecure dialog
</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Open Dialog 3Dsecure'</span><span class="p">);</span>
            <span class="nx">openDialog</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">redirect_url</span><span class="p">);</span>

      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_code</span> <span class="o">==</span> <span class="s1">'200'</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// success 3d secure or success normal
</span>             <span class="c1">//close 3d secure dialog if any
</span>      <span class="nx">closeDialog</span><span class="p">();</span>

            <span class="c1">// store token data in input #token_id and then submit form to merchant server
</span>            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#token_id&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">token_id</span><span class="p">);</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#payment-form&quot;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// failed request token
</span>            <span class="c1">//close 3d secure dialog if any
</span>            <span class="nx">closeDialog</span><span class="p">();</span>
            <span class="nx">$</span><span class="p">(</span><span class="s1">'.submit-button'</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">'disabled'</span><span class="p">);</span>
            <span class="c1">// Show status message.
</span>            <span class="nx">$</span><span class="p">(</span><span class="s1">'#message'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status_message</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Open 3DSecure dialog box
</span>  <span class="kd">function</span> <span class="nx">openDialog</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">fancybox</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span>
          <span class="na">href</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
          <span class="na">type</span><span class="p">:</span> <span class="s1">'iframe'</span><span class="p">,</span>
          <span class="na">autoSize</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">width</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>
          <span class="na">height</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
          <span class="na">closeBtn</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">modal</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Close 3DSecure dialog box
</span>  <span class="kd">function</span> <span class="nx">closeDialog</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fancybox</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="o">&lt;</span><span class="sr">/</span><span class="err">script&gt;</span>
</pre>
<p>Setelah itu, merchant harus menggunakan token id yang didapat, yaitu <code>"token_id"</code>. Token tersebut diletakkan di bagian <code>"credit_card"</code> sehingga format JSON lengkapnya menjadi seperti berikut.</p>

<pre class="highlight php">$token_id = $_POST['token_id']; // dari request token two_click
$transaction_details = array(
    'order_id'       =&gt; 'order_1342',
    'gross_amount'     =&gt; 200000
);
$items = array( //items that customer buys
    array(
     'id'      =&gt; 'item1',
     'price'     =&gt; 100000,
     'quantity'     =&gt; 1,
     'name'      =&gt; 'Adidas f50'
    ),
    array(
     'id'      =&gt; 'item2',
     'price'     =&gt; 50000,
     'quantity'     =&gt; 2,
     'name'      =&gt; 'Nike N90'
    )
);
$billing_address = array( //customer's billing address
    'first_name'     =&gt; &quot;Andri&quot;,
    'last_name'     =&gt; &quot;Setiawan&quot;,
    'address'      =&gt; &quot;Karet Belakang 15A, Setiabudi.&quot;,
    'city'         =&gt; &quot;Jakarta&quot;,
    'postal_code'     =&gt; &quot;51161&quot;,
    'phone'      =&gt; &quot;081322311801&quot;,
    'country_code'     =&gt; 'IDN'
    );
$shipping_address = array( //customer's shipping address
    'first_name'     =&gt; &quot;John&quot;,
    'last_name'     =&gt; &quot;Watson&quot;,
    'address'      =&gt; &quot;Bakerstreet 221B.&quot;,
    'city'         =&gt; &quot;Jakarta&quot;,
    'postal_code'     =&gt; &quot;51162&quot;,
    'phone'      =&gt; &quot;081322311801&quot;,
    'country_code'     =&gt; 'IDN'
    );
$customer_details = array( //customer's Info
    'first_name'     =&gt; &quot;Andri&quot;,
    'last_name'     =&gt; &quot;Setiawan&quot;,
    'email'      =&gt; &quot;payment-api@veritrans.co.id&quot;,
    'phone'      =&gt; &quot;081322311801&quot;,
    'billing_address'  =&gt; $billing_address,
    'shipping_address' =&gt; $shipping_address
    );
$transaction_data = array( //
    'payment_type'     =&gt; 'credit_card',
    'credit_card'      =&gt; array(
     'token_id'       =&gt; $token_id,
     'bank'       =&gt; 'bni', // optional
     ),
    'transaction_details'  =&gt; $transaction_details,
    'item_details'      =&gt; $items,
    'customer_details'      =&gt; $customer_details
);
$json_transaction_data = json_encode($transaction_data);
</pre>
<p>JSON request format untuk charge transaksi sama seperti biasanya. Silahkan lihat <a href="integration.html">Charge Transaction</a> untuk format selengkapnya. Jika response sukses akan mendapatkan hasil sebagai berikut:</p>

<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">&quot;transaction_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05dfbd23-b767-4748-8fe9-7e30769e1857&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order53&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;gross_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200000&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;payment_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;credit_card&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;transaction_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2014-03-27 17:25:12&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;transaction_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;capture&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;status_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="p">,</span><span class="w">
  </span><span class="s2">&quot;status_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK, Credit Card transaction is successful&quot;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>


			<div class="pagination">
			</div>
          </div>
        </div><!--/span-->
      </div><!--/row-->

    </div><!--/.container-->
    <div class="custom-container footer">
  <div class="wrapper">
    <div class="row">
      <div class="col-md-12 footer-nav">
        <div class="content text-center">
          <a href="https://www.veritrans.co.id" title="">Home</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/whatwedo.html" title="">What We Do</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/pricing.html" title="">Pricing</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/about.html" title="">About</a> <span class="divider">|</span>
          <a href="http://blog.veritrans.co.id/" title="">Blog</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/career.html" title="">Career</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/contact.html" title="">Contact</a> <span class="divider">|</span>
          <a href="http://docs.veritrans.co.id/" title="">Docs</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/press.html" title="">Press</a> <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/privacy.html" title="">Privacy Policy</a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 copyright">
        <div class="content text-center">
          <span>©2014 PT. Midtrans (Veritrans Indonesia). All Rights Reserved</span>
        </div>
      </div>
    </div>
  </div>
</div>

    <script src="../../javascripts/jquery-1.10.2.min.js" type="text/javascript"></script>
<script src="../../javascripts/bootstrap.min.js" type="text/javascript"></script>
    <script>
    $(document).ready(function() {
      $('[data-toggle=offcanvas]').click(function() {
        $('.row-offcanvas').toggleClass('active');
      });
    });
    </script>
  </body>
</html>
