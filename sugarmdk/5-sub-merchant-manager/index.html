<!DOCTYPE html><!--[if lt IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie10 lt-ie9"><![endif]--><!--[if IE 9]><html class="no-js lt-ie10"><![endif]--><!--[if (gt IE 9)|!(IE)]<!--><html class="nojs"><!--<![endif]--><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Sub Merchant Manager</title><meta content="" name="description" /><meta content="width=device-width, initial-scale=1" name="viewport" /><link href="../../assets/stylesheets/app-cb52da42.css" media="screen" rel="stylesheet" type="text/css" /></head><body><!--[if lte IE 7]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><header><h1>Veritrans docs</h1></header><section><aside><menu><li><a href="/">Home</a></li><li><a href="/sugarmdk">Sugar MKD</a><ul><li><a href="/sugarmdk/1-introducing/">1. Introducing</a></li><li><a href="/sugarmdk/2-payment-manager/">2. Payment Manager</a></li><li><a href="/sugarmdk/3-handling-exception-and-error-codes/">3. Handling Exception and Error Codes</a></li><li><a href="/sugarmdk/4-order-manager/">4. Order Manager</a></li><li><a href="/sugarmdk/5-sub-merchant-manager/">5. Sub Merchant Manager</a></li><li><a href="/sugarmdk/6-veritrans-sandbox/">6. Veritrans Sandbox</a></li><li><a href="/sugarmdk/7-appendix/">7. Appendix</a></li></ul></li></menu></aside><article><h1>Sub Merchant Manager</h1>

<p>The Sub Merchant manager includes all functions related to the management of sub merchants.</p>

<h2>4.1 Sector Types</h2>

<p>For all Rakuten&rsquo;s submerchants we require a sector type for fraud detection purposes. We will diferenciate the fraud rules for each merchant depending on their risk categories. The sector type for which Rakuten need to submit for each sub-merchant are as follows (please note that the sector type will increase as the number of merchants at Rakuten increases):</p>

<table><thead>
<tr>
<th>Value</th>
<th style="text-align: center">Name</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td style="text-align: center">Low Risk</td>
<td style="text-align: left">Submerchant that sells high risk products and with high volume</td>
</tr>
<tr>
<td>2</td>
<td style="text-align: center">High Risk</td>
<td style="text-align: left">Submerchant that sells high risk products and with low volume</td>
</tr>
<tr>
<td>3</td>
<td style="text-align: center">High Risk - High Volume</td>
<td style="text-align: left">Submerchant that sells high risk products and with high volume</td>
</tr>
<tr>
<td>4</td>
<td style="text-align: center">Wine &amp; Food</td>
<td style="text-align: left">Submerchant that sells wine and food products</td>
</tr>
<tr>
<td>5</td>
<td style="text-align: center">Electronics</td>
<td style="text-align: left">Submerchant that sells electronic products</td>
</tr>
</tbody></table>

<p>Used by SubMerchant Object, Create SubMerchant, Update SubMerchant</p>

<p>Note: Sector Types can be added in the future. Currently the values for sector type can range between 1-99.</p>

<h2>4.2 Create sub-merchant</h2>

<p>The creation of sub-merchant requires Veritrans is using cache. Therefore, after the creation of new sub-merchant, Veritrans needs to clear the sub-merchant cache before it operates properly. The cache clearing period in Veritrans happens only <strong>once</strong> at <strong>11.59 PM</strong> everyday.</p>

<h6>Request Object Parameters to Create Sub-merchant</h6>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: center">Mandatory(Y/N)</th>
<th style="text-align: center">Size</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>SubMerchant</td>
<td style="text-align: center">parent</td>
<td style="text-align: center">Merchant</td>
<td style="text-align: center">N</td>
<td style="text-align: center"></td>
<td style="text-align: left">Parent merchant</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Id</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">N</td>
<td style="text-align: center">22</td>
<td style="text-align: left">Will be generated by Veritrans</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">username</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">N</td>
<td style="text-align: center">40</td>
<td style="text-align: left">Will be generated by Veritrans</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">password</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">N</td>
<td style="text-align: center">64</td>
<td style="text-align: left">Will be generated by Veritrans</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">40</td>
<td style="text-align: left">Merchant name</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: center">ANS</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">45</td>
<td style="text-align: left">Billing email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ownerName</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">100</td>
<td style="text-align: left">Name of the merchant owner/contact</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: center">NS</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">19</td>
<td style="text-align: left">Phone number of the owner/contact. Allowed symbols: +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">sectorType</td>
<td style="text-align: center">N</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">2</td>
<td style="text-align: left">The sector of the industry. Refer to the sector types table. 4.1 Sector Types.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">npwp</td>
<td style="text-align: center">NS</td>
<td style="text-align: center">N</td>
<td style="text-align: center">40</td>
<td style="text-align: left">Tax identifier number. Accept Numeric - .</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<h6>Method</h6>

<p>To create sub-merchants, use the method below which is provided by <code>SubMerchantManager</code>:</p>
<pre class="highlight java"><span class="n">subMerchantManager</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code</p>
<pre class="highlight java"><span class="n">VeritransAuthentication</span> <span class="n">veritransAuth</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VeritransAuthenticationImpl</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">veritransAuth</span><span class="o">);</span>

<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubMerchant</span><span class="o">();</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;Rakuten&quot;</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;0212007177&quot;</span><span class="o">);</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;@rakuten.com&quot;</span><span class="o">);</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setNpwp</span><span class="o">(</span><span class="s">&quot;2222222222222222&quot;</span><span class="o">);</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setOwnerName</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">);</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setSectorType</span><span class="o">(</span><span class="n">SectorType</span><span class="o">.</span><span class="na">HIGH_RISK_HIGH_VOLUME</span><span class="o">);</span>

<span class="n">subMerchantManager</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">);</span>
<span class="n">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
</pre>
<h6>Response Object Parameter from Create Sub-merchant</h6>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: center">Object</td>
<td style="text-align: left">Return the created sub-merchant. Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<h2>4.3 Update sub-merchant</h2>

<h6>Request Object Parameters to Update Sub-merchant</h6>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: center">Mandatory(Y/N)</th>
<th style="text-align: center">Size</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>SubMerchant</td>
<td style="text-align: center">parent</td>
<td style="text-align: center">Merchant</td>
<td style="text-align: center">N</td>
<td style="text-align: center"></td>
<td style="text-align: left">Parent merchant</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">merchantId</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">22</td>
<td style="text-align: left">Unique Identifier for sub-merchant</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">N</td>
<td style="text-align: center">40</td>
<td style="text-align: left">Name of the merchant</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: center">ANS</td>
<td style="text-align: center">N</td>
<td style="text-align: center">45</td>
<td style="text-align: left">Billing email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ownerName</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">N</td>
<td style="text-align: center">100</td>
<td style="text-align: left">Name of the merchant owner/contact</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: center">NS</td>
<td style="text-align: center">N</td>
<td style="text-align: center">19</td>
<td style="text-align: left">Phone number of the owner/contact. Allowed symbols: +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">sectorType</td>
<td style="text-align: center">Enum: SectorType</td>
<td style="text-align: center">N</td>
<td style="text-align: center"></td>
<td style="text-align: left">The sector of the industry. Refer to Sector Types Table.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">npwp</td>
<td style="text-align: center">N</td>
<td style="text-align: center">N</td>
<td style="text-align: center">40</td>
<td style="text-align: left">Tax identifier number</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<h6>Method</h6>

<p>To update sub-merchant, use the method below which is provided by <code>SubMerchantManager</code>:</p>
<pre class="highlight java"><span class="n">subMerchantManager</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code</p>
<pre class="highlight java"><span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>

<span class="c1">// get certain sub-merchant with id = &quot;A100000000000001000234&quot;</span>
<span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="c1">// set the name into &quot;RakutenChildUpdated2&quot;</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;RakutenChildUpdated2&quot;</span><span class="o">);</span>
<span class="n">subMerchant</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;0821111111616&quot;</span><span class="o">);</span>

<span class="c1">// update the sub-merchant properties which are set</span>
<span class="n">SubMerchant</span> <span class="n">subMerchantUpdated</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">);</span>

<span class="c1">// the returned sub-merchant name should be &quot;RakutenChildUpdated2&quot;</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">subMerchantUpdated</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</pre>
<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: center">Object</td>
<td style="text-align: left">Return the updated sub-merchant. Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<h2>4.4 Get sub-merchant</h2>

<h6>Request Object Parameters to Get Sub-merchant</h6>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: center">Mandatory(Y/N)</th>
<th style="text-align: left">Size</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>String</td>
<td style="text-align: center">merchantId</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">Y</td>
<td style="text-align: left">22</td>
<td style="text-align: left">Unique Identifier for sub-merchant</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<p>Method
To get sub-merchant, use the method below which is provided by SubMerchantManager :</p>
<pre class="highlight java"><span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">merchantId</span><span class="o">);</span>
</pre>
<p>Sample Code</p>
<pre class="highlight java"><span class="n">VeritransAuthentication</span> <span class="n">veritransAuth</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VeritransAuthenticationImpl</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">veritransAuth</span><span class="o">);</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gson</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">));</span>
<span class="n">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">);</span>
</pre>
<h6>Response Object Parameters to Get Sub-merchant</h6>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: center">Object</td>
<td style="text-align: left">Return the sub-merchant which is called with the corresponding id. Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<h2>4.5 Activate/Deactivate sub-merchant</h2>

<p>This method is used by merchant to activate and to deactivate a given sub-merchant. Deactivating sub-merchant doesn&rsquo;t make the email used by the sub-merchant become available. Instead, deactivating sub-merchant will make the given sub-merchant unable to do transaction. To make the email become available, merchant should use Update sub-merchant Method, and change the email.</p>

<p>Note : Only active submerchant that can do transaction.</p>

<h6>Request Object Parameters to Activate/Deactivate Sub-merchant</h6>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: center">Data Type</th>
<th style="text-align: center">Mandatory(Y/N)</th>
<th style="text-align: center">Size</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td>String</td>
<td style="text-align: center">merchantId</td>
<td style="text-align: center">AN</td>
<td style="text-align: center">Y</td>
<td style="text-align: center">22</td>
<td style="text-align: left">Unique Identifier for sub-merchant</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<h6>Method</h6>

<p>To deactivate sub-merchant, use the following method:</p>
<pre class="highlight java"><span class="n">subMerchantManager</span><span class="o">.</span><span class="na">deActivate</span><span class="o">(</span><span class="n">merchantId</span><span class="o">);</span>
</pre>
<p>Sample Code to deactivate sub-merchant</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDeActivate</span><span class="p">(</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
<span class="o">{</span>
    <span class="n">VeritransAuthentication</span> <span class="n">veritransAuth</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VeritransAuthenticationImpl</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">veritransAuth</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
        <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">deActivate</span><span class="o">(</span><span class="s">&quot;A100000000000001000382&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;deactive merchant =&gt; A100000000000001000382&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>To activate sub-merchant, use the following method:</p>
<pre class="highlight java"><span class="n">subMerchantManager</span><span class="o">.</span><span class="na">activate</span><span class="o">(</span><span class="n">merchantId</span><span class="o">);</span>
</pre>
<p>Sample Code to activate sub-merchant</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testActivate</span><span class="p">(</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
<span class="o">{</span>
    <span class="n">VeritransAuthentication</span> <span class="n">veritransAuth</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VeritransAuthenticationImpl</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">veritransAuth</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
        <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">activate</span><span class="o">(</span><span class="s">&quot;A100000000000001000382&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;active merchant =&gt; A100000000000001000382&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>Sample Code doCharge Transaction, use inactive submerchant</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInActiveSubMerchantForTransaction</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geRequest</span> <span class="o">=</span> <span class="n">prepareChargeRequest</span><span class="o">();</span>

    <span class="c1">// set card number to 4111111111111111</span>
    <span class="kt">char</span><span class="n">geRequest</span><span class="o">.</span><span class="na">getCard</span><span class="o">().</span><span class="na">setCardNumber</span><span class="o">(</span><span class="s">&quot;4111111111111111&quot;</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geRequest</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;ryu13456234567.kawano.suliawan@gmail.com&quot;</span><span class="o">);</span>

    <span class="n">SubMerchant</span> <span class="n">inactiveSubMerchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubMerchant</span><span class="o">().</span>
                                      <span class="n">withId</span><span class="o">(</span><span class="s">&quot;A100000000000001000382&quot;</span><span class="o">).</span>
                                      <span class="n">withUsername</span><span class="o">(</span><span class="s">&quot;A100000000000001000382cc&quot;</span><span class="o">).</span>
                                      <span class="n">withPassword</span><span class="o">(</span><span class="s">&quot;8d1d82fc561231576d8732ea53896a617c04a1132584c01533ad49e460dfec7f&quot;</span><span class="o">).</span>
                                      <span class="n">asSubMerchant</span><span class="o">();</span>

    <span class="c1">// do normal charge</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">ChargeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">inactiveSubMerchant</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">fail</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ValidationException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">(),</span> <span class="n">Error</span><span class="o">.</span><span class="na">SUGAR_VALIDATION_ERROR</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<p>Sample Code Mandiri Click Transaction, use inactive submerchant</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInActiveSubMerchantForTransaction</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">SubMerchant</span> <span class="n">inactiveSubMerchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubMerchant</span><span class="o">().</span>
                                      <span class="n">withId</span><span class="o">(</span><span class="s">&quot;A100000000000001000382&quot;</span><span class="o">).</span>
                                      <span class="n">withUsername</span><span class="o">(</span><span class="s">&quot;A100000000000001000382cc&quot;</span><span class="o">).</span><span class="na">withPassword</span><span class="o">(</span><span class="s">&quot;8d1d82fc561231576d8732ea53896a617c04a1132584c01533ad49e460dfec7f&quot;</span><span class="o">).</span>
                                      <span class="n">asSubMerchant</span><span class="o">();</span>
    <span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>

    <span class="n">Address</span> <span class="n">shippingAd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khanedy&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;+6200-777777&quot;</span><span class="o">);</span>

    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setShippingAddress</span><span class="o">(</span><span class="n">shippingAd</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko@gmail.com&quot;</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">doubleToLongBits</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id: &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setBank</span><span class="o">(</span><span class="n">Bank</span><span class="o">.</span><span class="na">MANDIRI</span><span class="o">);</span>

    <span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;item1 name&quot;</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>

    <span class="n">Item</span> <span class="n">item2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
    <span class="n">item2</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;item2&quot;</span><span class="o">);</span>
    <span class="n">item2</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;item2 name&quot;</span><span class="o">);</span>
    <span class="n">item2</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>
    <span class="n">item2</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="n">item2</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;();</span>
    <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item1</span><span class="o">);</span>
    <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item2</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>

    <span class="c1">// chargeReq.setShippingAddress(...);</span>

    <span class="c1">// set mandiri clickpay</span>
    <span class="n">MandiriClickPay</span> <span class="n">mandiriClickPay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MandiriClickPay</span><span class="o">();</span>
    <span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setCard</span><span class="o">(</span><span class="s">&quot;4617007700000039&quot;</span><span class="o">);</span>     <span class="c1">// mandiri debit card</span>
    <span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setTokenRequest</span><span class="o">(</span><span class="s">&quot;44556&quot;</span><span class="o">);</span>     <span class="c1">// mandiri order id for token input</span>
    <span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setTokenResponse</span><span class="o">(</span><span class="s">&quot;000000&quot;</span><span class="o">);</span>     <span class="c1">// mandiri token response by order id</span>

    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">MANDIRI_CLICKPAY</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setMandiriClickPay</span><span class="o">(</span><span class="n">mandiriClickPay</span><span class="o">);</span>
    <span class="n">ChargeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">inactiveSubMerchant</span><span class="o">);</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">(),</span> <span class="n">TransactionStatus</span><span class="o">.</span><span class="na">SETTLEMENT</span><span class="o">);</span>
<span class="o">}</span>
</pre>
<p>Sample Code KlikBCA Transaction, use inactive submerchant</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInActiveSubMerchantForTransaction</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">ChargeRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>
    <span class="n">request</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">());</span>
    <span class="n">request</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">);</span>
    <span class="n">request</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko.khannedy@veritrans.co.id&quot;</span><span class="o">);</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;();</span>

    <span class="n">Item</span> <span class="n">item</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
    <span class="n">item</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;1&quot;</span><span class="o">);</span>
    <span class="n">item</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">100000L</span><span class="o">);</span>
    <span class="n">item</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
    <span class="n">item</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;Mie Ayam&quot;</span><span class="o">);</span>
    <span class="n">item</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">);</span>

    <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>

    <span class="n">request</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>

    <span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko Kurniawan&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khannedy&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address1&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;RT 01 RW 01&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Subang&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;41271&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;08978847686&quot;</span><span class="o">);</span>
    <span class="n">address</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
    <span class="n">request</span><span class="o">.</span><span class="na">setShippingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>

    <span class="n">request</span><span class="o">.</span><span class="na">setIpAddress</span><span class="o">(</span><span class="s">&quot;192.168.1.1&quot;</span><span class="o">);</span>

    <span class="n">KlikBca</span> <span class="n">klikBca</span> <span class="o">=</span> <span class="k">new</span> <span class="n">KlikBca</span><span class="o">();</span>
    <span class="n">klikBca</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="s">&quot;user01&quot;</span><span class="o">);</span>
    <span class="n">klikBca</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">&quot;Payment Description&quot;</span><span class="o">);</span>
    <span class="n">request</span><span class="o">.</span><span class="na">setKlikBca</span><span class="o">(</span><span class="n">klikBca</span><span class="o">);</span>

    <span class="n">request</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">BCA_KLIKBCA</span><span class="o">);</span>

    <span class="n">SubMerchant</span> <span class="n">inactiveSubMerchant</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubMerchant</span><span class="o">().</span>
                                      <span class="n">withId</span><span class="o">(</span><span class="s">&quot;A100000000000001000382&quot;</span><span class="o">).</span>
                                      <span class="n">withUsername</span><span class="o">(</span><span class="s">&quot;A100000000000001000382cc&quot;</span><span class="o">).</span>
                                      <span class="n">withPassword</span><span class="o">(</span><span class="s">&quot;8d1d82fc561231576d8732ea53896a617c04a1132584c01533ad49e460dfec7f&quot;</span><span class="o">).</span>
                                      <span class="n">asSubMerchant</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">ChargeResponse</span> <span class="kt">char</span><span class="n">geResponse</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">inactiveSubMerchant</span><span class="o">);</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="kt">char</span><span class="n">geResponse</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">PENDING</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fail</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></article></section><section><footer>&copy; Veritrans Documentation portal ^2014</footer></section><script src="../../assets/javascripts/app-b3406078.js" type="text/javascript"></script></body></html>