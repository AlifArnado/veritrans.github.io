<!DOCTYPE html><!--[if lt IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie10 lt-ie9"><![endif]--><!--[if IE 9]><html class="no-js lt-ie10"><![endif]--><!--[if (gt IE 9)|!(IE)]<!--><html class="nojs"><!--<![endif]--><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Payment Manager</title><meta content="" name="description" /><meta content="width=device-width, initial-scale=1" name="viewport" /><link href="../../assets/stylesheets/app-cb52da42.css" media="screen" rel="stylesheet" type="text/css" /></head><body><!--[if lte IE 7]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><header><h1>Veritrans docs</h1></header><section><aside><menu><li><a href="/">Home</a></li><li><a href="/sugarmdk">Sugar MKD</a><ul><li><a href="/sugarmdk/1-introducing/">1. Introducing</a></li><li><a href="/sugarmdk/2-payment-manager/">2. Payment Manager</a></li><li><a href="/sugarmdk/3-handling-exception-and-error-codes/">3. Handling Exception and Error Codes</a></li><li><a href="/sugarmdk/4-order-manager/">4. Order Manager</a></li><li><a href="/sugarmdk/5-sub-merchant-manager/">5. Sub Merchant Manager</a></li><li><a href="/sugarmdk/6-veritrans-sandbox/">6. Veritrans Sandbox</a></li><li><a href="/sugarmdk/7-appendix/">7. Appendix</a></li></ul></li></menu></aside><article><h2>2.1 Transaction Types and Banks</h2>

<p>Veritrans currently supports the following transactions:</p>

<table><thead>
<tr>
<th>Type</th>
<th style="text-align: center">Payment Method</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>NORMAL</td>
<td style="text-align: center">credit card</td>
<td style="text-align: right">Normal credit card transaction</td>
</tr>
<tr>
<td>INSTALLMENT</td>
<td style="text-align: center">credit card</td>
<td style="text-align: right">Credit card transaction with installments</td>
</tr>
<tr>
<td>POINTS</td>
<td style="text-align: center">credit card</td>
<td style="text-align: right">Credit card transaction with bank points</td>
</tr>
<tr>
<td>CIMB_CLICKS</td>
<td style="text-align: center">debit</td>
<td style="text-align: right">Debit online transaction for CIMB Clicks</td>
</tr>
<tr>
<td>BCA_KLIKPAY</td>
<td style="text-align: center">debit</td>
<td style="text-align: right">Debit online transaction for BCA KlikPay</td>
</tr>
<tr>
<td>MANDIRI_CLICKPAY</td>
<td style="text-align: center">debit</td>
<td style="text-align: right">Debit online transaction for MANDIRI ClickPay</td>
</tr>
<tr>
<td>BCA_KLIKBCA</td>
<td style="text-align: center">debit</td>
<td style="text-align: right">Debit online transaction for KlikBCA</td>
</tr>
</tbody></table>

<p>Used by Normal Charge, 3D Secure Charge, Installment Charge, Mandiri ClickPay Charge, KlikBCA Charge, OrderResponse Object</p>

<p>Veritrans currently works with the following banks. Please note that for Credit card, we currently only work with CIMB and BNI:</p>

<table><thead>
<tr>
<th>ENUM: Bank</th>
</tr>
</thead><tbody>
<tr>
<td>CIMB</td>
</tr>
<tr>
<td>MANDIRI</td>
</tr>
<tr>
<td>BCA</td>
</tr>
<tr>
<td>BNI</td>
</tr>
</tbody></table>

<p>Used by Normal Charge, 3D Secure Charge, Installment Charge, OrderResponse Object, OrderSearchResponse Object.</p>

<h2>2.2 Transaction Status</h2>

<p>Each transaction will be associated with one of the five transaction statuses: deny, cancel, challenge, authorize, settlement and pending. The descriptions of each status are described below:</p>

<table><thead>
<tr>
<th>Status</th>
<th style="text-align: center">Description - Credit Card</th>
<th style="text-align: right">Description - Internet Banking</th>
</tr>
</thead><tbody>
<tr>
<td>DENY</td>
<td style="text-align: center">Denied by the bank or by Veritrans&#39; Fraud Detection System (&ldquo;VT FDS&rdquo;)</td>
<td style="text-align: right">Denied by the bank. Not applicable for BCA KlikPay and KlikBCA</td>
</tr>
<tr>
<td>CANCEL</td>
<td style="text-align: center">Transaction cancelled</td>
<td style="text-align: right">Transaction cancelled</td>
</tr>
<tr>
<td>CHALLENGE</td>
<td style="text-align: center">Transaction approved by the bank, but flagged by VT FDS for further manual review</td>
<td style="text-align: right">Not Applicable</td>
</tr>
<tr>
<td>AUTHORIZE</td>
<td style="text-align: center">Transaction authorized by the bank and accepted by VT FDS. Transaction can still be cancelled since the funds has not been settled by the bank</td>
<td style="text-align: right">Not Applicable</td>
</tr>
<tr>
<td>SETTLEMENT</td>
<td style="text-align: center">Transaction is settled by the bank. Transaction cannot be cancelled. If a merchant still needs to reverse a transaction, it will have to go through a manual refund process (please contact Veritrans for further details).</td>
<td style="text-align: right">Transaction is settled by the bank. Refund needs to be conducted manually</td>
</tr>
<tr>
<td>PENDING</td>
<td style="text-align: center">Occurs when the 3D-secure loads and authentication is still being completed by the consumer.</td>
<td style="text-align: right">Transaction is still processed by bank and waiting for response. This status only occurs on BCA KlikPay and KlikBCA because the process is Asynchronous.</td>
</tr>
</tbody></table>

<p>Used by Get Order by Date Range, Transaction Status, and Merchant ID, ChargeResponse Object, D3SecureResponse Object, CancelResponseObject, OrderResponse Object, OrderSearchResponseObject</p>

<p>If a transaction is unsuccessful, the PaymentManager will throw a VeritransException object. Please refer to Section 5 for further details of the exception and error codes.</p>

<h2>2.3 Normal Credit Card Transaction without 3D-secure</h2>

<p>Normal credit card transaction can be processed with or without 3D Secure. We will cover how to conduct a transaction without 3D-secure first.</p>

<p>Below are the objects for normal credit card transactions</p>

<h4>Request Object Parameters to Do Normal Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Charge Request</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">card</td>
<td style="text-align: right">Object : CardParameter</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Card parameter used for the credit card transaction</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Billing address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">bank</td>
<td style="text-align: right">Enum:Bank</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Enumeration of banks. Veritrans will use default acquirer if not set.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Define the transaction type that will be used. If not set, the default transaction type is NORMAL. Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
</tr>
<tr>
<td>Item</td>
<td style="text-align: center">Id</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Id of Item</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
</tr>
<tr>
<td>CardParameter</td>
<td style="text-align: center">cardNumber</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">13 ~ 19</td>
<td>Card number</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredMonth</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">2</td>
<td>Card expired month</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredYear</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">4</td>
<td>Card expired year</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">cvv</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>Security code</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the SubMerchant object using SubMerchantManager.get().Refer to SubMerchant Objece</td>
</tr>
</tbody></table>

<p>Legend :
AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To do normal transaction without 3D-secure, use the method below that is provided by PaymentManager:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code: Do Charge Normal without 3D Secure</p>
<pre class="highlight java"><span class="c1">// instantiating Veritrans gateway and obtaining paymentManager object</span>
<span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="c1">// filling in ChargeRequest object paratemer that will be used for the doCharge</span>
<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>
<span class="n">CardParameter</span> <span class="n">cardParam</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CardParameter</span><span class="o">();</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setCardNumber</span><span class="o">(</span><span class="s">&quot;411111111111111&quot;</span><span class="o">);</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setCvv</span><span class="o">(</span><span class="s">&quot;111&quot;</span><span class="o">);</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setExpiredMonth</span><span class="o">(</span><span class="s">&quot;03&quot;</span><span class="o">);</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setExpiredYear</span><span class="o">(</span><span class="s">&quot;2013&quot;</span><span class="o">);</span>

<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setCard</span><span class="o">(</span><span class="n">cardParam</span><span class="o">);</span>

<span class="c1">// get sub-merchant to be used for charge transaction</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">sMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;sample1&quot;</span><span class="o">);</span>

<span class="c1">// below is a sample transaction response handling for a Normal Transaction</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">ChargeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">sMerchant</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">AUTHORIZE</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is successful&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">CHALLENGE</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is challenged&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">DENY</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is denied&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters from Do Normal Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response of charge, contains the response data. Refer to ChargeResponse Object</td>
</tr>
</tbody></table>

<h2>2.4 Normal Credit Card Transaction with 3D Secure</h2>

<h4>What is 3D Secure</h4>

<p>3D Secure is an online service designed to make online shopping transactions safer by authenticating a cardholder&rsquo;s identity at the time of purchase. This service is commonly known as Verified by Visa and MasterCard SecureCode. A transaction using Verified by Visa/SecureCode will redirect cardholders to the website of their card issuing bank. The cardholder may then be requested by their bank to enter a password to be authenticated. If a customer is not registered with 3D Secure then the merchant still have the option for the customer to make a purchase from you web site.</p>

<p>The image below explains how 3D-Secure has been implemented at Veritrans. The steps can be broken down into five steps:</p>

<ol>
<li>Merchant does a 3D secure transaction call using the <code>do3DSecureChargeMethod</code>, passing all the needed information, including the URL callback.</li>
<li>Sugar MDK will call the gateway and return a html page in the form of stream</li>
<li>Merchant will read the returned html page and rendered it to show 3D secure authentication form from the issuing bank.</li>
<li>Veritrans will do Authorize to bank and Directory Service to identify if the issuer supports 3D Secure</li>
<li>If 3D Secure is supported, user will be redirected to Bank Issuer 3D Secure page, where they will input their password, and the form will be submitted back to the Visa/MasterCard Directory Service and then will send the response back to the Gateway. If 3D secure is not supported, the page will automatically invoke the Gateway and send ECI response 6 (for Visa) or 1 (for MasterCard). If the consumer does not complete the 3D-secure authentication and press submit for the Visa/MasterCard directory service to respond back to Veritrans within 10 minutes, we will throw a timeout error to the user and drop the order. If the transaction was not completed or it timed-out on the 3D Secure page, then the transaction status will be PENDING. Every 12hrs, VT will update the transaction status of 3D-Secure transactions that have been pending for more than 10 minutes into DENY.</li>
<li>Send result of 3D secure authorization to Gateway either value 5 or 6 (for Visa) or value 0 or 1 (for MasterCard)</li>
<li>Gateway will call merchant server through the URL callback provided by the merchant in step 1 and pass the transaction status.</li>
</ol>

<p><img src="/assets/images/3dSecure-FlowDiagram-cb0f3ff2.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<h4>3D Secure Codes Explanation</h4>

<table><thead>
<tr>
<th>Code</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>S001</td>
<td style="text-align: center">Initial code of 3D Secure. It is updated to a transaction after step 4 when the card is authorized and the issuer supports 3D Secure.</td>
</tr>
<tr>
<td>S011</td>
<td style="text-align: center">Code of 3D Secure after user input the 6-digit code in step 5 to step 6 when the transaction is being verified. Less likely to be seen as last response code because the process happened fast.</td>
</tr>
</tbody></table>

<h4>Electronic Commerce Indicator</h4>

<p>Electronic Commerce Indicator (ECI) is a value that is returned from the Directory Server (Visa, MasterCard) to indicate the authentication result of the customer&rsquo;s credit card payment using 3D Secure.</p>

<h3>Visa</h3>

<table><thead>
<tr>
<th>ECI Value</th>
<th style="text-align: center">Definition</th>
</tr>
</thead><tbody>
<tr>
<td>5</td>
<td style="text-align: center">Both cardholder and card issuing bank are 3D enabled. 3D card authentication is successful. If ECI value is 5, the Transaction Status given will be AUTHORIZE.</td>
</tr>
<tr>
<td>6</td>
<td style="text-align: center">Authentication was attempted, but either the cardholder or issuer was not participating in 3D Secure. If ECI value is 6, the Transaction Status given will be AUTHORIZE.</td>
</tr>
<tr>
<td>7</td>
<td style="text-align: center">Authentication is unsuccessful, not attempted, or could not be attempted by the Issuing bank. If ECI value is 7, the Transaction Status given will be DENY.</td>
</tr>
</tbody></table>

<h3>MasterCard</h3>

<table><thead>
<tr>
<th>ECI Value</th>
<th style="text-align: center">Definition</th>
</tr>
</thead><tbody>
<tr>
<td>0</td>
<td style="text-align: center">BAuthentication is unsuccessful, not attempted, or could not be attempted by the Issuing bank. While we are waiting for MasterCard SecureCode to go live with Rakuten, if ECI value is 0, the Transaction Status given will be AUTHORIZE. However, once MasterCard SecureCode is implemented, if ECI is 0, the Transaction Status given will be DENY.</td>
</tr>
<tr>
<td>1</td>
<td style="text-align: center">Authentication was attempted, but either the cardholder or issuer was not participating in 3D Secure. If ECI value is 1, the Transaction Status given will be AUTHORIZE.</td>
</tr>
<tr>
<td>2</td>
<td style="text-align: center">Both cardholder and card issuing bank are 3D enabled. 3D card authentication is successful. If ECI value is 2, the Transaction Status given will be AUTHORIZE.</td>
</tr>
</tbody></table>

<h4>Request Object Parameters to Do 3D Secure Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Charge Request</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">card</td>
<td style="text-align: right">Object : CardParameter</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Card parameter used for the credit card transaction</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Billing address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">bank</td>
<td style="text-align: right">Enum:Bank</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Enumeration of banks. Veritrans will use default acquirer if not set.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Define the transaction type that will be used. If not set, the default transaction type is NORMAL. Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
</tr>
<tr>
<td>Item</td>
<td style="text-align: center">Id</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Id of Item</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
</tr>
<tr>
<td>CardParameter</td>
<td style="text-align: center">cardNumber</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Card number</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredMonth</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">2</td>
<td>Card expired month</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredYear</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">4</td>
<td>Card expired year</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">cvv</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>Security code</td>
</tr>
<tr>
<td>D3Secure</td>
<td style="text-align: center">callback</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Callback Url as endpoint to receive the 3D secure transaction. Url pattern validation.</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the SubMerchant object using SubMerchantManager.get().Refer to SubMerchant Objece</td>
</tr>
</tbody></table>

<p>Legend :
AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To do a normal credit card transaction with 3D secure use the method below provided by the PaymentManager:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">do3DSecureCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">,</span> <span class="n">d3Secure</span><span class="o">);</span>
</pre>
<p>Sample Code: Normal Charge transaction with 3D Secure</p>
<pre class="highlight java"><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span>
<span class="o">{</span>
    <span class="c1">// instantiating Veritrans gateway and obtaining paymentManager object</span>
    <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

    <span class="c1">// filling in ChargeRequest object parameter that will be used for the     doCharge</span>
    <span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>
    <span class="n">CardParameter</span> <span class="n">cardParam</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CardParameter</span><span class="o">();</span>
    <span class="n">cardParam</span><span class="o">.</span><span class="na">setCardNumber</span><span class="o">(</span><span class="s">&quot;411111111111111&quot;</span><span class="o">);</span>
    <span class="n">cardParam</span><span class="o">.</span><span class="na">setCvv</span><span class="o">(</span><span class="s">&quot;111&quot;</span><span class="o">);</span>
    <span class="n">cardParam</span><span class="o">.</span><span class="na">setExpiredMonth</span><span class="o">(</span><span class="s">&quot;03&quot;</span><span class="o">);</span>
    <span class="n">cardParam</span><span class="o">.</span><span class="na">setExpiredYear</span><span class="o">(</span><span class="s">&quot;2013&quot;</span><span class="o">);</span>

    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setCard</span><span class="o">(</span><span class="n">cardParam</span><span class="o">);</span>

    <span class="c1">// get sub-merchant that will be doing the transaction</span>
    <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
    <span class="n">SubMerchant</span> <span class="n">sMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;sample1&quot;</span><span class="o">);</span>

    <span class="c1">// create 3d secure parameter</span>
    <span class="n">D3Secure</span> <span class="n">d3Secure</span> <span class="o">=</span> <span class="k">new</span> <span class="n">D3Secure</span><span class="o">();</span>

    <span class="c1">// set callback URL for 3Dsecure response</span>
    <span class="n">d3Secure</span><span class="o">.</span><span class="na">setCallback</span><span class="o">(</span><span class="s">&quot;http://sample.shop.com/callback/3dsecure.form&quot;</span><span class="o">);</span>

    <span class="c1">// use PaymentManager.do3DSecureCharge</span>
    <span class="n">String</span> <span class="n">responseContent</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">do3DSecureCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">sMerchant</span><span class="o">,</span> <span class="n">d3Secure</span><span class="o">);</span>

    <span class="c1">// render response</span>
    <span class="n">PrintWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">responseContent</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</pre>
<p>The input stream html response will need to be rendered by the merchant. The html page will show the 3D secure form where user will need to fill in their 3D secure details. The result of the 3D secure authentication and credit card transaction will be send as a &ldquo;post http request&rdquo; to the callback URI provided in the do3DSecureCharge Method.</p>

<p>Below is the sample of the response content html that we send as a return string calling the do3DSecureCharge() method.</p>

<p>Sample response content String</p>
<pre class="highlight html"><span class="cp">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">content=</span><span class="s">&quot;no-store, no-cache&quot;</span> <span class="na">http-equiv=</span><span class="s">&quot;Cache-Control&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">content=</span><span class="s">&quot;no-cache&quot;</span> <span class="na">http-equiv=</span><span class="s">&quot;Pragma&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">content=</span><span class="s">&quot;0&quot;</span> <span class="na">http-equiv=</span><span class="s">&quot;Expires&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;script </span><span class="na">language=</span><span class="s">&quot;javascript&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
    <span class="kd">function</span> <span class="nx">OnLoadEvent</span><span class="p">(){</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;continue&quot;</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;downloadForm&quot;</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">&quot;OnLoadEvent();&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;https://dropit.3dsecure.net:9443/PIT/ACS&quot;</span> <span class="na">id=</span><span class="s">&quot;downloadForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">name=</span><span class="s">&quot;downloadForm&quot;</span> <span class="na">onsubmit=</span><span class="s">&quot;document.getElementById('continue').disabled=true; return true;&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h4&gt;</span>Redirecting to 3D-Secure Authentication...<span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;http://10.2.250.11/primera/img/redirect/auth_description.gif&quot;</span><span class="nt">&gt;&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;continue&quot;</span> <span class="na">name=</span><span class="s">&quot;continue&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Continue&quot;</span><span class="nt">&gt;&lt;/h4&gt;&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;PaReq&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">value=</span><span class="s">&quot;eJxVUm1PszAU/SuL36W3MHFb7pqgoJsJT1CJ0Y8NuxGGK1sLbo+/3hbBFz6Qc+69PT09LealJoofqeg0CUzJGPlKk2qzPMuBAwCfhzwILACY+eGZwCx6oIPAd9KmapTgHng+spFaBV2UUrUCZXG4Wv8T0/ksBEA2UNyRXsfCKTvNKcAl5zNkX2VUckciI90ZWUqpJomh+tz9kPUtLJpOtfq/CEKrORLs9Jso23a/YM5J1WqpjFc0XrVB5nrIfnxlnUPGap2qjXiKo1MaR8c0r/00Tz96HEfTdPuyROYmcCNbEj7wAAIIJz4swF/AFFlfR7lzJmzffvaUXwz3bpPoT+t3CW3cmlQxnmNkSKd9o8gtQvaNkf14vl65ZIvWhrWqbvKkS+rb7bNKeMKy+s7cH5fW9jDg1CobD7/gdpOBIHMSbLhGm0t/4xb9eQmflvmuVQ==&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;TermUrl&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">value=</span><span class="s">&quot;http://192.168.10.144:8080/primera/webinterface/GWTripartiteCommandRcv/mpi/Verify&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">&quot;MD&quot;</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">value=</span><span class="s">&quot;QTEwMDAwMDAwMDAwMDAwMTAwMDE5NmNj-MjAxMzAzMDYxMzAyMDQ5MzQ*-ZGQ4MDJhYmMzNDBlZDgwZWU3ZjA0NjY0MWJjZWMwMGU5NDI1MDFlYzU3M2Y0N2NjNjk2MjZjNDNkM2U0M2Q3Yg**==null&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre>
<p>Sample Code: 3D Secure callback handling</p>
<pre class="highlight java"><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span>
<span class="o">{</span>
    <span class="c1">// create instance of VeritransGateway Object</span>
    <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

    <span class="c1">// get 3d secure response</span>
    <span class="n">D3SecureResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">receive3DSecureResponse</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getMerchantId</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getMerchantMessage</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getD3eci</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getD3transactionId</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">getD3TransactionStatus</span><span class="o">();</span>

    <span class="n">response</span><span class="o">.</span><span class="na">getResultCode</span><span class="o">();</span>

    <span class="c1">// status handling</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">AUTHORIZE</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;3D Secure transaction is success&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters from 3D Secure Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>D3SecureResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response received from 3D Secure Charge. Refer to D3SecureResponse Object</td>
</tr>
</tbody></table>

<h2>2.5 Installment Transaction</h2>

<h4>Request Object Parameters to Do Installment Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Charge Request</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">card</td>
<td style="text-align: right">Object : CardParameter</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Card parameter used for the credit card transaction</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Billing address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">bank</td>
<td style="text-align: right">Enum:Bank</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Enumeration of banks. Veritrans will use default acquirer if not set.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Define the transaction type that will be used. If not set, the default transaction type is NORMAL. Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
</tr>
<tr>
<td>Item</td>
<td style="text-align: center">Id</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Id of Item</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
</tr>
<tr>
<td>CardParameter</td>
<td style="text-align: center">cardNumber</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Card number</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredMonth</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">2</td>
<td>Card expired month</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredYear</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">4</td>
<td>Card expired year</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">cvv</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>Security code</td>
</tr>
<tr>
<td>Installment</td>
<td style="text-align: center">term</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">2</td>
<td>Installment term (in months)</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">2</td>
<td>Type enumeration (given by bank)</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the SubMerchant object using SubMerchantManager.get().Refer to SubMerchant Objece</td>
</tr>
</tbody></table>

<p>Legend :
AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To do credit card transaction with installment, use the method below that is provided by PaymentManager:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>The difference between using installment and the other payment is its type. TransactionType.INSTALLMENT must be used as the transaction type parameter in the charge request parameter.</p>

<p>Sample Code: Do Charge Normal with Installment</p>
<pre class="highlight java"><span class="c1">//Instantiating Veritrans gateway and obtaining paymentManager object</span>
<span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="c1">// filling in ChargeRequest object paratemer that will be used for the doCharge</span>
<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setBank</span><span class="o">(</span><span class="n">Bank</span><span class="o">.</span><span class="na">BNI</span><span class="o">);</span>
<span class="n">CardParameter</span> <span class="n">cardParam</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CardParameter</span><span class="o">();</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setCardNumber</span><span class="o">(</span><span class="s">&quot;4105050000051244&quot;</span><span class="o">);</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setCvv</span><span class="o">(</span><span class="s">&quot;872&quot;</span><span class="o">);</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setExpiredMonth</span><span class="o">(</span><span class="s">&quot;10&quot;</span><span class="o">);</span>
<span class="n">cardParam</span><span class="o">.</span><span class="na">setExpiredYear</span><span class="o">(</span><span class="s">&quot;2015&quot;</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setCard</span><span class="o">(</span><span class="n">cardParam</span><span class="o">);</span>

<span class="c1">// fill in other parameters</span>
<span class="c1">// other parameter</span>
<span class="n">Address</span> <span class="n">billingAd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khanedy&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">);</span>
<span class="n">billingAd</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;200777777&quot;</span><span class="o">);</span>

<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setBillingAddress</span><span class="o">(</span><span class="n">billingAd</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko@gmail.com&quot;</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
<span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">doubleToLongBits</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()));</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id: &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;item1 name&quot;</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;();</span>
<span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item1</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>

<span class="c1">//chargeReq.setShippingAddress(...);</span>

<span class="c1">// add installment request</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">INSTALLMENT</span><span class="o">);</span>
<span class="n">Installment</span> <span class="n">installment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Installment</span><span class="o">();</span>
<span class="n">installment</span><span class="o">.</span><span class="na">setTerm</span><span class="o">(</span><span class="mi">6</span><span class="o">);</span> <span class="c1">// month of installment</span>
<span class="n">installment</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// type from Bank</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setInstallment</span><span class="o">(</span><span class="n">installment</span><span class="o">);</span>

<span class="c1">// get sub-merchant to be used for charge transaction</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">sMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;sample1&quot;</span><span class="o">);</span>

<span class="c1">// charge and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">ChargeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">sMerchant</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">AUTHORIZE</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is successful&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">DENY</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is denied&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters from Do Installment Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response of charge, contains the response data. Refer to ChargeResponse Object</td>
</tr>
</tbody></table>

<h2>2.6 Points Transaction</h2>

<p>This section is still under development and will be updated soon.</p>

<h2>2.7 Cancel Transaction for Credit Card and Internet Banking Transactions</h2>

<p>This function allows merchants to cancel credit card-based transactions (installment, points, normal and 3Dsecure) as long as it is before settlement.</p>

<h4>Request Object Parameters to Cancel Credit Card Transactions</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CancelRequest</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>The order identifier, where the transaction that will be cancelled occurred</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">internetBanking</td>
<td style="text-align: right">boolean</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Set TRUE if the transaction is Internet Banking (KlikBCA, Mandiri ClickPay, CIMB Clicks, and BCA KlikPay)</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subMerchant</td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Obtain the parameter from SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric</p>

<h4>Method</h4>

<p>To cancel transactions use the method below:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCancel</span><span class="o">(</span><span class="n">cancelRequest</span><span class="o">);</span>
</pre>
<p>Sample Code: Cancel Transaction for Credit Card Transactions</p>
<pre class="highlight java"><span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="c1">// get sub merchant</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">sMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;sample1&quot;</span><span class="o">);</span>

<span class="c1">// create cancel request</span>
<span class="n">CancelRequest</span> <span class="n">cancelRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CancelRequest</span><span class="o">();</span>

<span class="c1">// set order id (use Authorized order id) and sub merchant to cancel request</span>
<span class="n">cancelRequest</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="s">&quot;1234567&quot;</span><span class="o">);</span>
<span class="n">cancelRequest</span><span class="o">.</span><span class="na">setSubMerchant</span><span class="o">(</span><span class="n">sMerchant</span><span class="o">);</span>

<span class="c1">// do cancel request and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">CancelResponse</span> <span class="n">cancelResponse</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCancel</span><span class="o">(</span><span class="n">cancelRequest</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">cancelResponse</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">CANCEL</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction successfuly canceled&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction failed to cancel&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters from Cancel Credit Card Transactions</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>CancelResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response containing the data of credit card transaction cancellation. Refer to CancelResponse Object</td>
</tr>
</tbody></table>

<h2>2.8 Accept Challenge Transaction</h2>

<p>This function allow merchant to accept a challenged transaction.</p>

<h4>Request Object Parameter to Accept Challenge Transaction</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>String</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>The order identifier, where the transaction that will be cancelled occurred</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subMerchant</td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Obtain the parameter from SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric</p>

<h4>Method</h4>

<p>To approve an order that was challenged by the Veritran&rsquo;s FDS (Fraud Detection System), the below method is used:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doAcceptChallenge</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code: Accept Challenged Transaction</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">ApproveChallenge</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="s">&quot;OR011111&quot;</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">subMerchantId</span> <span class="o">=</span> <span class="s">&quot;R100000000000001000196&quot;</span><span class="o">;</span>
    <span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">PaymentManager</span>     <span class="n">paymentManager</span>     <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>
    <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>

    <span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">submerchantId</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">ChallengeActionResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doAcceptChallenge</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">ChallengeActionStatus</span><span class="o">.</span><span class="na">SUCCESS</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Challenge action approve order success&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Challenge action approve order failed&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameter from Accept Challenge Transaction</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChallengeActionResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Object obtained as the response of doAcceptChallenge() method. Refer to ChallengeActionResponse Object</td>
</tr>
</tbody></table>

<h2>2.9 Deny Challenge Transaction</h2>

<p>This function allow merchant to accept a challenged transaction.</p>

<h4>Request Object Parameter to Deny Challenge Transaction</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>String</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>The order identifier, where the transaction that will be cancelled occurred</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subMerchant</td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Obtain the parameter from SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric</p>

<h4>Method</h4>

<p>To approve an order that was challenged by the Veritrans&#39; FDS (Fraud Detection System), the below method is used:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doDenyChallenge</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code: Deny Challenged Transaction</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">DenyChallenge</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="s">&quot;OR011111&quot;</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">submerchantId</span> <span class="o">=</span> <span class="s">&quot;R100000000000001000196&quot;</span><span class="o">;</span>
    <span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">PaymentManager</span>     <span class="n">paymentManager</span>     <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>
    <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>

    <span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">submerchantId</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">ChallengeActionResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doDenyChallenge</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">ChallengeActionStatus</span><span class="o">.</span><span class="na">SUCCESS</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Challenge action deny order success&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Challenge action deny order failed&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameter from Deny Challenge Transaction</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChallengeActionResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Object obtained as the response of doAcceptChallenge() method. Refer to ChallengeActionResponse Object</td>
</tr>
</tbody></table>

<h2>2.10 Handling Internet Banking Response</h2>

<p>For internet bankings, response object parameters are generated by parsing the HTTP Request Notification into InternetBankingResponse Object. This is done to help Merchant getting consistent response parameters, especially for basic parameters such as TransactionStatus. The sample code below shows how to parse the HTTP Request Notification.</p>

<p>Sample Code</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReceiveInternetBankingDummy</span> <span class="kd">extends</span> <span class="n">HttpServlet</span>
<span class="o">{</span>
    <span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="n">doPost</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span>
    <span class="o">{</span>
        <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
        <span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

        <span class="n">InternetBankingResponse</span> <span class="kt">int</span><span class="n">ernetBankingResponse</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">recieveInternetBankingResponse</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="kt">int</span><span class="n">ernetBankingResponse</span><span class="o">.</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">SETTLEMENT</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction success&quot;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="kt">int</span><span class="n">ernetBankingResponse</span><span class="o">.</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">DENY</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction denied by bank&quot;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">new</span> <span class="n">VeritransException</span><span class="o">(</span><span class="n">Error</span><span class="o">.</span><span class="na">SUGAR_APPLICATION_ERROR</span><span class="o">.</span><span class="na">getCode</span><span class="o">(),</span> <span class="s">&quot;failure&quot;</span><span class="o">,</span> <span class="n">Error</span><span class="o">.</span><span class="na">SUGAR_APPLICATION_ERROR</span><span class="o">.</span><span class="na">getDescription</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h2>2.11 Internet Banking - Mandiri ClickPay using SugarMDK (Redirection)</h2>

<h4>Process Flow</h4>

<p>The process flow is described in the diagram below.</p>

<p><img src="/assets/images/MandiriClickpay-FlowDiagram-68042bf8.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>Description of above flow diagram:</p>

<ol>
<li>Merchant page will create an HTTP post form with the inputs defined in the Request Parameter and will be redirected to Veritrans Mandiri Payment Page. Then the customer will input the token number to the specified field in Veritrans Mandiri Payment Page. This page will last 5 minutes until timeout. If the user does not complete the transaction within 5 minutes, it will give a timeout error to the user and the order will be invalidated.</li>
<li>The Payment Page sends HTTP post request to Veritrans Gateway.</li>
<li>Veritrans Gateway validates the payment parameter, and after that it will send the payment request to Bank Mandiri.</li>
<li>Bank Mandiri sends payment response to Veritrans Gateway.</li>
<li>Veritrans Gateway sends HTTP post response to Veritrans Result Page.</li>
<li>Veritrans will redirect the user back to the merchant&rsquo;s page as designated by the RedirectURL.</li>
</ol>

<h3>Mandiri ClickPay transactionStatus</h3>

<table><thead>
<tr>
<th>Status</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>settlement</td>
<td style="text-align: center">Payment complete.</td>
</tr>
<tr>
<td>deny</td>
<td style="text-align: center">Payment denied by bank (e.g., wrong inputs, not enough funds)</td>
</tr>
</tbody></table>

<h3>Request Object Parameters to Generate Charge Request</h3>

<p>The validation of the parameters are done by SugarMDK instead of VT-Web. Therefore, when validation exception happened, there will be no redirection url generated. Instead, SugarMDK will throw Veritrans Exception (See Response Code List).</p>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
<th style="text-align: right"></th>
</tr>
</thead><tbody>
<tr>
<td>Charge Request</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">card</td>
<td style="text-align: right">Object : CardParameter</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Card parameter used for the credit card transaction</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Billing address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">mandiriClickPay</td>
<td style="text-align: right">Object:MandiriClickPay</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>MandiriClickPay Object</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Define the transaction type to do in the current payment.</td>
<td style="text-align: right">Use  the enum TransactionType.MANDIRI_CLICKPAY . Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>Item&mdash;&mdash;&mdash;&mdash;-</td>
<td style="text-align: center">Id&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td style="text-align: right">AN&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>Y&ndash;</td>
<td style="text-align: right">12&mdash;&mdash;&ndash;</td>
<td>Id of Item&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>CardParameter</td>
<td style="text-align: center">cardNumber</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Card number</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredMonth</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">2</td>
<td>Card expired month</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">expiredYear</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">4</td>
<td>Card expired year</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">cvv</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>Security code</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>MandiriClickPay</td>
<td style="text-align: center">card</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">16</td>
<td>Mandiri debit card number. Fixed at 16.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">tokenRequest</td>
<td style="text-align: right">N</td>
<td>N</td>
<td style="text-align: right">5</td>
<td>Booking code. Used by Mandiri to generate token response. Generated by VT if left blank</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">tokenResponse</td>
<td style="text-align: right">N</td>
<td>N</td>
<td style="text-align: right">6</td>
<td>Mandiri token response. Disregard for redirection type.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">redirectUrl</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">200</td>
<td>Redirection Url</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">notificationUrl</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">200</td>
<td>Notification Url</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the SubMerchant object using SubMerchantManager.get().Refer to SubMerchant Object</td>
<td style="text-align: right"></td>
</tr>
</tbody></table>

<p>Legend :
AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To conduct a transaction use the method below:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doMandiriClickCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code to render Mandiri KlikPay response page</p>
<pre class="highlight java"><span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>
<span class="n">ChargeRequest</span>  <span class="kt">char</span><span class="n">geReq</span><span class="o">;</span>
<span class="n">SubMerchant</span>    <span class="n">subMerchant</span><span class="o">;</span>
<span class="n">PaymentManager</span> <span class="n">paymentManager</span><span class="o">;</span>


<span class="nd">@Before</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">prepare</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="c1">// Instantiating Veritrans gateway and obtaining paymentManager object</span>
    <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

    <span class="k">this</span><span class="o">.</span><span class="na">chargeReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>

    <span class="n">Address</span> <span class="n">shippingAd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span> <span class="c1">//optional</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khanedy&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">);</span>
    <span class="n">shippingAd</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;+6200-777777&quot;</span><span class="o">);</span>

    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setShippingAddress</span><span class="o">(</span><span class="n">shippingAd</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko@gmail.com&quot;</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">doubleToLongBits</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id: &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>

    <span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;item1 name&quot;</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="n">item1</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;();</span>
    <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item1</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>

    <span class="c1">// chargeReq.setShippingAddress(...);</span>

    <span class="c1">// set mandiri clickpay</span>
    <span class="n">MandiriClickPay</span> <span class="n">mandiriClickPay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MandiriClickPay</span><span class="o">();</span>
    <span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setCard</span><span class="o">(</span><span class="s">&quot;4617007700000039&quot;</span><span class="o">);</span> <span class="c1">// mandiri debit card</span>
    <span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setRedirectUrl</span><span class="o">(</span><span class="s">&quot;http://10.2.250.12:8080/web1/resultPage.action&quot;</span><span class="o">);</span>
    <span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setNotificationUrl</span><span class="o">(</span><span class="s">&quot;http://10.2.250.12:8080/web1/backendPage.action&quot;</span><span class="o">);</span>     <span class="c1">//optional</span>

    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">MANDIRI_CLICKPAY</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setMandiriClickPay</span><span class="o">(</span><span class="n">mandiriClickPay</span><span class="o">);</span>

    <span class="c1">// get sub-merchant to be used for charge transaction</span>
    <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
    <span class="k">this</span><span class="o">.</span><span class="na">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testMandiriClickRedirectWithSugar</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">MANDIRI_CLICKPAY</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setMandiriClickPay</span><span class="o">(</span><span class="n">mandiriClickPay</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">strRes</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">strRes</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doMandiriClickCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;HTML:&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">strRes</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(!</span><span class="n">strRes</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">Error</span><span class="o">.</span><span class="na">SUGAR_VALIDATION_ERROR</span><span class="o">.</span><span class="na">getCode</span><span class="o">(),</span> <span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters</h4>

<p>The response parameters below will be shown if the transaction is valid through the Redirection Url when the request parameters have passed the validation in SugarMDK.</p>

<table><thead>
<tr>
<th>Field Name</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Mandatory (Y/N)</th>
<th style="text-align: right">Size</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td></td>
<td style="text-align: center">MerchantID</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">22</td>
<td style="text-align: right">MerchantId is unique and will be provided by Veritrans</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">webPageSelector</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">2</td>
<td style="text-align: right">WebPageSelector will be provided by Veritrans. For Mandiri is &ldquo;03&rdquo;.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">OrderID</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">20</td>
<td style="text-align: right">Unique merchant transaction number.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Amount</td>
<td style="text-align: right">Numeric</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">8 digits</td>
<td style="text-align: right">Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Currency</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">3</td>
<td style="text-align: right">Default is &ldquo;IDR&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Name</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">100</td>
<td style="text-align: right">Customer Name</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Email</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">45</td>
<td style="text-align: right">Customer Email for receiving receipt</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Phone</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">20</td>
<td style="text-align: right">Customer contact number</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Address</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">100</td>
<td style="text-align: right">Address of the customer</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">PostalCode</td>
<td style="text-align: right">Numeric</td>
<td style="text-align: right">N</td>
<td style="text-align: right">5</td>
<td style="text-align: right">Must be numeric</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">TransactionDate</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">19</td>
<td style="text-align: right">Format is: DD/MM/YYYY HH:mm:ss</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">TransactionStatus</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">200</td>
<td style="text-align: right">Status of the transaction. Refer to Transaction Status Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ResponseCode</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">6</td>
<td style="text-align: right">Code of Response</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ResponseMessage</td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right">200</td>
<td style="text-align: right">Message of the response</td>
</tr>
</tbody></table>

<h4>Get Transaction Status</h4>

<p>To get transaction status of certain order, merchant can use orderManager.get(orderId, subMerchant) method. This feature is used for merchant to find out transaction status when Connection Time-out Error happened. Below is the diagram flow of Timeout Connection Transaction.</p>

<p><img src="/assets/images/TimeoutConnectionTxn-002d4401.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>This is a sample case of Timeout Transaction Error:</p>

<p>1.Merchant sends the following HTTP Post Request to Veritrans Payment Page.</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">Data Type</th>
</tr>
</thead><tbody>
<tr>
<td>MerchantId</td>
<td style="text-align: center">Merchant Id, &ldquo;A100000000000001000234&rdquo;.</td>
</tr>
<tr>
<td>WebPageSelector</td>
<td style="text-align: center">For Mandiri ClickPay, the value is always &ldquo;03&rdquo;</td>
</tr>
<tr>
<td>OrderId</td>
<td style="text-align: center">The Order Id or Transaction No, for example &ldquo;123456789&rdquo;, this must be unique and has maximum length 20</td>
</tr>
<tr>
<td>Amount</td>
<td style="text-align: center">Total Amount of transaction, for example &ldquo;5000000&rdquo;</td>
</tr>
<tr>
<td>Currency</td>
<td style="text-align: center">Currency Code, for now should be &ldquo;IDR&rdquo;</td>
</tr>
<tr>
<td>Name</td>
<td style="text-align: center">Customer Name, for example &ldquo;John&rdquo;</td>
</tr>
<tr>
<td>Email</td>
<td style="text-align: center">Customer Email, for example &ldquo;john@gmail.com&rdquo;</td>
</tr>
<tr>
<td>Phone</td>
<td style="text-align: center">Customer Contact Number, for example &ldquo;08567077998&rdquo;</td>
</tr>
<tr>
<td>CardNumber</td>
<td style="text-align: center">4617007700000039</td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">Pamulang</td>
</tr>
<tr>
<td>PostalCode</td>
<td style="text-align: center">15416</td>
</tr>
<tr>
<td>TransactionDate</td>
<td style="text-align: center">Format is: DD/MM/YYYY HH:mm:ss, for example : 20/03/2013 10:30:30</td>
</tr>
<tr>
<td>RedirectURL</td>
<td style="text-align: center">hen the transaction finish, Page will be redirect to this callback url, for example &ldquo;http://www.rakuten.co.id/klik/finish&rdquo;</td>
</tr>
<tr>
<td>items</td>
<td style="text-align: center">15416</td>
</tr>
<tr>
<td>PostalCode</td>
<td style="text-align: center">The Item(s) and it&rsquo;s attributes.</td>
</tr>
</tbody></table>

<p>Item amount : 5000000
Item quantity: 1</p>

<p>2.Then, Veritrans Payment Page redirects the request to Veritrans Gateway to be forwarded to Bank Mandiri.
3.Unfortunately after the request message was successfully sent to Bank Mandiri, the network connection between Veritrans Gateway and Bank Mandiri is disrupted.</p>

<p>4.Because of that incident, the network communication timed out and Veritrans Gateway did not receive any response from Bank Mandiri.</p>

<p>5.For this case, Veritrans Gateway will initiate reversal message to Bank Mandiri to cancel the last transaction.</p>

<p>6.And the merchant will receive the following response message:</p>

<table><thead>
<tr>
<th>Name</th>
<th style="text-align: center">Data Type</th>
</tr>
</thead><tbody>
<tr>
<td>merchantId</td>
<td style="text-align: center">A100000000000001000234</td>
</tr>
<tr>
<td>webPageSelector</td>
<td style="text-align: center">03</td>
</tr>
<tr>
<td>orderId</td>
<td style="text-align: center">123456789</td>
</tr>
<tr>
<td>amount</td>
<td style="text-align: center">5000000</td>
</tr>
<tr>
<td>currency</td>
<td style="text-align: center">IDR</td>
</tr>
<tr>
<td>address.firstName</td>
<td style="text-align: center">John</td>
</tr>
<tr>
<td>address.lastName</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>email</td>
<td style="text-align: center">john@gmail.com</td>
</tr>
<tr>
<td>address.phone</td>
<td style="text-align: center">08567077998</td>
</tr>
<tr>
<td>cardNumber</td>
<td style="text-align: center">4617007700000039</td>
</tr>
<tr>
<td>address.address1</td>
<td style="text-align: center">Pamulang</td>
</tr>
<tr>
<td>address.postalCode</td>
<td style="text-align: center">15416</td>
</tr>
<tr>
<td>transactionDate</td>
<td style="text-align: center">20/03/2013 10:30:30</td>
</tr>
<tr>
<td>transactionType</td>
<td style="text-align: center">TransactionType.MANDIRI_CLICKPAY</td>
</tr>
<tr>
<td>items.get(0).name</td>
<td style="text-align: center">Handphone</td>
</tr>
<tr>
<td>items.get(0).amount</td>
<td style="text-align: center">5000000</td>
</tr>
<tr>
<td>items.get(0).quantity</td>
<td style="text-align: center">1</td>
</tr>
<tr>
<td>transactionStatus</td>
<td style="text-align: center">DENY</td>
</tr>
<tr>
<td>responseCode</td>
<td style="text-align: center">I003</td>
</tr>
<tr>
<td>responseMessage</td>
<td style="text-align: center">Time-out Transaction</td>
</tr>
</tbody></table>

<p>7.Merchant will immediately receive Timeout response from Veritrans Gateway, but when the merchant wants to check the Order status again, merchant can use feature Get Order By Id.</p>

<p>8.For detail, please refer to Get Order By Id.</p>

<h2>2.12 Internet Banking - Mandiri ClickPay using SugarMDK (no Redirect)</h2>

<p>Mandiri ClickPay is an internet banking service provided by Bank Mandiri to do online payment. The documentation below is for use if you would like to host the payment page on the merchant&rsquo;s page instead of Veritrans.</p>

<h4>Process Flow</h4>

<p>Below is the process flow chart if the payment page is hosted by the merchant.</p>

<p><img src="/assets/images/processflow-noRedirect-882292c3.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>Description of above flow diagram:</p>

<ol>
<li>Merchant page will create an HTTP post form with the inputs defined in the Request Parameter as Java objects through Veritrans Gateway by utilizing the paymentManager.doCharge method in SugarMDK.</li>
<li>Veritrans Gateway validates the payment parameter, and after that it will send the payment request to Bank Mandiri.</li>
<li>Veritrans Gateway receive payment responds from Bank Mandiri.</li>
<li>Veritrans Gateway forward the response from Bank Mandiri to Merchant as Response Object Parameters (ChargeResponse Object).</li>
</ol>

<p>The payment page needs to have the following inputs: Mandiri debit card number, Input 1, 2 and 3, as well as the Response from Mandiri&rsquo;s Token. See an example below from Veritrans&#39; UI:</p>

<p><img src="/assets/images/Rakuten-a07988a6.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<h4>Mandiri ClickPay transactionStatus</h4>

<table><thead>
<tr>
<th>Status</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>settlement</td>
<td style="text-align: center">Payment complete.</td>
</tr>
<tr>
<td>deny</td>
<td style="text-align: center">Payment denied by bank (e.g., wrong inputs, not enough funds)</td>
</tr>
</tbody></table>

<p>The table below lists the fields that should be exist on payment page at the merchant website.</p>

<table><thead>
<tr>
<th>Field Name</th>
<th style="text-align: center">Data Type</th>
<th>Length</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>Debit Card Number</td>
<td style="text-align: center">Numeric</td>
<td>16</td>
<td style="text-align: center">Input at merchant website</td>
</tr>
<tr>
<td>Amount</td>
<td style="text-align: center">Numeric</td>
<td>8 digits</td>
<td style="text-align: center">Total amount to be paid. Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td>Token Input :</td>
<td style="text-align: center"></td>
<td></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>Input-1</td>
<td style="text-align: center">Numeric</td>
<td>10</td>
<td style="text-align: center">The last 10 digits of debit card number</td>
</tr>
<tr>
<td>Input-2</td>
<td style="text-align: center">Numeric</td>
<td>16</td>
<td style="text-align: center">Total amount</td>
</tr>
<tr>
<td>Input-3</td>
<td style="text-align: center">Numeric</td>
<td>16</td>
<td style="text-align: center">Booking code</td>
</tr>
<tr>
<td>Token Response</td>
<td style="text-align: center">Numeric</td>
<td>6</td>
<td style="text-align: center">Generated by token</td>
</tr>
</tbody></table>

<p>At the payment page, merchant has to conduct the following:</p>

<ul>
<li>Ask user for customer&rsquo;s debit card number,</li>
<li>Fulfill automatically the field of input-1 with the customer&rsquo;s debit card&rsquo;s last 10 digits when a customer enters his/her debit card number,</li>
<li>Show the total amount to be paid in input-2,</li>
<li>Show the booking code in input-3,</li>
<li>Ask for the customer to input the numbers in input-1,  input-2, and input-3 into the Mandiri Token and enter in the response number received from the Mandiri Token into the Token Response field. (masked field, ex.*), and finally</li>
<li>Submit the form.</li>
</ul>

<p>This function allow merchant to process Mandiri Clickpay Internet banking transaction type</p>

<h4>Request Object Parameter to Do Mandiri ClickPay Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
<th style="text-align: right"></th>
</tr>
</thead><tbody>
<tr>
<td>ChargeRequest</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Billing address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">mandiriClickPay</td>
<td style="text-align: right">Object:MandiriClickPay</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>MandiriClickPay Object</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>N</td>
<td style="text-align: right">1</td>
<td>Define the transaction type to do in the current payment.</td>
<td style="text-align: right">Use  the enum TransactionType.MANDIRI_CLICKPAY . Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>Item&mdash;&mdash;&mdash;&mdash;-</td>
<td style="text-align: center">Id&mdash;&mdash;&mdash;&mdash;-</td>
<td style="text-align: right">AN&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</td>
<td>Y&ndash;</td>
<td style="text-align: right">12&mdash;&mdash;&ndash;</td>
<td>Id of Item&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>MandiriClickPay</td>
<td style="text-align: center">card</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">16</td>
<td>Mandiri debit card number. Fixed at 16.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">tokenRequest</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">16</td>
<td>Booking code. Used by Mandiri to generate token response.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">tokenResponse</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">6</td>
<td>Mandiri token response.</td>
<td style="text-align: right"></td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the SubMerchant object using SubMerchantManager.get().Refer to SubMerchant Object</td>
<td style="text-align: right"></td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To conduct a transaction use the method below:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code: Mandiri ClickPay payment</p>
<pre class="highlight java"><span class="c1">// Instantiating Veritrans gateway and obtaining paymentManager object</span>
<span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="c1">// filling in ChargeRequest object paratemer that will be used for the doCharge</span>
<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>

<span class="c1">// fill in parameters</span>
<span class="n">Address</span> <span class="n">shippingAd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khanedy&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;+6200777777&quot;</span><span class="o">);</span>

<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setShippingAddress</span><span class="o">(</span><span class="n">shippingAd</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko@gmail.com&quot;</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
<span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">doubleToLongBits</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()));</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id: &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;item1 name&quot;</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;();</span>
<span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item1</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>

<span class="c1">// chargeReq.setShippingAddress(...);</span>

<span class="c1">// set mandiri clickpay</span>
<span class="n">MandiriClickPay</span> <span class="n">mandiriClickPay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MandiriClickPay</span><span class="o">();</span>
<span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setCard</span><span class="o">(</span><span class="s">&quot;4617007700000039&quot;</span><span class="o">);</span> <span class="c1">// mandiri debit card</span>
<span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setTokenRequest</span><span class="o">(</span><span class="s">&quot;14253&quot;</span><span class="o">);</span> <span class="c1">// mandiri order id for token input</span>
<span class="n">mandiriClickPay</span><span class="o">.</span><span class="na">setTokenResponse</span><span class="o">(</span><span class="s">&quot;000000&quot;</span><span class="o">);</span> <span class="c1">// mandiri token response by order id</span>

<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">MANDIRI_CLICKPAY</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setMandiriClickPay</span><span class="o">(</span><span class="n">mandiriClickPay</span><span class="o">);</span>

<span class="c1">// get sub-merchant to be used for charge transaction</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="c1">// charge and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">ChargeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">AUTHORIZE</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is successful&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">DENY</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is denied&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters from Do Mandiri ClickPay Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response of charge, contains the response data. Refer to ChargeResponse Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<h2>2.13 Internet Banking - CIMB Clicks using SugarMDK (Redirection)</h2>

<p>CIMB Clicks is an internet banking service provided by Bank CIMB Niaga to do online payment.</p>

<h4>Process Flow</h4>

<p>In CIMB Clicks, the payment process will be done in the CIMB Clicks web page, so merchant will need redirect the user from their page to CIMB Clicks page when the user is going to do payment.</p>

<p>The process flow is described in the diagram below</p>

<p><img src="/assets/images/CIMBClicksFlowDiagram-6fc5bea8.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>Description of above flow diagram:</p>

<ol>
<li> Merchant page will create an http post form with the inputs defines in the Request Parameter and action (end point) to Veritrans Clicks page (refer to end point section).</li>
<li> Veritrans will redirect user to CIMB Clicks page.</li>
<li> In The CIMB Clicks page user has to login to the website using his/her credential. Then, they are required to input the token number which is sent to their mobile phone and confirm the payment details.</li>
<li> When the user is redirected to CIMB dummy page to complete transaction:
a.On the first page they need to click &ldquo;Proceed&rdquo;.</li>
</ol>

<p><img src="/assets/images/Step4a-8743473f.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>b.On the second page, CIMB Clicks login page. User input : &ldquo;user01&rdquo; as the user ID and click &ldquo;Submit&rdquo;.</p>

<p><img src="/assets/images/Step4b-790626b9.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>c.On the third page, CIMB Clicks source account confirmation, click &ldquo;Submit&rdquo;.</p>

<p><img src="/assets/images/Step4c-94d779e3.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>d.On the next page, in insert your paycode field input: &ldquo;000000&rdquo; then click &ldquo;Submit&rdquo;.</p>

<p><img src="/assets/images/Step4d-ca8ed65b.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>e.Next is result confirmation page, click &ldquo;OK&rdquo; to complete payment.</p>

<p><img src="/assets/images/Step4e-8bb167de.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>5.After Processing the payment CIMB Clicks will return the result to Veritrans Clicks page.</p>

<p>6.Veritrans CIMB Clicks page will forward the returned payment response to merchants and redirect the page back to merchants response URL (provided by merchant in process (1))</p>

<p>This implemenataion described above is in Veritrans staging server, for the live production CIMB Clicks the process is similar to these screens.</p>

<h4>CIMB Clicks transactionStatus</h4>

<table><thead>
<tr>
<th>Status</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>settlement</td>
<td style="text-align: center">Payment complete.</td>
</tr>
<tr>
<td>Deny</td>
<td style="text-align: center">Payment denied by bank (e.g., wrong inputs, not enough funds)</td>
</tr>
</tbody></table>

<h4>Request Object Parameters to Generate Charge Request</h4>

<p>The validation of the parameters are done by SugarMDK instead of VT-Web. Therefore, when validation exception happened, there will be no redirection url generated. Instead, SugarMDK will throw Veritrans Exception (See Response Code List).</p>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeRequest</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Billing address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">cimbClicks</td>
<td style="text-align: right">Object:CimbClicks</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>CimbClicks Object</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>Y</td>
<td style="text-align: right">1</td>
<td>Define the transaction type to do in the current payment. Use  the enum TransactionType.CIMB_CLICKS . Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
</tr>
<tr>
<td>Item</td>
<td style="text-align: center">Id</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Id of Item</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
</tr>
<tr>
<td>CimbClicks</td>
<td style="text-align: center">prodDesc</td>
<td style="text-align: right">N</td>
<td>N</td>
<td style="text-align: right">20</td>
<td>Product description puschased by customer.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">redirectUrl</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">200</td>
<td>Redirection Url</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the sub-merchant that will process the payment, using SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To conduct a transaction use the method below:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCimbClickCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
</pre>
<p>Sample Code to render CIMB Clicks response page</p>
<pre class="highlight java"><span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>
<span class="n">ChargeRequest</span>  <span class="kt">char</span><span class="n">geReq</span><span class="o">;</span>
<span class="n">SubMerchant</span>    <span class="n">subMerchant</span><span class="o">;</span>
<span class="n">PaymentManager</span> <span class="n">paymentManager</span><span class="o">;</span>


<span class="nd">@Before</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">prepare</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="c1">// Instantiating Veritrans gateway and obtaining paymentManager object</span>
    <span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

    <span class="k">this</span><span class="o">.</span><span class="na">chargeReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>

    <span class="n">Address</span> <span class="n">billingAd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khanedy&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">);</span>
    <span class="n">billingAd</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;+6200-777777&quot;</span><span class="o">);</span>


    <span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
                 <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Bakso&quot;</span><span class="o">).</span>
                 <span class="n">withPrice</span><span class="o">(</span><span class="mi">100000L</span><span class="o">).</span>
                 <span class="n">withId</span><span class="o">(</span><span class="s">&quot;1&quot;</span><span class="o">).</span>
                 <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

    <span class="n">ArrayList</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
    <span class="n">Items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item1</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>


    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setShippingAddress</span><span class="o">(</span><span class="n">billingAd</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko@gmail.com&quot;</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">100L</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">doubleToLongBits</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id: &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">();</span>

    <span class="c1">// set CimbClicks Object</span>
    <span class="n">CimbClicks</span> <span class="n">cimbClicks</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CimbClicks</span><span class="o">();</span>
    <span class="n">cimbClicks</span><span class="o">.</span><span class="na">setProdDesc</span><span class="o">(</span><span class="s">&quot;BOOKS&quot;</span><span class="o">);</span>     <span class="c1">//  Product Description</span>
    <span class="n">cimbClicks</span><span class="o">.</span><span class="na">setRedirectUrl</span><span class="o">(</span><span class="s">&quot;http://117.102.113.10:8080/web1/resultPage.action&quot;</span><span class="o">);</span>

    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">CIMB_CLICKS</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setCimbClicks</span><span class="o">(</span><span class="n">cimbClicks</span><span class="o">);</span>

    <span class="c1">// get sub-merchant to be used for charge transaction</span>
    <span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
    <span class="k">this</span><span class="o">.</span><span class="na">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCimbClicksRedirectWithSugar</span><span class="p">(</span><span class="o">)</span>
<span class="o">{</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">CIMB_CLICKS</span><span class="o">);</span>
    <span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setCimbClicks</span><span class="o">(</span><span class="n">cimbClicks</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">strRes</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">strRes</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCimbClickCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;HTML:&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">strRes</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(!</span><span class="n">strRes</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">Error</span><span class="o">.</span><span class="na">SUGAR_VALIDATION_ERROR</span><span class="o">.</span><span class="na">getCode</span><span class="o">(),</span> <span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">To</span> <span class="n">help</span> <span class="n">to</span> <span class="n">create</span> <span class="n">the</span> <span class="kt">char</span><span class="n">ge</span> <span class="n">request</span> <span class="n">easier</span><span class="o">,</span> <span class="n">use</span> <span class="k">this</span> <span class="n">sample</span> <span class="o">:</span>
<span class="kt">char</span><span class="n">geRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">().</span>
                <span class="n">withOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">).</span>
                <span class="n">withEmail</span><span class="o">(</span><span class="s">&quot;antony.siagian@veritrans.co.id&quot;</span><span class="o">).</span>
                <span class="n">withCimbClicks</span><span class="o">(</span><span class="n">cimbClicks</span><span class="o">).</span>
                <span class="n">withGrossAmount</span><span class="o">(</span><span class="mi">200000L</span><span class="o">).</span>
                <span class="n">withType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">BCA_KLIKPAY</span><span class="o">).</span>
                <span class="n">withShippingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">).</span>
                <span class="n">withBillingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">).</span>
                <span class="n">withItems</span><span class="o">(</span><span class="n">item1</span><span class="o">,</span> <span class="n">item2</span><span class="o">);</span>
</pre>
<h4>Response Object Parameters</h4>

<p>The response parameters below will be shown if the transaction is valid through the Redirection Url when the request parameters have passed the validation in SugarMDK.</p>

<table><thead>
<tr>
<th>Field Name</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Mandatory (Y/N)</th>
<th style="text-align: right">Size</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td></td>
<td style="text-align: center">MerchantID</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">22</td>
<td style="text-align: right">MerchantId is unique and will be provided by Veritrans</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">webPageSelector</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">2</td>
<td style="text-align: right">WebPageSelector will be provided by Veritrans. For CIMB is &ldquo;02&rdquo;.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">OrderID</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">20</td>
<td style="text-align: right">Unique merchant transaction number.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Amount</td>
<td style="text-align: right">Numeric</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">8 digits</td>
<td style="text-align: right">Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Currency</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">3</td>
<td style="text-align: right">Default is &ldquo;IDR&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Name</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">100</td>
<td style="text-align: right">Customer Name</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Email</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">45</td>
<td style="text-align: right">Customer Email for receiving receipt</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Phone</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">20</td>
<td style="text-align: right">Customer contact number</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">Address</td>
<td style="text-align: right">String</td>
<td style="text-align: right">N</td>
<td style="text-align: right">100</td>
<td style="text-align: right">Address of the customer</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">PostalCode</td>
<td style="text-align: right">Numeric</td>
<td style="text-align: right">N</td>
<td style="text-align: right">5</td>
<td style="text-align: right">Must be numeric</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">TransactionDate</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">19</td>
<td style="text-align: right">Format is: DD/MM/YYYY HH:mm:ss</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">TransactionStatus</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">200</td>
<td style="text-align: right">Status of the transaction. Refer to Transaction Status Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ResponseCode</td>
<td style="text-align: right">String</td>
<td style="text-align: right">Y</td>
<td style="text-align: right">6</td>
<td style="text-align: right">Code of Response</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ResponseMessage</td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: right">200</td>
<td style="text-align: right">Message of the response</td>
</tr>
</tbody></table>

<h2>2.14 Internet Banking - BCA KlikPay</h2>

<p>BCA KlikPay is an internet banking service provided by Bank Central Asia to do online payment.</p>

<h4>Process Flow</h4>

<p>BCA KlikPay process flow is also different than Mandiri ClickPay, but will be a bit similar with CIMB Clicks. In BCA KlikPay the payment process will be done in the BCA KlikPay page, so merchant will need redirect the user from their page to BCA KlikPay web page when the user is going to do payment.
The process flow is described in the diagram below.</p>

<p><img src="/assets/images/BCAKlikpay-flowdiagram-ef20e5f9.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>Description of above flow diagram:</p>

<ol>
<li>Merchant will send transaction request to Veritrans.</li>
<li>Veritrans check the inputs, and after validation, it will send a response back to the merchant with the URL to redirect the user to BCA KlikPay.</li>
<li>Via SugarMDK Merchant redirects user to BCA KlikPay according the URL.</li>
<li>Once the user goes into their KlikPay account, the user will then complete the transaction on the KlikPay website. Then BCA responds to veritrans with the approval code.</li>
<li>BCA redirect the user to the merchant&rsquo;s page as designated by the callback<em>URL. To get the correct final payment status of the transaction, merchant needs to do get</em>bca<em>klikpay</em>status for the transaction with order ID.</li>
<li>Veritrans will send transaction status, response code, response message, and the time of the transaction response to a URL based on Notification_URL via HTTP Post.</li>
</ol>

<h4>KlikPay transactionStatus</h4>

<table><thead>
<tr>
<th>Status</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>pending</td>
<td style="text-align: center">Transaction is pending and has not been completed by the customer</td>
</tr>
<tr>
<td>settlement</td>
<td style="text-align: center">Payment complete. Received payment flag</td>
</tr>
<tr>
<td>cancel</td>
<td style="text-align: center">Transaction cancelled by the merchant or the transaction has expired</td>
</tr>
</tbody></table>

<h4>Frequently Asked Questions:</h4>

<p><strong>Q: Is there a time-out on the KlikPay website? What happens if the user closes the browser after being redirected?</strong></p>

<p>A: Yes there is a time-out after 10min of inactivity on the KlikPay website. If the session times-out or if a user closes the KlikPay browser, then the transaction will fail. BCA will not inform the merchant of the failure, so the status of the transaction will continue to be pending.</p>

<p><strong>Q: What happens if the connection between BCA and veritrans fails, but the user already completed payment on the KlikPay website?</strong></p>

<p>A: In this scenario, the user&rsquo;s account will still be debited, and the amount will be settled to the merchant account. After sending the response message to veritrans, BCA will wait for 30 seconds for a response back from veritrans that verifies the transaction payment flag has been received and verified. If after 30 seconds BCA does not hear anything from veritrans, the user will be shown a message stating that there was a transaction error and to contact the merchant support. While the users account is debited, the merchant will not be notified of the transaction, and the only way for a merchant to check the status of the transaction is through (1) the daily settlement report sent by BCA, or by (2) calling the BCA hotline and asking whether a particular transaction has been processed or not. Unfortunately, there are no automatic means to check the status of a particular transaction.</p>

<p><strong>Q: What happens if the connection between the merchant and veritrans fails, and the merchant does not get the notification URL?</strong></p>

<p>A: You can use the get order API to obtain the latest status of a particular transaction on veritrans&#39; system.</p>

<p><strong>Q: What is the &ldquo;Misc Fee&rdquo; used for?</strong></p>

<p>A: Ussually this is to record fees that cannot be refunded or paid in installment, for example shipping fees. This function is used by some Indonesian merchants that want the actual product paid in installment (and therefore pay the higher bank charges), while the shipping fee is kept separate as it will not be refunded to the customers. This is an optional field.</p>

<p><strong>Q: In one transaction, can you have some products paid by installment, while others are paid in full?</strong></p>

<p>A: Yes you can. Please indicate <strong>FULL_INSTALLMENT</strong> in payType.</p>

<h4>Request Object Parameter to Do BCA KlikPay Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeRequest</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">18</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Billing address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">bcaKlikPay</td>
<td style="text-align: right">Object:BcaKlikPay</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>BCAKlikPay Object</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>Y</td>
<td style="text-align: right">1</td>
<td>Define the transaction type to do in the current payment. Use  the enum TransactionType.BCA_KLIKPAY . Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
</tr>
<tr>
<td>Item</td>
<td style="text-align: center">Id</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Id of Item</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">tenor</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">2</td>
<td>&ldquo;03&rdquo;, &ldquo;06&rdquo;, or &ldquo;12&rdquo; length of installment. <strong>MANDATORY IF INSTALLMENT ITEM</strong></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">codePlan</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">3</td>
<td>Default is &ldquo;000&rdquo;. <strong>MANDATORY IF INSTALLMENT ITEM</strong></td>
</tr>
<tr>
<td></td>
<td style="text-align: center">mid</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">9</td>
<td>Provided by BCA. <strong>MANDATORY IF INSTALLMENT ITEM</strong></td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>N</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>N</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>N</td>
<td style="text-align: right"></td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
</tr>
<tr>
<td>BcaKlickPay</td>
<td style="text-align: center">payType</td>
<td style="text-align: right">Enum: PayType</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>PayType lists:&bull;  PayType.FULL &bull;  PayType.INSTALLMENT &bull;PayTypeFULL_INSTALLMENT</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">notificationUrl</td>
<td style="text-align: right">N</td>
<td>N</td>
<td style="text-align: right">200</td>
<td>NotificationURL is the end-point that Veritrans will call to pass the InternetBankingResponse Object of the transaction.</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">callbackUrl</td>
<td style="text-align: right">N</td>
<td>Y</td>
<td style="text-align: right">200</td>
<td>User will be redirected back to callback URL after the payment process at BCA is finished</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">klikPayCode</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">10</td>
<td>Provided by BCA</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">currency</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">3</td>
<td>Default is &ldquo;IDR&rdquo;</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the sub-merchant that will process the payment, using SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Response Object BCAKlikpay</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>KlikPayStatus</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">transactionStatus</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Transaction Status Consist of: Pending, Settlement, Cancel</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">page</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right"></td>
<td>The page to render</td>
</tr>
</tbody></table>

<h4>Method</h4>

<p>To conduct a transaction use the method below:</p>
<pre class="highlight text">  paymentManager.doBcaKlikPayCharge(chargeReq, submerchant)
</pre>
<p>Sample Code : Full Transaction only (PayType = FULL TRANSACTION)</p>
<pre class="highlight java"><span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>
<span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">PaymentManager</span>     <span class="n">paymentManager</span>     <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="n">BcaKlikPay</span> <span class="n">bcaKlikPay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BcaKlikPay</span><span class="o">().</span>
                        <span class="n">withPayType</span><span class="o">(</span><span class="n">PayType</span><span class="o">.</span><span class="na">FULL</span><span class="o">).</span>
                        <span class="n">withNotificationUrl</span><span class="o">(</span><span class="s">&quot;http://www.rakuten.co.id/klik/notification&quot;</span><span class="o">).</span>
                        <span class="n">withRedirectionUrl</span><span class="o">(</span><span class="s">&quot;http://www.rakuten.co.id/klik/callback &quot;</span><span class="o">).</span>
                        <span class="n">withKlikPayCode</span><span class="o">(</span><span class="s">&quot;030001&quot;</span><span class="o">).</span>
                        <span class="n">withCurrency</span><span class="o">(</span><span class="s">&quot;IDR&quot;</span><span class="o">);</span>

<span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">().</span>
                  <span class="n">withAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">).</span>
                  <span class="n">withAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">).</span>
                  <span class="n">withCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">).</span>
                  <span class="n">withCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">).</span>
                  <span class="n">withFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">).</span>
                  <span class="n">withLastName</span><span class="o">(</span><span class="s">&quot;Khannedy&quot;</span><span class="o">).</span>
                  <span class="n">withPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">).</span>
                  <span class="n">withPhone</span><span class="o">(</span><span class="s">&quot;+6200-777777&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id : &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Bakso&quot;</span><span class="o">).</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">100000L</span><span class="o">).</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;1&quot;</span><span class="o">).</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Siomay&quot;</span><span class="o">).</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">100000L</span><span class="o">).</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;2&quot;</span><span class="o">).</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">().</span>
                              <span class="n">withOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">).</span>
                              <span class="n">withBcaKlikPay</span><span class="o">(</span><span class="n">bcaKlikPay</span><span class="o">).</span>
                              <span class="n">withGrossAmount</span><span class="o">(</span><span class="mi">200000L</span><span class="o">).</span>
                              <span class="n">withType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">BCA_KLIKPAY</span><span class="o">).</span>
                              <span class="n">withShippingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">).</span>
                              <span class="n">withEmail</span><span class="o">(</span><span class="s">&quot;sample@email.com&quot;</span><span class="o">).</span>
                              <span class="n">withItems</span><span class="o">(</span><span class="n">item1</span><span class="o">,</span> <span class="n">item2</span><span class="o">);</span>

<span class="c1">// charge and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">KlikPayStatus</span> <span class="n">responseContent</span> <span class="o">=</span>
        <span class="n">paymentManager</span><span class="o">.</span><span class="na">doBcaKlikPayCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Page: &quot;</span> <span class="o">+</span> <span class="n">responseContent</span><span class="o">.</span><span class="na">getPage</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;orderId: &quot;</span> <span class="o">+</span> <span class="n">responseContent</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Status: &quot;</span> <span class="o">+</span> <span class="n">responseContent</span><span class="o">.</span><span class="na">getTransactionStatus</span><span class="o">());</span>
    <span class="n">NIOWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getNIOWriter</span><span class="o">();</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">responseContent</span><span class="o">.</span><span class="na">getPage</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;exeception&quot;</span><span class="o">);</span>
    <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
<span class="o">}</span>
</pre>
<p>Sample Code : Installment Transaction only (PayType = INSTALLMENT)</p>
<pre class="highlight java"><span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>
<span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">PaymentManager</span>     <span class="n">paymentManager</span>     <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="n">BcaKlikPay</span> <span class="n">bcaKlikPay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BcaKlikPay</span><span class="o">().</span>
                        <span class="n">withPayType</span><span class="o">(</span><span class="n">PayType</span><span class="o">.</span><span class="na">FULL</span><span class="o">).</span>
                        <span class="n">withNotificationUrl</span><span class="o">(</span><span class="s">&quot;http://www.rakuten.co.id/klik/notification&quot;</span><span class="o">).</span>
                        <span class="n">withRedirectionUrl</span><span class="o">(</span><span class="s">&quot;http://www.rakuten.co.id/klik/callback &quot;</span><span class="o">).</span>
                        <span class="n">withKlikPayCode</span><span class="o">(</span><span class="s">&quot;030001&quot;</span><span class="o">).</span>
                        <span class="n">withCurrency</span><span class="o">(</span><span class="s">&quot;IDR&quot;</span><span class="o">);</span>

<span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">().</span>
                  <span class="n">withAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">).</span>
                  <span class="n">withAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">).</span>
                  <span class="n">withCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">).</span>
                  <span class="n">withCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">).</span>
                  <span class="n">withFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">).</span>
                  <span class="n">withLastName</span><span class="o">(</span><span class="s">&quot;Khannedy&quot;</span><span class="o">).</span>
                  <span class="n">withPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">).</span>
                  <span class="n">withPhone</span><span class="o">(</span><span class="s">&quot;+6200-777777&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id : &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Bakso&quot;</span><span class="o">).</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;1&quot;</span><span class="o">)</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">).</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span>
             <span class="n">withTenor</span><span class="o">(</span><span class="s">&quot;03&quot;</span><span class="o">).</span>
             <span class="n">withMid</span><span class="o">(</span><span class="s">&quot;2134334&quot;</span><span class="o">).</span>
             <span class="n">withCodePlan</span><span class="o">(</span><span class="s">&quot;000&quot;</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;2&quot;</span><span class="o">)</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Siomay&quot;</span><span class="o">).</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">).</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span>
             <span class="n">withTenor</span><span class="o">(</span><span class="s">&quot;06&quot;</span><span class="o">).</span>
             <span class="n">withMid</span><span class="o">(</span><span class="s">&quot;2134334&quot;</span><span class="o">).</span>
             <span class="n">withCodePlan</span><span class="o">(</span><span class="s">&quot;000&quot;</span><span class="o">);</span>

<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">().</span>
                              <span class="n">withOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">).</span>
                              <span class="n">withBcaKlikPay</span><span class="o">(</span><span class="n">bcaKlikPay</span><span class="o">).</span>
                              <span class="n">withGrossAmount</span><span class="o">(</span><span class="mi">2000000L</span><span class="o">).</span>
                              <span class="n">withType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">BCA_KLIKPAY</span><span class="o">).</span>
                              <span class="n">withShippingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">).</span>
                              <span class="n">withBillingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">).</span>
                              <span class="n">withEmail</span><span class="o">(</span><span class="s">&quot;sample@email.com&quot;</span><span class="o">).</span>
                              <span class="n">withItems</span><span class="o">(</span><span class="n">item1</span><span class="o">,</span> <span class="n">item2</span><span class="o">);</span>

<span class="c1">// charge and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">KlikPayStatus</span> <span class="n">responseContent</span> <span class="o">=</span>
        <span class="n">paymentManager</span><span class="o">.</span><span class="na">doBcaKlikPayCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">responseContent</span><span class="o">.</span><span class="na">getPage</span><span class="o">());</span>
    <span class="n">NIOWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getNIOWriter</span><span class="o">();</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">responseContent</span><span class="o">.</span><span class="na">getPage</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;exeception&quot;</span><span class="o">);</span>
    <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
<span class="o">}</span>
</pre>
<p>Sample Code : Full and Installment Transaction (PayType = FULL_INSTALLMENT)</p>
<pre class="highlight java"><span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>
<span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">PaymentManager</span>     <span class="n">paymentManager</span>     <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="n">BcaKlikPay</span> <span class="n">bcaKlikPay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BcaKlikPay</span><span class="o">().</span>
                        <span class="n">withPayType</span><span class="o">(</span><span class="n">PayType</span><span class="o">.</span><span class="na">FULL_INSTALLMENT</span><span class="o">).</span>
                        <span class="n">withNotificationUrl</span><span class="o">(</span><span class="s">&quot;http://www.rakuten.co.id/klik/notification&quot;</span><span class="o">).</span>
                        <span class="n">withRedirectionUrl</span><span class="o">(</span><span class="s">&quot;http://www.rakuten.co.id/klik/callback &quot;</span><span class="o">)..</span>
                        <span class="n">withKlikPayCode</span><span class="o">(</span><span class="s">&quot;030001&quot;</span><span class="o">).</span>
                        <span class="n">withCurrency</span><span class="o">(</span><span class="s">&quot;IDR&quot;</span><span class="o">);</span>

<span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">().</span>
                  <span class="n">withAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">).</span>
                  <span class="n">withAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">).</span>
                  <span class="n">withCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">).</span>
                  <span class="n">withCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">).</span>
                  <span class="n">withFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">).</span>
                  <span class="n">withLastName</span><span class="o">(</span><span class="s">&quot;Khannedy&quot;</span><span class="o">).</span>
                  <span class="n">withPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">).</span>
                  <span class="n">withPhone</span><span class="o">(</span><span class="s">&quot;+6200-777777&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id : &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Bakso&quot;</span><span class="o">).</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">).</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span>
             <span class="n">withTenor</span><span class="o">(</span><span class="s">&quot;03&quot;</span><span class="o">).</span>
             <span class="n">withMid</span><span class="o">(</span><span class="s">&quot;2134334&quot;</span><span class="o">).</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;1&quot;</span><span class="o">).</span>
             <span class="n">withCodePlan</span><span class="o">(</span><span class="s">&quot;000&quot;</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam Siomay&quot;</span><span class="o">).</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">).</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span>
             <span class="n">withTenor</span><span class="o">(</span><span class="s">&quot;06&quot;</span><span class="o">).</span>
             <span class="n">withMid</span><span class="o">(</span><span class="s">&quot;2134334&quot;</span><span class="o">).</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;2&quot;</span><span class="o">).</span>
             <span class="n">withCodePlan</span><span class="o">(</span><span class="s">&quot;000&quot;</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">().</span>
             <span class="n">withName</span><span class="o">(</span><span class="s">&quot;Mie Ayam X&quot;</span><span class="o">).</span>
             <span class="n">withPrice</span><span class="o">(</span><span class="mi">1000000L</span><span class="o">).</span>
             <span class="n">withId</span><span class="o">(</span><span class="s">&quot;3&quot;</span><span class="o">)</span>
             <span class="n">withQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">().</span>
                              <span class="n">withOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">).</span>
                              <span class="n">withBcaKlikPay</span><span class="o">(</span><span class="n">bcaKlikPay</span><span class="o">).</span>
                              <span class="n">withGrossAmount</span><span class="o">(</span><span class="mi">3000000L</span><span class="o">).</span>
                              <span class="n">withType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">BCA_KLIKPAY</span><span class="o">).</span>
                              <span class="n">withShippingAddress</span><span class="o">(</span><span class="n">address</span><span class="o">).</span>
                              <span class="n">withItems</span><span class="o">(</span><span class="n">item1</span><span class="o">,</span> <span class="n">item2</span><span class="o">);</span>

<span class="c1">// charge and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">KlikPayStatus</span> <span class="n">responseContent</span> <span class="o">=</span>
        <span class="n">paymentManager</span><span class="o">.</span><span class="na">doBcaKlikPayCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geRequest</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>

    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">responseContent</span><span class="o">.</span><span class="na">getPage</span><span class="o">());</span>
    <span class="n">NIOWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getNIOWriter</span><span class="o">();</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">responseContent</span><span class="o">.</span><span class="na">getPage</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;exeception&quot;</span><span class="o">);</span>
    <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
<span class="o">}</span>
</pre>
<p>Note :</p>

<ul>
<li> PayType for installment transaction (2 and 3) might change in the future due to feature increase by the bank. However, the bank has informed us that number of parameters will remain the same.</li>
</ul>

<h4>Response Object Parameters from Do BCA KlikPlay Charge (redirect back to merchant&rsquo;s web page)</h4>

<p>Because of the limitation from BCA, this response parameters will be notified by Veritrans to merchant after Veritrans received success notification from BCA.</p>

<p>In order to get a final payment status from callback URL, merchant needs to call getBcaKlikpayStatus (similar to getOrder function) with the ID that was included from the callbackURL. Veritrans will respond with the final payment status from BCA.</p>

<h3>Get BCAKlikpay Transaction Status</h3>

<h4>Request Object Parameter getTransactionStatus</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>String</td>
<td style="text-align: center">transactionId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object :SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the sub-merchant that will process the payment, using SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<h4>Response Object Parameter getTransactionStatus</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>KlikPayStatus</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Must be unique</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">transactionStatus</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>ransaction Status Consist of: Pending, Settlement, Cancel</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">page</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Only returned when do charge</td>
</tr>
</tbody></table>

<h4>Method</h4>

<p>To get the transaction status of BCAKlikpay, use this stub:</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">getBcaKlikPayStatus</span><span class="o">(</span><span class="n">String</span> <span class="n">transactionId</span><span class="o">)</span>
</pre>
<p>Note: TransactionId is an id wich is automatically added by BCAKlikpay to redirect/callback url.</p>

<p>Sample code to get BCAKlikpay transaction status: (Assumtions transactionId is &ldquo;502e4496-4c45-490b-812a-0b5e9c8adad0&rdquo;)</p>
<pre class="highlight java"><span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">&quot;A100000000000001000233cc&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">&quot;af757b7d932482672d78396539638e18ddb8510d8703a1972660f0a74d40b8fb&quot;</span><span class="o">;</span>
<span class="n">VeritransGateway</span>   <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">PaymentManager</span>     <span class="n">paymentManager</span>     <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>
<span class="n">KlikPayStatus</span> <span class="n">responseContent</span> <span class="o">=</span>
    <span class="n">paymentManager</span><span class="o">.</span><span class="na">getBcaKlikPayStatus</span><span class="o">(</span><span class="s">&quot;502e4496-4c45-4...&quot;</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">klikpayStatus</span><span class="o">.</span><span class="na">getTransactionStatus</span><span class="o">());</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">klikpayStatus</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">());</span>
</pre>
<h2>2.15 Internet Banking - KlikBCA</h2>

<p>KlikBCA was developed by BCA as a way to allow their customers to complete eCommerce transactions on their internet banking webpage. KlikBCA is the predecessor to BCA KlikPay and key difference between KlikPay and klikBCA are as follows:
- <strong>Login method</strong>: users login using their email address on KlikPay vs. login using their BCA internet banking account on KlikBCA
- <strong>Token</strong>: KlikBCA utilizes a token for verification purposes, while KlikPay sends one-time token to the users mobile</p>

<p>Overall, the user experience for customers have improved significantly with KlikPay. Nevertheless, most merchants still need to accommodate for KlikBCA due to its larger userbase.</p>

<h4>Process Flow</h4>

<p><img src="/assets/images/KlikBCAprocessFlow-f3587a1a.png" align="left" title="&lsquo;image&rsquo;" alt="&lsquo;images&rsquo;"/></p>

<p>The general process flow for KlikBCA is as follows:</p>

<ol>
<li>Customer chooses KlikBCA as the payment method. Merchant sends the following order data to veritrans via SugarMDK: {userId klikbca, orderId, amount, description}</li>
<li>Merchant tells customer to go to www.klikbca.com website to complete payment. You can redirect user, or just ask the user to go there themselves.</li>
<li>Customer logins to klikbca, and goes to the payment page for eCommerce merchants. BCA will then query veritrans for all transactions at the merchant that were made by the customer, and will show to the user the transaction that were responded back by Veritrans.</li>
<li>Customer will choose the transaction and make payment.</li>
<li>Once customer completes payment, BCA will send a complete payment flag to Veritrans</li>
<li>Veritrans will send a notification to Merchant once the complete payment flag is received</li>
<li>If Merchant would like to check the status of a particular transaction and see whether Veritrans has received a complete payment flag from BCA, the merchant can utilize the check status command via SugarMDK by sending us the orderid</li>
</ol>

<h4>KlikBCA transactionStatus</h4>

<table><thead>
<tr>
<th>Status</th>
<th style="text-align: center">Description</th>
</tr>
</thead><tbody>
<tr>
<td>pending</td>
<td style="text-align: center">Transaction is pending and has not been completed by the customer</td>
</tr>
<tr>
<td>settlement</td>
<td style="text-align: center">Payment complete. Received payment flag</td>
</tr>
<tr>
<td>cancel</td>
<td style="text-align: center">Transaction cancelled by the merchant or the transaction has expired</td>
</tr>
</tbody></table>

<p><strong>Pending</strong>
This transaction status is the initial status of the transaction in KlikBCA. It happened in process 2 until process 4. The status is updated to:</p>

<ol>
<li>Settlement when process 5 is complete and BCA sends complete payment flag to Veritrans.</li>
<li>Cancel when merchant manually cancels the transaction.</li>
</ol>

<p><strong>Settlement</strong>
Settlement is one of the final transaction status. It is automatically sent to merchant by Veritrans after Veritrans receives the complete payment flag from BCA.</p>

<p><strong>Cancel</strong>
Cancel is the other case of the final transaction status. The cancel command can be executed as long as the transaction status is still &ldquo;Pending&rdquo;.</p>

<h3>KlikBCA Charge</h3>

<h4>Request Object Parameter to Do KlikBCA Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeRequest</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">18</td>
<td><strong>IMPORTANT NOTE</strong>: For KlikBCA the size of the OrderId is smaller than other transaction types. Make sure that the size of your OrderId is less than 18</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">grossAmount</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Total amount (must be the same value with individual item * price). Maximum value for gross amount is &ldquo;99999999&rdquo;</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">email</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">45</td>
<td>Email address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">items</td>
<td style="text-align: right">List : Item</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Processed item list</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">shippingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Shipping address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">billingAddress</td>
<td style="text-align: right">Object : Address</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Billing address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">klikBCA</td>
<td style="text-align: right">Object:KlikBCA</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>BKlikBCA Object</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">type</td>
<td style="text-align: right">Enum :TransactionType</td>
<td>Y</td>
<td style="text-align: right">1</td>
<td>Define the transaction type to do in the current payment. Use  the enum TransactionType.BCA_KLIKBCA . Refer to Transaction Types Table</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">ipAddress</td>
<td style="text-align: right">NS</td>
<td>N</td>
<td style="text-align: right">40</td>
<td>The IP address of the buyer</td>
</tr>
<tr>
<td>Item</td>
<td style="text-align: center">Id</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Id of Item</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">price</td>
<td style="text-align: right">Long</td>
<td>Y</td>
<td style="text-align: right">8 digits</td>
<td>Price of Item &gt; 0</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">quantity</td>
<td style="text-align: right">int</td>
<td>Y</td>
<td style="text-align: right">3 digits</td>
<td>Quantity of Item &gt;=1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">name</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>Item name. Allowed symbols: _&lsquo;,.@-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">subTotal</td>
<td style="text-align: right">Long</td>
<td>N</td>
<td style="text-align: right"></td>
<td>Subtotal value(quantity * price). Generated by Veritrans.</td>
</tr>
<tr>
<td>Address</td>
<td style="text-align: center">firstName</td>
<td style="text-align: right">A</td>
<td>Y</td>
<td style="text-align: right">30</td>
<td>First Name of Address&rsquo; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">lastName</td>
<td style="text-align: right">A</td>
<td>N</td>
<td style="text-align: right">30</td>
<td>Last Name of Address&#39; Owner</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address1</td>
<td style="text-align: right">ANS</td>
<td>Y</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &lsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">address2</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">100</td>
<td>Acceptable symbols - _ &rsquo; , . @ ( ) /</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">city</td>
<td style="text-align: right">AS</td>
<td>N</td>
<td style="text-align: right">20</td>
<td>City of the address</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">postalCode</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">9</td>
<td>&gt;= 1</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">phone</td>
<td style="text-align: right">NS</td>
<td>Y</td>
<td style="text-align: right">19</td>
<td>Acceptable symbols : +-</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">countryCode</td>
<td style="text-align: right">A</td>
<td>N</td>
<td style="text-align: right">3</td>
<td>For now only support :&ldquo;IDN&rdquo;</td>
</tr>
<tr>
<td>KlikBCA</td>
<td style="text-align: center">userId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">12</td>
<td>Customer&rsquo;s KlikBCA userID</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">description</td>
<td style="text-align: right">AN</td>
<td>N</td>
<td style="text-align: right">60</td>
<td>Description. If not populated, we will create description from item name given by merchant</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">notificationUrl</td>
<td style="text-align: right">ANS</td>
<td>N</td>
<td style="text-align: right">200</td>
<td>Url used to send the response parameters. If left blank, we will not send a notification URL</td>
</tr>
<tr>
<td>SubMerchant</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Get the sub-merchant that will process the payment, using SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric, AS : Alpha Symbol</p>

<h4>Method</h4>

<p>To do charge with KlikBCA use this method :</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">)</span>
</pre>
<p>Sample Code : KlikBCA Charge Transaction</p>
<pre class="highlight java"><span class="c1">// Instantiating Veritrans gateway and obtaining paymentManager object</span>
<span class="n">VeritransGateway</span> <span class="n">gateway</span> <span class="o">=</span> <span class="n">VeritransGatewayFactory</span><span class="o">.</span><span class="na">createInstance</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
<span class="n">PaymentManager</span>   <span class="n">paymentManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getPaymentManager</span><span class="o">();</span>

<span class="c1">// filling in ChargeRequest object paratemer that will be used for the doCharge</span>
<span class="n">ChargeRequest</span> <span class="kt">char</span><span class="n">geReq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ChargeRequest</span><span class="o">();</span>

<span class="c1">// fill in parameters. This is optional</span>
<span class="n">Address</span> <span class="n">shippingAd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress1</span><span class="o">(</span><span class="s">&quot;address 1&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setAddress2</span><span class="o">(</span><span class="s">&quot;address 2&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">&quot;Jakarta&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setCountryCode</span><span class="o">(</span><span class="s">&quot;IDN&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">&quot;Eko&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">&quot;Khanedy&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setPostalCode</span><span class="o">(</span><span class="s">&quot;14045&quot;</span><span class="o">);</span>
<span class="n">shippingAd</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="s">&quot;+6200777777&quot;</span><span class="o">);</span>

<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setShippingAddress</span><span class="o">(</span><span class="n">shippingAd</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;eko@gmail.com&quot;</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setGrossAmount</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
<span class="n">String</span> <span class="n">orderId</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">doubleToLongBits</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()));</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;order id: &quot;</span> <span class="o">+</span> <span class="n">orderId</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>

<span class="n">Item</span> <span class="n">item1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Item</span><span class="o">();</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&quot;item1&quot;</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;item1 name&quot;</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">item1</span><span class="o">.</span><span class="na">setSubTotal</span><span class="o">(</span><span class="mi">200L</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;();</span>
<span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item1</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setItems</span><span class="o">(</span><span class="n">items</span><span class="o">);</span>

<span class="c1">// chargeReq.setShippingAddress(...);</span>

<span class="c1">// set KlikBCA</span>
<span class="n">KlikBca</span> <span class="n">klikBca</span> <span class="o">=</span> <span class="k">new</span> <span class="n">KlikBca</span><span class="o">();</span>
<span class="n">klikBca</span><span class="o">.</span><span class="na">setNotificationUrl</span><span class="o">(</span><span class="s">&quot;http://rakuten.co.id/notification/klik-bca&quot;</span><span class="o">);</span> <span class="c1">// notification url. optional</span>
<span class="n">klikBca</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="s">&quot;user01&quot;</span><span class="o">);</span> <span class="c1">// klikbca userid</span>
<span class="n">klikBca</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">&quot;Description&quot;</span><span class="o">);</span> <span class="c1">// description of product bought, this will be displayed on Klikbca website. If not populated, we will populate it by combining the item names.</span>

<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">TransactionType</span><span class="o">.</span><span class="na">BCA_KLIKBCA</span><span class="o">);</span>
<span class="kt">char</span><span class="n">geReq</span><span class="o">.</span><span class="na">setKlikBca</span><span class="o">(</span><span class="n">klikBca</span><span class="o">);</span>

<span class="c1">// get sub-merchant to be used for charge transaction</span>
<span class="n">SubMerchantManager</span> <span class="n">subMerchantManager</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="na">getSubMerchantManager</span><span class="o">();</span>
<span class="n">SubMerchant</span> <span class="n">subMerchant</span> <span class="o">=</span> <span class="n">subMerchantManager</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;A100000000000001000234&quot;</span><span class="o">);</span>

<span class="c1">// charge and get response</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">ChargeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCharge</span><span class="o">(</span><span class="kt">char</span><span class="n">geReq</span><span class="o">,</span> <span class="n">subMerchant</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">PENDING</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Transaction is successful, please check KlikBCA website&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
</pre>
<h4>Response Object Parameters from Do KlikBCA Charge</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>ChargeResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response of charge, contains the response data. Refer to ChargeResponse Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<h4>Frequently Asked Questions:</h4>

<p><strong>Q: When will the transaction expire?</strong></p>

<p>A: We have set such that transactions expire after 7 days. Also, Merchants can cancel transactions utilizing the Cancel Order API if the merchant wants to cancel a transaction before the 7 days is up.</p>

<p><strong>Q: What happens if a transaction completes payment, but BCA does not send the complete payment flag to veritrans due to network issues?</strong></p>

<p>A: Unfortunately, BCA does not have a feature to allow us to ask for a status update. In this scenario, the user&rsquo;s account will still be debited, and the amount will be settled to the merchant account. The user will be shown a message stating that there was a transaction error and to contact the merchant support. While the users account is debited, the merchant will not be notified of the transaction, and the only way for a merchant to check the status of the transaction is through (1) the daily settlement report sent by BCA, or by (2) calling the BCA hotline and asking whether a particular transaction has been processed or not. Unfortunately, there are no automatic means to check the status of a particular transaction.</p>

<p><strong>Q: Is there a time-out on the KlikBCA website? What happens if the user closes the klikBCA browser without completing the transaction?</strong></p>

<p>A: Yes there is a time-out after 8min of inactivity on the KlikBCA website. If the session times-out or if a user closes the KlikBCA browser, then the transaction will fail. BCA will not inform the merchant of the failure.</p>

<p><strong>Q: What about if veritrans fails to send the payment notification to the Merchant?</strong></p>

<p>A: You can check the status of a particular transaction by utilizing the Get Order API.</p>

<p><strong>Q: What is the max amount of transaction that you can send per KlikBCA userID?</strong></p>

<p>A: There is no limit from both Veritrans and KlikBCA</p>

<h3>KlikBCA Cancel</h3>

<h4>Request Object Parameters to Cancel KlikBCA Transactions</h4>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th>Mandatory(Y/N)</th>
<th style="text-align: right">Size</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CancelRequest</td>
<td style="text-align: center">orderId</td>
<td style="text-align: right">AN</td>
<td>Y</td>
<td style="text-align: right">20</td>
<td>The order identifier, where the transaction that will be cancelled occurred</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">internetBanking</td>
<td style="text-align: right">boolean</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Set TRUE if the transaction is Internet Banking (KlikBCA, Mandiri ClickPay, CIMB Clicks, and BCA KlikPay)</td>
</tr>
<tr>
<td></td>
<td style="text-align: center">SubMerchant</td>
<td style="text-align: right">Object:SubMerchant</td>
<td>Y</td>
<td style="text-align: right"></td>
<td>Obtain the parameter from SubMerchantManager.get(). Refer to SubMerchant Object</td>
</tr>
</tbody></table>

<p>Legend: AN : Alphanumeric, ANS : Alphanumeric Symbol, NS : Numeric Symbol, N : Numeric</p>

<h3>Method</h3>

<p>To cancel a KlikBCA Order, use this method :</p>
<pre class="highlight java"><span class="n">paymentManager</span><span class="o">.</span><span class="na">doCancel</span><span class="o">(</span><span class="n">cancelRequest</span><span class="o">);</span>
</pre>
<p>Sample Code</p>
<pre class="highlight java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doCancel</span><span class="p">(</span><span class="n">String</span> <span class="n">orderId</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">CancelRequest</span> <span class="n">cancelRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CancelRequest</span><span class="o">();</span>
    <span class="n">cancelRequest</span><span class="o">.</span><span class="na">setInternetBanking</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="n">cancelRequest</span><span class="o">.</span><span class="na">setOrderId</span><span class="o">(</span><span class="n">orderId</span><span class="o">);</span>
    <span class="n">cancelRequest</span><span class="o">.</span><span class="na">setSubMerchant</span><span class="o">(</span><span class="n">subMerchant</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">CancelResponse</span> <span class="n">cancelResponse</span> <span class="o">=</span> <span class="n">paymentManager</span><span class="o">.</span><span class="na">doCancel</span><span class="o">(</span><span class="n">cancelRequest</span><span class="o">);</span>
        <span class="n">assertTrue</span><span class="o">(</span><span class="n">cancelResponse</span><span class="o">.</span><span class="na">getData</span><span class="o">().</span><span class="na">getTransactionStatus</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="na">CANCEL</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">VeritransException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Code : &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Status : &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getStatus</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Message : &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="n">fail</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
<h3>Response Object Parameters from Cancel Credit Card Transactions</h3>

<table><thead>
<tr>
<th>Class</th>
<th style="text-align: center">Property</th>
<th style="text-align: right">Data Type</th>
<th style="text-align: right">Description</th>
</tr>
</thead><tbody>
<tr>
<td>CancelResponse</td>
<td style="text-align: center"></td>
<td style="text-align: right">Object</td>
<td style="text-align: right">Response containing the data of credit card transaction cancellation. Refer to CancelResponse Object</td>
</tr>
</tbody></table>
</article></section><section><footer>&copy; Veritrans Documentation portal ^2014</footer></section><script src="../../assets/javascripts/app-b3406078.js" type="text/javascript"></script></body></html>