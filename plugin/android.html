<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Veritrans API Documentation. Payment Gateway Indonesia, transaksi online lebih aman, mudah, cepat! Veritrans memberi solusi sistem payment gateway terbaik untuk e-commerce di Indonesia.">
    <meta name="keywords" content="Veritrans, Veritrans Indonesia, payment gateway indonesia, Pembayaran Online Indonesia, online payment Indonesia, sistem transaksi online"> 
    <link href="../stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <title>Docs - Veritrans Indonesia</title>
		<link rel="shortcut icon" href="/favicon.ico"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="header navbar navbar-default navbar-fixed-top">
      <div class="custom-container">
        <div class="col-md-3 col-sm-12 navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <h2 class="logo"><a href="https://www.veritrans.co.id/" title="Home"><span>Veritrans</span></a></h2>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://www.veritrans.co.id/whatwedo.html" title="What We Do">what we do</a></li>
            <li><a href="https://www.veritrans.co.id/product.html" title="Our Online Payment Products">product</a></li>
            
            <li class="dropdown hidden-xs hidden-sm hidden-md">
              <a href="about.html">about <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="https://www.veritrans.co.id/team.html" title="Team">team</a></li>
                <li><a href="https://www.veritrans.co.id/press.html" title="Press">press</a></li>
                <li><a href="https://www.veritrans.co.id/career.html" title="Career at Veritrans">career</a></li>
                <li><a href="https://www.veritrans.co.id/contact.html" title="Contact Us">contact</a></li>
                <li><a href="http://support.veritrans.co.id/" title="FAQ & How To">FAQ</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-lg">
              <a href="#">about <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="https://www.veritrans.co.id/about.html" title="Team">about us</a></li>
                <li><a href="https://www.veritrans.co.id/team.html" title="Team">team</a></li>
                <li><a href="https://www.veritrans.co.id/press.html" title="Press">press</a></li>
                <li><a href="https://www.veritrans.co.id/career.html" title="Career at Veritrans">career</a></li>
                <li><a href="https://www.veritrans.co.id/contact.html" title="Contact Us">contact</a></li>
                <li><a href="http://support.veritrans.co.id/" title="FAQ & How To">FAQ</a></li>
              </ul>
            </li>
            <!-- <li><a href="http://docs.veritrans.co.id" title="Product Documentations">docs</a></li> -->
            <li class="dropdown">
              <a href="#">developer <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="https://www.veritrans.co.id/sandbox.html">sandbox</a></li>
                <li><a href="http://docs.veritrans.co.id/">documentation</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#">community <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://blog.veritrans.co.id" title="Blog, News and Press Release">blog</a></li>
                <li><a href="https://www.veritrans.co.id/merchants.html" title="Merchants">merchants</a></li>
                <li><a href="https://www.veritrans.co.id/why-veritrans.html" title="Why Veritrans">why veritrans</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right register-login">
            <li class="pull-left"><a href="https://my.sandbox.veritrans.co.id/register" class="register">sign up</a></li>
            <li class="pull-left"><a href="https://my.veritrans.co.id/login">sign in</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="custom-container">
      <div class="row row-offcanvas row-offcanvas-right">
        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
    <div class="documentation-sidebar">
        <div class="docs-logo">
            <span>DOCS</span>
        </div>
        <div class="language-toggle"> English / <a href="../id/plugin/android.html">Bahasa Indonesia</a></div>
        <ul class="sidebar">
            
                <li>
                    
                        <a class="parent" href="../welcome/welcome.html">Welcome</a>
                    
                </li>
            
                <li>
                    
                        <a class="parent">VT-Web</a>
                        <b class="caret"></b>
                        <ul class="child-menu">
                            
                            <li class=""><a href="../vtweb/introduction.html">Introduction</a></li>
                            
                            <li class=""><a href="../vtweb/getting_started.html">Getting Started</a></li>
                            
                            <li class=""><a href="../vtweb/integration.html">Integration</a></li>
                            
                            <li class=""><a href="../vtweb/other_features.html">Other Features</a></li>
                            
                            <li class=""><a href="../vtweb/going_live.html">Going Live</a></li>
                            
                        </ul>
                    
                </li>
            
                <li>
                    
                        <a class="parent">VT-Direct</a>
                        <b class="caret"></b>
                        <ul class="child-menu">
                            
                            <li class=""><a href="../vtdirect/introduction.html">Introduction</a></li>
                            
                            <li class=""><a href="../vtdirect/getting_started.html">Getting Started</a></li>
                            
                            <li class=""><a href="../vtdirect/integration.html">Integration</a></li>
                            
                            <li class=""><a href="../vtdirect/other_features.html">Other Features</a></li>
                            
                            <li class=""><a href="../vtdirect/other_commands.html">Other Commands</a></li>
                            
                            <li class=""><a href="../vtdirect/going_live.html">Going Live</a></li>
                            
                        </ul>
                    
                </li>
            
                <li>
                    
                        <a class="parent">API Reference</a>
                        <b class="caret"></b>
                        <ul class="child-menu">
                            
                            <li class=""><a href="../sandbox/introduction.html">Introduction</a></li>
                            
                            <li class=""><a href="../sandbox/charge.html">Transaction Charge</a></li>
                            
                            <li class=""><a href="../sandbox/installment.html">Installment</a></li>
                            
                            <li class=""><a href="../sandbox/bin.html">BIN Promo</a></li>
                            
                            <li class=""><a href="../sandbox/other_features.html">Other Features</a></li>
                            
                            <li class=""><a href="../sandbox/other_commands.html">Other Commands</a></li>
                            
                            <li class=""><a href="../sandbox/card_list.html">Testing Card List</a></li>
                            
                            <li class=""><a href="../sandbox/status_code.html">Status Code</a></li>
                            
                        </ul>
                    
                </li>
            
                <li>
                    
                        <a class="parent" href="plugin.html">Plugin & Mobile Apps</a>
                    
                </li>
            
                <li>
                    
                        <a class="parent" href="http://support.veritrans.co.id">FAQ</a>
                    
                </li>
            
        </ul>
        <p class="question">
            Something is missing from the docs?<br>
            <a href="https://github.com/veritrans/veritrans.github.io">Open an issue or contribute to the docs on Github</a>
        </p>
    </div>
</div>
        <div class="col-xs-12 col-sm-7" id="bodier">
          <p class="pull-right visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Menu</button>
          </p>
          <div class="plugin-android">
            <h2 id="android-integration">Android Integration</h2>
<hr />

<h5 id="the-objective-of-this-documentation-is-to-assist-you-integrating-credit-card-payment-method-on-an-android-app-with-vt-direct-for-more-inquiries-please-contact-us-at-supportveritranscoidmailtosupportveritranscoid-email-support-or-visit-our--support-web-pagehttpsupportveritranscoid-veritrans-support"><em>The objective of this documentation is to assist you integrating credit card payment method on an Android App with VT-Direct. For more inquiries, please contact us at <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#118;&#101;&#114;&#105;&#116;&#114;&#097;&#110;&#115;&#046;&#099;&#111;&#046;&#105;&#100;">&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#064;&#118;&#101;&#114;&#105;&#116;&#114;&#097;&#110;&#115;&#046;&#099;&#111;&#046;&#105;&#100;</a> or visit our  <a title="Veritrans Support" href="http://support.veritrans.co.id">support web page</a>.</em></h5>
<hr />
<p><br /></p>

<h3 id="overview">OVERVIEW</h3>

<p>VTAndroidLib is an Android library for getting token from Veritrans payment gateway by using <a href="../vtdirect/introduction.html">VT-Direct</a>. The only dependency for this library is the <a href="https://sites.google.com/site/gson/">Gson Library</a> which can be set on your Gradle file (will be explained later).</p>

<p>With this library you will able to securely collect credit card information without exposing sensitive credit card Information to your servers, this library also support get token for 3d secure enabled transactions.</p>

<pre><code class="highlight plaintext">Note:

For developing and testing you will need a SANDBOX ACCOUNT.
</code></pre>

<p><br /></p>

<h3 id="flow-process">Flow Process</h3>

<p><img alt="vtdirect_mobile" class="img-responsive img-thumbnail" src="../images/vtdirect-mobile-flow.png" /></p>

<p>There are three participants during a payment process in VT-Direct: Merchant, customer, and Veritrans. The following is the explanation of how VT-Direct operates:</p>

<ol>
  <li>
    <p><strong>Click Pay</strong>: Customer will fill the credit card information on the android apps, and click <code>Pay</code> to complete payment.</p>
  </li>
  <li>
    <p><strong>Send Card Data</strong>: When the customer click the pay button, android library will combine the sensitive credit card information with the <em>client key</em>. The combination of the data is then sent to Veritrans server to be exchanged with the <em>onetime-token</em> ("Token").</p>
  </li>
  <li>
    <p><strong>Get Token</strong>: Veritrans will return the Token to the android apps. The token will be valid for <strong>3 minutes</strong> during a standard credit card transaction and <strong>10 minutes</strong> if a 3D Secure feature is utilized. Token will expire after exceeding the respective time.</p>
  </li>
  <li>
    <p><strong>Send Token</strong>: Token is then sent to the merchant server. Do note that the merchant will only receive Token as a substitution for the credit card details. <strong>Merchant will not save or process any credit card information.</strong> Therefore, merchant does not have to encounter any PCI DSS security issue.</p>
  </li>
  <li>
    <p><strong>Request Charge</strong>: Merchant will perform charge transaction with the Token, with addition of a few other information (Example: Customer details, product details, address, etc).</p>
  </li>
  <li>
    <p><strong>Transaction Response Handling</strong>: Veritrans returns transaction status response, such as:</p>

    <ul>
      <li>Capture</li>
      <li>Settlement
<br /><br /></li>
    </ul>
  </li>
  <li>
    <p><strong>Send transaction status</strong>: You send result transaction to customer.
<br /><br /></p>
  </li>
</ol>

<h3 id="step-1-installation">STEP 1: INSTALLATION</h3>

<p>We recommend you to use Gradle for managing dependencies for your project. This example will be based on Gradle.</p>

<ul>
  <li>Download latest version of VTAndroidLib.aar from <a href="https://github.com/muhammadanis/vtandroidlib/releases/">Github</a>, and put it under your libs folder. For example PROJECT_ROOT/app/libs.</li>
  <li>Add dependencies to your <code>build.gradle</code> file for VTAndroidLib and Gson.</li>
</ul>

<p><br /></p>

<pre><code class="highlight plaintext">allprojects {
    repositories {
        jcenter()
        flatDir {
            dirs 'libs'
        }
    }
}
dependencies {
    compile 'com.google.code.gson:gson:2.2.4'
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile (name : 'VTAndroidAPI', ext: 'aar')
}
</code></pre>

<p><br /></p>

<h3 id="step-2-retrieving-token">STEP 2: Retrieving Token</h3>

<ul>
  <li>Set your VTConfig for Sandbox Mode and Client Key</li>
</ul>

<pre><code class="highlight plaintext">//set environment
VTConfig.VT_IsProduction = false;

//set client key
VTConfig.CLIENT_KEY = "&lt; Your Client Key &gt;";
</code></pre>

<p><br /></p>

<ul>
  <li>Create VTDirect Object and set card details to get your token for current transaction</li>
</ul>

<pre><code class="highlight plaintext">//Create VTDirect Object. It’s config is Based on VTConfig Static Class
VTDirect vtDirect = new VTDirect();

//Create VTCardDetails Object to be set to VTDirect Object
VTCardDetails cardDetails = new VTCardDetails();
	
//TODO: Set your card details based on user input.
//this is a sample
cardDetails.setCard_number("4811111111111114");
cardDetails.setCard_cvv("123");
cardDetails.setCard_exp_month(1);
cardDetails.setCard_exp_year(2020);
	
//set true or false to enable or disable 3dsecure
cardDetails.setSecure(true);
cardDetails.setGross_amount("10000");
	
//Set VTCardDetails to VTDirect
vtDirect.setCard_details(cardDetails);
</code></pre>

<p><br /></p>

<ul>
  <li>Request Token</li>
</ul>

<pre><code class="highlight plaintext">//Simply Call getToken function and put your callback to handle data
vtDirect.getToken(new ITokenCallback() {
    @Override
   	public void onSuccess(VTToken token) {
    
    //use token anyhow you want, maybe send it to your server. Example here to check whether you are using 3dsecure feature or not.
        if(token.getRedirect_url() != null){
            
            //using 3d secure
			WebView webView = new 
				WebView(getActivity());
                          
				webView.getSettings().setJavaScriptEnabled(true);	
                webView.setOnTouchListener(new View.OnTouchListener(){

					@Override
    				public boolean onTouch(View v, MotionEvent event){
      					switch (event.getAction()){
                            case MotionEvent.ACTION_DOWN
                            case MotionEvent.ACTION_UP:
                            if (!v.hasFocus())
                            	{
                                    v.requestFocus();
                                }
                            break;
                        }
                            return false;
                    }
                });
                webView.loadUrl(token.getRedirect_url());
		}
        //print or send token
    }

    @Override
    public void onError(Exception e) {
					
		//Something is wrong, get details message by print e.getMessage()
    }
});
</code></pre>

<p><br /></p>

<h3 id="step-3-send-token-to-server">STEP 3: Send token to server</h3>

<p>After getting your token to your callback, you should send it to your server for example for charging. For this we can use AsyncTask from Android to send it asynchronously.</p>

<pre><code class="highlight plaintext">private class SendTokenAsync extends AsyncTask&lt;String, Void, String&gt;{

        @Override
        protected String doInBackground(String... strings) {
            HttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost("http://&lt;Your Server&gt;/index.php");

            List&lt;NameValuePair&gt; nameValuePairs = new ArrayList&lt;NameValuePair&gt;(1);
            try {
				
				//add post parameter called token-id and price
                nameValuePairs.add(new BasicNameValuePair("token-id", URLEncoder.encode(strings[0],"UTF-8")));
                nameValuePairs.add(new BasicNameValuePair("price",strings[1]));
                httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
				
				//get response from server
                HttpResponse response = httpClient.execute(httpPost);
                String jsonResponse = EntityUtils.toString(response.getEntity()).toString();
                return jsonResponse;
            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            }catch (IOException e) {
                e.printStackTrace();
            }
            return "";      
        }
    }
</code></pre>

<p><br /></p>

<h3 id="step-4-charging-from-server">STEP 4: Charging From Server</h3>

<p>After sending your token to your server, now it’s time to charge your customer using your server key. In this example we will use PHP as our processing server with <a href="https://github.com/veritrans/veritrans-php">Veritrans PHP Library</a>.</p>

<p>File : index.php</p>

<pre><code class="highlight php"><span class="cp">&lt;?php</span>
<span class="k">include_once</span><span class="p">(</span><span class="s2">"Veritrans.php"</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'token-id'</span><span class="p">])){</span>
        <span class="k">echo</span> <span class="s2">"Empty token-id"</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">Veritrans_Config</span><span class="o">::</span><span class="nv">$serverKey</span> <span class="o">=</span> <span class="s2">"&lt; Your server key &gt;"</span><span class="p">;</span>
<span class="nx">Veritrans_Config</span><span class="o">::</span><span class="nv">$isProduction</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="nv">$token_id</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'token-id'</span><span class="p">];</span>
<span class="c1">//echo $token_id;
</span>
<span class="nv">$transaction_details</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'order_id'</span>    <span class="o">=&gt;</span> <span class="nb">rand</span><span class="p">(),</span>
  <span class="s1">'gross_amount'</span>  <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span>
<span class="p">);</span>

<span class="nv">$transaction_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'payment_type'</span>      <span class="o">=&gt;</span> <span class="s1">'credit_card'</span><span class="p">,</span>
  <span class="s1">'credit_card'</span>       <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'token_id'</span>  <span class="o">=&gt;</span> <span class="nv">$token_id</span><span class="p">,</span>
    <span class="s1">'bank'</span>    <span class="o">=&gt;</span> <span class="s1">'bni'</span>
    <span class="p">),</span>
  <span class="s1">'transaction_details'</span>   <span class="o">=&gt;</span> <span class="nv">$transaction_details</span><span class="p">,</span>
  <span class="p">);</span>
<span class="k">try</span><span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">Veritrans_VtDirect</span><span class="o">::</span><span class="na">charge</span><span class="p">(</span><span class="nv">$transaction_data</span><span class="p">);</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"{\"</span><span class="nx">status\</span><span class="s2">":</span><span class="se">\"</span><span class="s2">success</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">body</span><span class="se">\"</span><span class="s2"> : </span><span class="nv">$json</span><span class="s2">}"</span><span class="p">;</span>
<span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s2">"{\"</span><span class="nx">status\</span><span class="s2">":</span><span class="se">\"</span><span class="s2">error</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">body</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">.</span><span class="nv">$e</span><span class="s2">.</span><span class="se">\"</span><span class="s2">}"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre>

<p><br /></p>

<p>If you are using another programming language, you can checkout another library that already available <a href="plugin.html">here</a>.</p>

<p><br /></p>


			<div class="pagination">
				<ul><li class="right">Next: <a href="../vtweb/introduction.html">VT-Web : Introduction</a> »</li></ul>
			</div>
          </div>
        </div><!--/span-->
      </div><!--/row-->

    </div><!--/.container-->
    <div class="custom-container footer">
  <div class="wrapper">
    <div class="row">
      <div class="col-md-12 copyright">
        <div class="content text-center">
          <span>&copy;2014 PT. Midtrans (Veritrans Indonesia). All Rights Reserved</span>
          <span class="divider">|</span>
          <a href="https://www.veritrans.co.id/privacy.html" title="Privacy Policy">Privacy Policy</a>
        </div>
      </div>
    </div>
  </div>
</div>

    <script src="../javascripts/jquery-1.10.2.min.js" type="text/javascript"></script>
<script src="../javascripts/bootstrap.min.js" type="text/javascript"></script>
<script src="../javascripts/get-token.js" type="text/javascript"></script>
<script src="../javascripts/dropdown.js" type="text/javascript"></script>
<script src="../javascripts/tab_custom.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://api.sandbox.veritrans.co.id/v2/assets/js/veritrans.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-32232768-1', 'veritrans.co.id');
      ga('send', 'pageview');

    </script>
    <script>
    $(document).ready(function() {
      $('[data-toggle=offcanvas]').click(function() {
        $('.row-offcanvas').toggleClass('active');
      });
      $(function () {
        $('[data-toggle="tooltip"]').tooltip();
      });
    });
    </script>
  </body>
</html>
